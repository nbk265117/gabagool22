SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DjDHaQkcuh.js",import.meta.url,"DjDHaQkcuh");SML.di("./BNvs6GxKML.js",import.meta.url,"BNvs6GxKML");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");SML.di("./DtM8Lj6hsu.js",import.meta.url,"DtM8Lj6hsu");SML.di("./NMIRxeD8JS.js",import.meta.url,"NMIRxeD8JS");SML.di("./DnltuFZqmR.js",import.meta.url,"DnltuFZqmR");SML.di("./Hkg3Mqe-CH.js",import.meta.url,"Hkg3Mqe-CH");SML.di("./vS6eWPysSE.js",import.meta.url,"vS6eWPysSE");SML.di("./C7tY_fu9Em.js",import.meta.url,"C7tY_fu9Em");SML.di("./K6BvuFajM1.js",import.meta.url,"K6BvuFajM1");SML.di("./DV-5OOn05m.js",import.meta.url,"DV-5OOn05m");SML.di("./CPEjWpDINz.js",import.meta.url,"CPEjWpDINz");SML.di("./BoQssu-hw1.js",import.meta.url,"BoQssu-hw1");SML.di("./BNRfi4XN6P.js",import.meta.url,"BNRfi4XN6P");SML.di("./i6yXqnjJFw.js",import.meta.url,"i6yXqnjJFw");SML.di("./jzmnNb68mH.js",import.meta.url,"jzmnNb68mH");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./D4Ab94OqLr.js",import.meta.url,"D4Ab94OqLr");SML.di("./Bq3qdqopCU.js",import.meta.url,"Bq3qdqopCU");
SML.dm("B7pSbhQu66",["CYrPuvCiTj","DjDHaQkcuh","nZA40q2akY","DtM8Lj6hsu","NMIRxeD8JS","DnltuFZqmR","Hkg3Mqe-CH","vS6eWPysSE","C7tY_fu9Em","K6BvuFajM1","DV-5OOn05m","wzdls1o9Kk","D4Ab94OqLr","Bq3qdqopCU","BNvs6GxKML","CPEjWpDINz","BoQssu-hw1","BNRfi4XN6P","i6yXqnjJFw","jzmnNb68mH"],(async(e,t,a,i,n,s,o,r,l,u,d,m,p,h)=>{const{svg:c}=e.a(),g=e.m(c`<path d="M18.054 14c-1.474 2.961-4.522 5-8.053 5H.786a.784.784 0 01-.554-1.339l2.704-2.704A9.98 9.98 0 012.235 14H4.48l.889 1.069a36.981 36.981 0 01-2.328 2.087l.076.188a38.514 38.514 0 013.04-.144H10a7.2 7.2 0 005.983-3.2h2.07zM10 2.8A7.2 7.2 0 0115.983 6h2.07C16.58 3.039 13.533 1 10 1 6.468 1 3.42 3.039 1.947 6h2.07a7.198 7.198 0 015.984-3.2H10zm-5.852 9.044v.581h1.454v-4.85H4.148v.55h-.034a1.912 1.912 0 00-.676-.462 2.272 2.272 0 00-.87-.16 2.43 2.43 0 00-1.24.322 2.326 2.326 0 00-.875.895 2.6 2.6 0 00-.32 1.284c0 .471.105.898.315 1.278.21.38.499.677.867.892.368.215.776.322 1.225.322.32 0 .614-.056.879-.169.265-.113.493-.274.686-.485h.043v.002zm-.486-.835c-.202.175-.461.262-.775.262a1.34 1.34 0 01-.64-.155 1.195 1.195 0 01-.467-.442 1.251 1.251 0 01-.174-.66c0-.246.055-.467.164-.662.109-.196.26-.348.455-.458.194-.11.418-.164.662-.164.244 0 .46.055.647.164.187.11.333.262.435.455.102.193.154.412.154.656l.005 1.366h-.03l-.436-.362zm2.725-3.434v4.85h1.526V9.518c0-.267.07-.473.21-.617a.739.739 0 01.55-.216c.225 0 .397.071.516.214.119.143.178.346.178.611v2.916h1.507V9.51c0-.264.07-.468.209-.611a.746.746 0 01.556-.214c.218 0 .387.071.505.214.119.143.178.346.178.611v2.916h1.526V9.334c0-.31-.05-.601-.151-.874a1.453 1.453 0 00-.53-.683c-.251-.182-.588-.273-1.012-.273-.325 0-.625.057-.903.171-.278.114-.51.283-.696.505h-.024a1.302 1.302 0 00-.51-.505 1.553 1.553 0 00-.746-.171c-.594 0-1.065.23-1.415.689h-.024v-.617l-1.45-.001zm11.909 4.269v.581h1.454v-4.85h-1.454v.55h-.034a1.912 1.912 0 00-.676-.462 2.272 2.272 0 00-.87-.16 2.43 2.43 0 00-1.24.322 2.326 2.326 0 00-.875.895 2.6 2.6 0 00-.32 1.284c0 .471.105.898.315 1.278.21.38.499.677.867.892.368.215.776.322 1.225.322.32 0 .614-.056.879-.169.265-.113.493-.274.686-.485h.043v.002zm-.485-.835c-.202.175-.461.262-.775.262a1.34 1.34 0 01-.64-.155 1.188 1.188 0 01-.467-.442 1.251 1.251 0 01-.174-.66c0-.246.055-.467.164-.662.109-.196.26-.348.455-.458.194-.11.418-.164.662-.164.244 0 .46.055.647.164.187.11.333.262.435.455.102.193.154.412.154.656l.005 1.366h-.03l-.436-.362z"></path>`,"0 0 20 20","ama"),{svg:I}=e.a(),N=e.m(I`<path d="M15.1 9.1h-4.2V4.9c0-.5-.4-.9-.9-.9s-.9.4-.9.9v4.2H4.9c-.5 0-.9.4-.9.9s.4.9.9.9h4.2v4.2c0 .5.4.9.9.9s.9-.4.9-.9v-4.2h4.2c.5 0 .9-.4.9-.9s-.4-.9-.9-.9z"></path>`,"0 0 20 20","plus"),{svg:T}=e.a(),v=e.m(T`<path d="M10.46 6.9h7.08c.5 0 .9-.4.9-.9s-.4-.9-.9-.9h-7.08c-.5 0-.9.4-.9.9s.4.9.9.9zM17.54 13.1h-7.08c-.5 0-.9.4-.9.9s.4.9.9.9h7.08c.5 0 .9-.4.9-.9s-.4-.9-.9-.9zM5 10.85a3.15 3.15 0 100 6.3 3.15 3.15 0 000-6.3zm0 4.5c-.74 0-1.35-.61-1.35-1.35 0-.74.61-1.35 1.35-1.35.74 0 1.35.61 1.35 1.35 0 .74-.61 1.35-1.35 1.35zM5 2.85a3.15 3.15 0 100 6.3 3.15 3.15 0 000-6.3z"></path>`,"0 0 20 20","poll",!0),A="w-full font-sans border-none outline-none bg-neutral-background p-0 resize-none",R=["sticky flex flex-col","w-[360px] h-[700px]","border border-tone-4 border-solid rounded-8 bg-neutral-background","py-md my-0 mx-auto"].join(" ");class k extends e.s{constructor(){super(...arguments),this.subredditId="",this.supressValidation=!1,this.showPostTypes=!1,this.authorFlairId="",this.onOrAfterSubmit=!1,this.automationOutcomes=[],this.onFlairPickerChange=e=>{const{id:a="",source:i=""}=e?.detail??{};i===t.A.LIVE_PREVIEW&&(this.authorFlairId=a,this.validate())},this.eventsWithFlairUpdate=[t.a.CHANGE_FLAIR,t.a.SEND_FLAIR],this.validate=e.ae((async()=>{if(!this.supressValidation)try{this.automationOutcomes=await this.validateAutomationRules()}catch{const t=e.d("faceplate-alert",{level:e.a0.error,cause:"uncategorized",message:"Something went wrong with the live preview. Please try again later"});this.dispatchEvent(t)}}),150)}static get styles(){return[e.i`.live-preview-tooltip{font:var(--font-12-16-semibold);background-color:var(--color-tooltip-bg-inverted);color:var(--color-tooltip-text-inverted);border-radius:.25rem;box-shadow:var(--boxshadow-tooltip);padding:.5rem;max-width:170px;width:max-content}.live-preview-tooltip::after{display:block;content:'';width:8px;height:8px;position:absolute;background-color:var(--color-tooltip-bg-inverted);--max-arrow-x-travel-tooltip:calc(var(--tooltip-width, 2rem) - 1rem);--max-arrow-x-travel-target:calc(var(--target-width, 1rem) / 2);--max-arrow-x-distance:max(
            min(var(--max-arrow-x-travel-target), var(--max-arrow-x-travel-tooltip)),
            0.5rem
          );left:var(--max-arrow-x-distance);top:0;transform:translateY(-50%) rotate(45deg);box-shadow:-1px -1px 2px rgba(0,0,0,.05)}div.sticky{top:calc(var(--shreddit-header-height) + 24px)}@media only screen and (max-width:900px){div.sticky{position:unset;top:unset}}@media only screen and (max-width:420px){div.sticky{width:100%}}`,e.t]}connectedCallback(){super.connectedCallback(),this.eventsWithFlairUpdate.forEach((e=>{document.addEventListener(e,this.onFlairPickerChange)})),this.dispatchEvent(e.d(t.a.REQUEST_FLAIR,{detail:{source:t.A.LIVE_PREVIEW,id:this.authorFlairId}}))}disconnectedCallback(){super.disconnectedCallback(),this.eventsWithFlairUpdate.forEach((e=>{document.removeEventListener(e,this.onFlairPickerChange)}))}updated(e){super.updated(e),e.has("previewAutomationInput")&&this.validate()}get hasBlockingValidationResult(){return t.h(this.automationOutcomes)}getAutomationOutcomesByStringFeature(e){return this.automationOutcomes.reduce(((t,a)=>{const i=a.contentMessages?.filter((t=>t.stringFeature===e));return i?.length?[...t,{...a,contentMessages:[i[0]]}]:t}),[])}onSubmit(){this.validate(),this.onOrAfterSubmit=!0}render(){const t=this.getTitleText(),a=this.previewAutomationInput?{className:this.hasBlockingValidationResult?"":"disabled:bg-primary-background disabled:text-global-white",disabled:!0}:{onclick:this.onSubmit,disabled:this.hasBlockingValidationResult};return e.x`<div class="${R}"> <div class="flex flex-col px-md cursor-not-allowed"> <div class="flex items-center"> <div class="flex flex-1 items-center"> ${e.al({})}${t?e.x`<span data-testid="live-preview-title" class="block text-14 font-semibold ml-md">${t}<span></span></span>`:e.A} </div> ${e.u({appearance:"primary",children:this.getSubmitButtonText(),attributes:{"data-testid":"live-preview-submit-btn",...a}})} </div> ${this.renderHeader()} </div> <div class="flex-1 overflow-y-auto px-md"> <slot name="fake-flair-picker"></slot> ${this.renderInputFields()} </div> ${this.showPostTypes?this.renderTypeTabs():e.A} </div>`}}e._([e.n({type:String,attribute:"subreddit-id"})],k.prototype,"subredditId",void 0),e._([e.n({type:Object,attribute:"preview-automation-input"})],k.prototype,"previewAutomationInput",void 0),e._([e.n({type:Boolean,attribute:"suppress-validation"})],k.prototype,"supressValidation",void 0),e._([e.n({type:Boolean,attribute:"show-post-types"})],k.prototype,"showPostTypes",void 0),e._([e.j()],k.prototype,"authorFlairId",void 0),e._([e.j()],k.prototype,"onOrAfterSubmit",void 0),e._([e.j()],k.prototype,"automationOutcomes",void 0);const b=t=>e.x`<div class="relative mt-md"> <article class="live-preview-tooltip" appearance="inverted" position="bottom-start"> <span>${t}</span> </article> </div>`;let E=class extends e.s{constructor(){super(),this.automationOutcomes=[],this.hasFocus=!1,this.isPreview=!1,this.makeErrorsRed=!1,this.noMarginAfter=!1,this.isCommentComposer=!1,this.showAllRules=!1,this._toggleShowAllRules=()=>{this.showAllRules=!this.showAllRules},e.eA(this)}static get styles(){return[e.i`.postguidance-rule{border:1px solid var(--color-neutral-border-weak)}.postguidance-rule p{margin:0}.live-rule p{margin:0}`,e.t]}get visibleRuleIds(){const e=this.shadowRoot?.querySelectorAll("div[data-rule-id]");return e?Array.from(e).map((e=>e.dataset.ruleId??"")).filter(Boolean):[]}_getValidationMessageClass(e){const t=e&&this.makeErrorsRed?"text-alert-negative":"text-secondary-weak";return this.isPreview?"postguidance-rule text-neutral-content rounded-2 px-sm py-2xs mb-2xs":`live-rule text-12 pt-2xs ${t}`}_renderShowAllBtn(t){if(!(t>5))return e.A;const a=t-5,i="View less";return this.isPreview?e.u({size:e.v.Small,children:this.showAllRules?i:"View more",attributes:{className:"ml-auto",onclick:this._toggleShowAllRules}}):e.x`<faceplate-tracker source="${this.isCommentComposer?e.eB:e.eC}" action="click" noun="${this.showAllRules?"view_more_guidance":"view_less_guidance"}"> <button class="bg-transparent border-none px-0 cursor-pointer text-12 mb-2xs text-primary hover:underline" @click="${this._toggleShowAllRules}" aria-expanded="${this.showAllRules}"> ${this.showAllRules?i:`View ${a} more`} </button> </faceplate-tracker>`;}render(){const t=this.automationOutcomes.filter((e=>"AutomationBlockOutcome"===e.__typename));if(0===this.automationOutcomes.length||!this.hasFocus&&0===t.length)return e.A;const a=t.length>0,i=a?t:this.automationOutcomes,n=this.showAllRules?i:i.slice(0,5);return e.x`<div class="${this.noMarginAfter?"":"mb-sm"}"> ${n.map((t=>t.contentMessages?t.contentMessages.map((({message:i,rtjsonText:n})=>i?e.x` <div data-rule-id="${e.aa(t.automation?.id)}" class="${this._getValidationMessageClass(a)}"> ${h.c({richtext:JSON.parse(n||"")})} </div> `:e.A)):e.A))} ${this._renderShowAllBtn(i.length)} </div>`}};e._([e.n({type:Array,attribute:"automation-outcomes"})],E.prototype,"automationOutcomes",void 0),e._([e.n({type:Boolean,attribute:"has-focus"})],E.prototype,"hasFocus",void 0),e._([e.n({type:Boolean,attribute:"is-preview"})],E.prototype,"isPreview",void 0),e._([e.n({type:Boolean,attribute:"make-errors-red"})],E.prototype,"makeErrorsRed",void 0),e._([e.n({type:Boolean,attribute:"no-margin-after"})],E.prototype,"noMarginAfter",void 0),e._([e.n({type:Boolean,attribute:"is-comment-composer"})],E.prototype,"isCommentComposer",void 0),e._([e.j()],E.prototype,"showAllRules",void 0),E=e._([e.e("automation-rule-triggered-rules")],E);let f=class extends(p.T()){constructor(){super(...arguments),this.inputClassName="",this.placeholder="",this.automationOutcomes=[],this.singleLine=!1,this.clearable=!1,this.value="",this.inputRef=e.Z()}static get styles(){return[e.t]}onInput(e){const t=e.target;var a;this.value=t.value,!this.singleLine&&t instanceof HTMLTextAreaElement&&((a=t).style.height="0px",a.style.height=`${a.scrollHeight}px`),this.dispatchEvent(new Event("change"))}onClear(e){e.preventDefault(),e.stopPropagation(),this.value="",this.dispatchEvent(new Event("change")),this.inputRef.value?.focus()}render(){const t=this.singleLine?e.x`<input ${e.$(this.inputRef)} type="text" class="${this.inputClassName}" placeholder="${this.placeholder}" .value="${this.value||""}" @input="${this.onInput}">`:e.x`<textarea ${e.$(this.inputRef)} rows="1" class="${this.inputClassName}" placeholder="${this.placeholder}" .value="${this.value||""}" @input="${this.onInput}"></textarea>`;return e.x`<div class="flex items-center justify-between"> ${t} ${this.clearable?e.u({appearance:"secondary",leadingIcon:e.al({size:e.I.Small}),size:e.v.Small,attributes:{"aria-label":"Close",tabindex:"0",onclick:this.onClear}}):e.A} </div> ${this.automationOutcomes.length?e.x`<automation-rule-triggered-rules .automationOutcomes="${this.automationOutcomes}" has-focus is-preview></automation-rule-triggered-rules>`:e.A}`;}};e._([e.n({type:String,attribute:"input-class-name"})],f.prototype,"inputClassName",void 0),e._([e.n({type:String})],f.prototype,"placeholder",void 0),e._([e.n({type:Array,attribute:"automation-outcomes"})],f.prototype,"automationOutcomes",void 0),e._([e.n({type:Boolean,attribute:"single-line"})],f.prototype,"singleLine",void 0),e._([e.n({type:Boolean})],f.prototype,"clearable",void 0),e._([e.j()],f.prototype,"value",void 0),f=e._([e.e("live-preview-text-input")],f);const S={[t.b.Text]:{label:()=>"Text",icon:()=>e.x`${u.t({size:e.I.Medium})}`,panel:()=>e.x``},[t.b.Link]:{label:()=>"Link",icon:()=>e.x`${l.l({size:e.I.Medium})}`,panel:()=>e.x` <live-preview-text-input name="post-url-input" input-class-name="${A} text-16 mt-md mb-sm" placeholder="${"Enter link"}" single-line clearable></live-preview-text-input> `},[t.b.Image]:{label:()=>"Image",icon:()=>e.x`${r.i({size:e.I.Medium})}`,panel:()=>e.x`<div class="relative"> <img src="${`${CLIENT_CONFIG.STATIC_BASE_URL}assets/mod/tawny_frog_mouth_2x.jpg`}" alt="snoo thinking" class="w-full h-auto"> ${e.u({appearance:"media",leadingIcon:e.x`${e.al({size:e.I.Small})}`,attributes:{className:"absolute top-sm end-sm"},size:e.v.Small})} </div>`},[t.b.Gallery]:{label:()=>"Gallery",icon:()=>e.x`${t.g({size:e.I.Medium})}`,panel:()=>e.x` <div class="relative"> <img src="${`${CLIENT_CONFIG.STATIC_BASE_URL}assets/mod/tawny_frog_mouth_2x.jpg`}" alt="snoo thinking" class="w-full h-auto"> ${e.u({appearance:"media",leadingIcon:e.x`${e.al({size:e.I.Small})}`,attributes:{className:"absolute top-sm end-sm"},size:e.v.Small})} <faceplate-pagination-indicator pages="3" page-index="0" appearance="media" class="absolute bottom-sm left-1/2 -translate-x-1/2"></faceplate-pagination-indicator> </div> `},[t.b.Video]:{label:()=>"Video",icon:()=>e.x`${d.v({size:e.I.Medium})}`,panel:()=>e.x`<div class="relative rounded-lg overflow-hidden"> <img src="${`${CLIENT_CONFIG.STATIC_BASE_URL}assets/mod/tawny_frog_mouth_2x.jpg`}" alt="snoo thinking" class="w-full h-auto"> ${e.u({appearance:"media",leadingIcon:e.x`${e.al({size:e.I.Small})}`,attributes:{className:"absolute top-sm end-sm"},size:e.v.Small})} ${e.u({appearance:"media",leadingIcon:e.x`${n.p({size:e.I.Small})}`,attributes:{className:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2"},size:e.v.Small})} </div>`},[t.b.Poll]:{label:()=>"Poll",icon:()=>e.x`${v({size:e.I.Medium})}`,panel:()=>e.x` <div class="relative border border-solid border-neutral-border rounded-md p-sm gap-sm flex flex-col items-start"> ${e.u({appearance:"secondary",size:e.v.Small,children:"Poll ends in 2 days",attributes:{disabled:!0},trailingIcon:e.x`${a.c({size:e.I.Small})}`})} <faceplate-text-input placeholder="${"Option 1"}" disabled="disabled" class="w-full"></faceplate-text-input> <faceplate-text-input placeholder="${"Option 2"}" disabled="disabled" class="w-full"></faceplate-text-input> ${e.u({appearance:"secondary",leadingIcon:e.x`${N({size:e.I.Small})}`,size:e.v.Small,children:"Add poll option",attributes:{disabled:!0}})} ${e.u({appearance:"secondary",leadingIcon:e.x`${e.al({size:e.I.Small})}`,attributes:{className:"absolute top-sm end-sm"},size:e.v.Small})} </div>`},[t.b.Ama]:{label:()=>"AMA",icon:()=>e.x`${g({size:e.I.Medium})}`,panel:()=>e.x`<div class="relative border border-solid border-neutral-border rounded-[24px] p-sm gap-sm flex flex-col items-start"> <h3 class="text-16 font-bold m-0 my-sm"> ${"AMA"} </h3> ${a.d({children:e.x`<div class="flex flex-col items-start"> <span class="text-12 text-neutral-content-weak"> ${"Start date"} </span> <span class="text-16 mt-2xs"> ${"Start now"} </span> </div>`,attributes:{disabled:!0,id:"select",className:"w-full h-fit pt-[10px] pb-[6px] px-md justify-between rounded-md"}})} <div class="w-auto p-md h-[200px] bg-secondary-background rounded-md gap-sm flex flex-col items-center justify-center cursor-not-allowed"> ${r.i({size:e.I.Medium})} <h3 class="text-16 font-bold m-0"> ${"Add a selfie"} </h3> <p class="text-14 text-neutral-content-weak m-0 text-center"> ${"Most guests add a selfie  with a note containing the community name name, date, and time"} </p> </div> ${e.u({appearance:"secondary",leadingIcon:e.x`${e.al({size:e.I.Small})}`,attributes:{className:"absolute top-sm end-sm"},size:e.v.Small})} </div>`},[t.b.Crosspost]:{label:()=>"Crosspost",icon:()=>e.x`${o.c({size:e.I.Medium})}`,panel:()=>e.x`<div class="relative border border-solid border-neutral-border rounded-md p-sm"> <div class="flex gap-2xs mb-2xs"> ${s.c({size:e.I.Small})} <span class="text-12 text-neutral-content-weak"> ${"r/reddit · 4h · u/test-user"} </span> </div> <p class="text-14 m-0 font-semibold text-neutral-content-strong"> ${"Test out your automations in our live previewer!"} </p> </div>`}};let L=class extends k{constructor(){super(...arguments),this.subredditIcon="",this.subredditName="",this.postTypes=[t.b.Text]}get postTitle(){return this.shadowRoot?.querySelector('live-preview-text-input[name="post-title-text-input"]')?.value??""}get postBody(){return this.shadowRoot?.querySelector('live-preview-text-input[name="post-body-text-input"]')?.value??""}get automationOutcomesForPostTitle(){return this.supressValidation?[]:[...this.getAutomationOutcomesByStringFeature(e.dp.PostTitle),...this.getAutomationOutcomesByStringFeature(e.dp.UserFlairTemplateId)]}get automationOutcomesForPostBody(){return this.supressValidation?[]:this.getAutomationOutcomesByStringFeature(e.dp.PostBody)}getTitleText(){return""}getSubmitButtonText(){return "Next";}async validateAutomationRules(){if(this.previewAutomationInput){const t=await async function(t,a){const i={subredditId:t,input:a};try{const{errors:t,data:a}=await e.ag({operation:e.af.PreviewPostAutomation,variables:i});if(t.length>0||!a?.subredditInfoById||!("previewPostAutomation"in a.subredditInfoById))throw new Error;return a.subredditInfoById.previewPostAutomation}catch(e){throw new Error("Something went wrong with preview post automation. Please try again later")}}(this.subredditId,{postTitle:this.postTitle,postBody:this.postBody,...(this.authorFlairId ? {authorFlair:{templateId:this.authorFlairId}} : {}),previewAutomation:this.previewAutomationInput});if(!t?.ok)throw new Error("Failed to receive successful response from previewPostAutomation GQL query");return t.result?.outcomes??[]}{const t=await async function(t,a){const i={subredditId:t,input:a},{errors:n,data:s}=await e.ag({operation:e.af.ModeratorEvaluatePostAutomations,variables:i});if(n.length>0||!s.subredditInfoById||!("moderatorEvaluatePostAutomations"in s.subredditInfoById)||!s.subredditInfoById.moderatorEvaluatePostAutomations.ok)throw new Error("Received invalid data from moderatorEvaluatePostAutomations GQL query");return s.subredditInfoById.moderatorEvaluatePostAutomations}(this.subredditId,{postTitle:this.postTitle,postBody:this.postBody,...(this.authorFlairId ? {authorFlair:{templateId:this.authorFlairId}} : {}),onOrAfterSubmit:this.onOrAfterSubmit});if(!t?.ok)throw new Error("Failed to receive successful response from moderatorEvaluatePostAutomations GQL query");return t.result?.outcomes??[]}}onPostTitleOrBodyChange(){this.requestUpdate(),this.validate()}renderHeader(){return e.x` <div class="flex items-center mt-lg mb-sm"> <div class="flex flex-1 items-center"> ${(t=this.subredditIcon, m.e({children:t?e.x`<img width="32" height="32" src="${t}" alt="subreddit icon">`:e.x`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="var(--color-primary)"> <path d="M16.5,2.924,11.264,15.551H9.91L15.461,2.139h.074a9.721,9.721,0,1,0,.967.785ZM8.475,8.435a1.635,1.635,0,0,0-.233.868v4.2H6.629V6.2H8.174v.93h.041a2.927,2.927,0,0,1,1.008-.745,3.384,3.384,0,0,1,1.453-.294,3.244,3.244,0,0,1,.7.068,1.931,1.931,0,0,1,.458.151l-.656,1.558a2.174,2.174,0,0,0-1.067-.246,2.159,2.159,0,0,0-.981.215A1.59,1.59,0,0,0,8.475,8.435Z"/> </svg>`,appearance:"icon",size:"sm"}))} <span class="px-xs text-14">r/${this.subredditName||""}</span> ${a.c({size:e.I.Small})} </div> <span class="text-12 text-neutral-content-weak">${"RULES"}</span> </div> ${e.x`<div class="w-100 border-b-[1px] border-tone-4 border-solid"></div>`} `;var t}renderTypeTabPanels(){return e.x` <faceplate-tabpanel id="post-type-tabs" class="text-14 mb-sm" pages="${Object.keys(S).length+1}" pageindex="1"> ${this.postTypes.map(((t,a)=>e.x`<div slot="page-${a+1}"> ${S[t].panel()} </div>`))} </faceplate-tabpanel> `}renderTypeTabs(){return this.postTypes.length<2?e.x``:e.x` <faceplate-tabgroup for="post-type-tabs"> ${this.postTypes.map(((e,t)=>{const a=S[e],n=a?.icon();return i.t({size:i.T.Small,appearance:i.a.Fill,selected:0===t,attributes:{type:"button",className:"p-md",slot:`page-${t+1}`},leadingIcon:n})}))} </faceplate-tabgroup> `}renderInputFields(){const t=0===this.postBody.length&&0===this.postTitle.length&&!this.onOrAfterSubmit,a="Test out your new rule by entering a title or body text.";return e.x` <live-preview-text-input name="post-title-text-input" input-class-name="${A} text-18 font-bold mt-md mb-sm" placeholder="${"Add title text"}" automation-outcomes="${JSON.stringify(this.automationOutcomesForPostTitle)}" @change="${this.onPostTitleOrBodyChange}"></live-preview-text-input> ${this.showPostTypes?this.renderTypeTabPanels():e.A} <live-preview-text-input name="post-body-text-input" input-class-name="${A} text-14" placeholder="${"Add body text"}" automation-outcomes="${JSON.stringify(this.automationOutcomesForPostBody)}" @change="${this.onPostTitleOrBodyChange}"></live-preview-text-input>${t?b(a):e.A}`;}};e._([e.n({type:String,attribute:"subreddit-icon"})],L.prototype,"subredditIcon",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],L.prototype,"subredditName",void 0),e._([e.n({type:Array,attribute:"post-types"})],L.prototype,"postTypes",void 0),L=e._([e.e("post-live-preview")],L);let P=class extends k{get commentBody(){return this.shadowRoot?.querySelector('live-preview-text-input[name="comment-body-text-input"]')?.value??""}get automationOutcomesForComment(){return this.supressValidation?[]:[...this.getAutomationOutcomesByStringFeature(e.dp.CommentBody),...this.getAutomationOutcomesByStringFeature(e.dp.UserFlairTemplateId)]}getTitleText(){return "Add comment";}renderTypeTabs(){return""}getSubmitButtonText(){return "Add";}async validateAutomationRules(){const t=this.previewAutomationInput?await async function(t,a){const i={subredditId:t,input:a},{errors:n,data:s}=await e.ag({operation:e.af.PreviewCommentAutomation,variables:i});if(n.length>0||!s.subredditInfoById||!("previewCommentAutomation"in s.subredditInfoById)||!s.subredditInfoById.previewCommentAutomation.ok)throw new Error("Received invalid data from previewCommentAutomation GQL query");return s.subredditInfoById.previewCommentAutomation}(this.subredditId,{commentBody:this.commentBody,...(this.authorFlairId ? {authorFlair:{templateId:this.authorFlairId}} : {}),previewAutomation:this.previewAutomationInput}):await async function(t,a){const i={subredditId:t,input:a},{errors:n,data:s}=await e.ag({operation:e.af.ModeratorEvaluateCommentAutomations,variables:i});if(n.length>0||!s.subredditInfoById||!("moderatorEvaluateCommentAutomations"in s.subredditInfoById)||!s.subredditInfoById.moderatorEvaluateCommentAutomations.ok)throw new Error("Received invalid data from moderatorEvaluateCommentAutomations GQL query");return s.subredditInfoById.moderatorEvaluateCommentAutomations}(this.subredditId,{commentBody:this.commentBody,...(this.authorFlairId ? {authorFlair:{templateId:this.authorFlairId}} : {}),onOrAfterSubmit:this.onOrAfterSubmit});return t.result?.outcomes??[]}onCommentBodyChange(){this.requestUpdate(),this.validate()}renderHeader(){return e.x` <span class="text-12 py-lg">${"Some post that you're commenting on."}</span>`;}renderInputFields(){const t=0===this.commentBody.length&&!this.onOrAfterSubmit,a="Test out your new rule by entering a comment text.";return e.x`<live-preview-text-input name="comment-body-text-input" input-class-name="${A} text-14 mt-md" placeholder="${"Add comment text"}" automation-outcomes="${JSON.stringify(this.automationOutcomesForComment)}" @change="${this.onCommentBodyChange}"></live-preview-text-input>${t?b(a):e.A}`;}};P=e._([e.e("comment-live-preview")],P);let y=class extends e.s{constructor(){super(),this.subredditIcon="",this.subredditName="",this.subredditId="",this.flairPickerId="",this.automationTrigger=e.dn.Post,this.suppressValidation=!1,this.automationPostTypes=[t.b.Text],this.showPostTypes=!1,this.livePreviewRef=e.Z(),e.eA(this)}static get styles(){return[e.t]}renderPreviewer(){switch(this.automationTrigger){case e.dn.Post:return e.x`<post-live-preview ${e.$(this.livePreviewRef)} ?show-post-types="${this.showPostTypes}" post-types="${e.aa(this.automationPostTypes?JSON.stringify(this.automationPostTypes):void 0)}" subreddit-name="${this.subredditName}" subreddit-icon="${this.subredditIcon}" subreddit-id="${this.subredditId}" preview-automation-input="${JSON.stringify(this.previewAutomationInput)}" ?suppress-validation="${this.suppressValidation}"> </post-live-preview>`;case e.dn.Comment:return e.x`<comment-live-preview ${e.$(this.livePreviewRef)} subreddit-id="${this.subredditId}" preview-automation-input="${JSON.stringify(this.previewAutomationInput)}" ?suppress-validation="${this.suppressValidation}"> </comment-live-preview>`}}render(){return e.x`<div class="mb-md"> <slot name="fake-flair-picker" slot="fake-flair-picker"></slot> </div> ${this.renderPreviewer()} `}};e._([e.n({type:String,attribute:"subreddit-icon"})],y.prototype,"subredditIcon",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],y.prototype,"subredditName",void 0),e._([e.n({type:String,attribute:"subreddit-id"})],y.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"flair-picker-id"})],y.prototype,"flairPickerId",void 0),e._([e.n({type:String,attribute:"automation-trigger"})],y.prototype,"automationTrigger",void 0),e._([e.n({type:Object,attribute:"preview-automation-input"})],y.prototype,"previewAutomationInput",void 0),e._([e.n({type:Boolean,attribute:"suppress-validation"})],y.prototype,"suppressValidation",void 0),e._([e.n({type:Array,attribute:"automation-post-types"})],y.prototype,"automationPostTypes",void 0),e._([e.n({type:Boolean,attribute:"show-post-types"})],y.prototype,"showPostTypes",void 0),y=e._([e.e("automation-rule-live-preview")],y)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("BCGnAhoEkK",["CYrPuvCiTj"],(async e=>{const t="comment_draft",n="draft";var o;!function(e){e.Save="save",e.Open="open",e.Submit="submit",e.Delete="delete",e.AutoDelete="auto_delete"}(o||(o={}));return{get C(){return o},c:(o,c)=>c?e.c({source:t,action:o,noun:n},{comment_draft:{length:c}}):e.c({source:t,action:o,noun:n})}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./pkk--QZ7vd.js",import.meta.url,"pkk--QZ7vd");SML.di("./D4Ab94OqLr.js",import.meta.url,"D4Ab94OqLr");SML.di("./DCbB57ubLb.js",import.meta.url,"DCbB57ubLb");SML.di("./DVVJsZH047.js",import.meta.url,"DVVJsZH047");SML.di("./DS9WepT8W8.js",import.meta.url,"DS9WepT8W8");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./lEw4CeTWZd.js",import.meta.url,"lEw4CeTWZd");SML.di("./BXJPp76cO9.js",import.meta.url,"BXJPp76cO9");SML.di("./K6BvuFajM1.js",import.meta.url,"K6BvuFajM1");SML.di("./CEf2DD9Ins.js",import.meta.url,"CEf2DD9Ins");SML.di("./CG47sgWgmT.js",import.meta.url,"CG47sgWgmT");SML.di("./DgoM9Eeg91.js",import.meta.url,"DgoM9Eeg91");SML.di("./C7_NSrottS.js",import.meta.url,"C7_NSrottS");SML.di("./nC5ghTdpSV.js",import.meta.url,"nC5ghTdpSV");SML.di("./vS6eWPysSE.js",import.meta.url,"vS6eWPysSE");SML.di("./jzmnNb68mH.js",import.meta.url,"jzmnNb68mH");SML.di("./DV-5OOn05m.js",import.meta.url,"DV-5OOn05m");SML.di("./BEOg1WTiXx.js",import.meta.url,"BEOg1WTiXx");SML.di("./BDMOQ0-Tf9.js",import.meta.url,"BDMOQ0-Tf9");SML.di("./vhsAG6S_0w.js",import.meta.url,"vhsAG6S_0w");SML.di("./D0lCIVsZym.js",import.meta.url,"D0lCIVsZym");SML.di("./B58tzg41t5.js",import.meta.url,"B58tzg41t5");SML.di("./CVk7Sw8fup.js",import.meta.url,"CVk7Sw8fup");SML.di("./DFvuM_MTkg.js",import.meta.url,"DFvuM_MTkg");SML.di("./BDJEoZTk8V.js",import.meta.url,"BDJEoZTk8V");SML.di("./Q1SsBT7kMe.js",import.meta.url,"Q1SsBT7kMe");SML.di("./BvPcMFr1Lr.js",import.meta.url,"BvPcMFr1Lr");SML.di("./CcWrGyc4YB.js",import.meta.url,"CcWrGyc4YB");SML.di("./B8bPYlQRZA.js",import.meta.url,"B8bPYlQRZA");SML.di("./B74fdX6mon.js",import.meta.url,"B74fdX6mon");SML.di("./BaesuPO9Of.js",import.meta.url,"BaesuPO9Of");SML.di("./C7tY_fu9Em.js",import.meta.url,"C7tY_fu9Em");SML.di("./CigYKiUosZ.js",import.meta.url,"CigYKiUosZ");SML.di("./CApS9zNWCX.js",import.meta.url,"CApS9zNWCX");
SML.dm("BF58W2CBwW",["CYrPuvCiTj","pkk--QZ7vd","D4Ab94OqLr","DCbB57ubLb","DVVJsZH047","DS9WepT8W8","wzdls1o9Kk","lEw4CeTWZd","BXJPp76cO9","K6BvuFajM1","nC5ghTdpSV","vS6eWPysSE","jzmnNb68mH","DV-5OOn05m","BEOg1WTiXx","BDMOQ0-Tf9","vhsAG6S_0w","D0lCIVsZym","DFvuM_MTkg","BDJEoZTk8V","Q1SsBT7kMe","BaesuPO9Of","C7tY_fu9Em","CigYKiUosZ","CApS9zNWCX","CEf2DD9Ins","CG47sgWgmT","DgoM9Eeg91","C7_NSrottS","B58tzg41t5","CVk7Sw8fup","BvPcMFr1Lr","CcWrGyc4YB","B8bPYlQRZA","B74fdX6mon"],(async(e,t,i,o,r,n,s,a,l,d,c,u,h,p,g,m,b,f,v,E,C,y,T,w,I)=>{const x="subredditName",_=["r","x"],S=_.join("|"),R=({prefix:e=_[0],...t})=>{const i=s.d((({withAbout:e,aboutOptional:t}={})=>`/:prefix(${S})/:${x}/${e?":page(about/?)"+(t?"?":""):""}`)({withAbout:!0,aboutOptional:!0}))({...t,prefix:e});return t.omitLeadingSlash?i.substring(1):i},k="rte-open-link-dialog-event",N="rte-open-action-link-dialog-event";function L(e,t){return!t||r.i(e,t,o.o)}const M={onError:e=>{console.error(e)},nodes:r.S,editable:!1,theme:{text:{strikethrough:"line-through",underlineStrikethrough:"line-through"},paragraph:"first:mt-0 last:mb-0",blockCursor:"h-[20px] mb-md mt-[14px] first:mt-0 last:mb-0 cursor-text animate-blink border-transparent border-solid border-y-0 border-r-0"}},D={validChildren:["*"]};function P(e,t){return t.reduce(((e,{nodeType:t,nodeTypeConfig:i})=>O(e,t,i)),e)}function O(e,t,i=D){var o;const{lexical:r}=e;if(r.nodes||(r.nodes=[]),r.nodes.includes(t)||r.nodes.push(t),function(e){return void 0!==e.getType?.()}(t)){const r=t.getType();e.nodes??(e.nodes={}),(o=e.nodes)[r]??(o[r]={validChildren:["*"]}),i.validChildren&&(e.nodes[r].validChildren=i.validChildren.slice())}return e}function A(t){const i=o.d({...M,...t.lexical,namespace:"reddit-rte"+Math.random()});return function(e,t){e.registerCommand(o.M,(i=>{const n=o.E();if(!o.u(n))return!1;i.preventDefault();const s=navigator.userAgent.includes("Mac")?i?.metaKey:i?.ctrlKey;if("true"===t.plugins.composer?.noLinebreakOnMetaEnter&&s)return!0;const a=n.getNodes(),l=a[a.length-1];return l.getParents().some(o.K)&&!i?.shiftKey||o.p(l)||r.a(l)||l.getParents().some(r.a)||l.getParents().some(o.q)?(o.p(l)&&!l.getParents().some(o.r)&&l.remove(),e.dispatchCommand(o.h,void 0)):e.dispatchCommand(o.f,!1)}),o.s)}(i,t),i.registerDecoratorListener((t=>{Object.keys(t).forEach((o=>{const r=i.getElementByKey(o);null!==r&&e.aR(t[o],r)}))})),i}function B(e){return t=>{if(function(e){const t=o.E();if(o.u(t)){const[i]=t.getNodes();if(o.w(i))return i.getTextContent()===e}return!1}(t)&&!function(e){const t=o.E();if(o.u(t)){const[i]=t.getNodes();return L(e,i.getParent())}return!1}(e))return null;const i=n.a.match(t);if(null==i||0===i.length)return null;const r=i[0].text.length,s=i[0].index;return{start:s,end:s+r}}}const $=new Map;function U(t,i){const o=new r.f(t.getEditor(),i,(async(i,o)=>{if(i.startsWith("u/")){const e=i.substring(2).toLowerCase();return t.redditorMetadata.filter((({name:t})=>t.toLowerCase().startsWith(e))).slice(0,10).map((({id:e,name:t})=>({id:e,text:`u/${t}`})))}const r=i.substring(2).toLowerCase(),n=await async function(t,i){const o=await e.ag({operation:e.af.SubredditTypeahead,variables:{query:t,productSurface:e.be.Desktop,filters:[]},init:i});if(o.errors.length>0)throw new Error(o.errors.map((e=>e.message)).join(", "));if(!o.data.search?.typeaheadByType?.subreddits)throw new Error("Payload does not have any data for SubredditTypeahead query "+t);return o.data.search?.typeaheadByType?.subreddits.reduce(((e,t)=>{if(!t)return e;const{id:i,isNsfw:o,name:r}=t;return e.push({id:i,isNsfw:o,name:r}),e}),[])}(r,o);return n.slice(0,10).map((e=>({text:R({subredditName:e.name,omitLeadingSlash:!0}),id:e.id})))}));return o.classList.add("z-10"),o}function F(e){return O(e,r.b,{validChildren:[]})}function H(e){const t=e.getEditor();if(!t.hasNodes([r.b]))throw new Error("RedditMentionNode not registered on editor");o.t(...o.v(t,B(e),r.b,(e=>{const t=n.a.match(e.getTextContent());return r.g(t[0].text)})));const i=t._config.namespace,s=()=>$.has(i),a=()=>$.get(i),l=()=>{if(s()){const[t,o]=a();t.destroy(),e.removeChild(o),$.delete(i)}};t.registerCommand(o.X,(()=>(l(),!1)),o.s),t.registerUpdateListener((({editorState:n})=>{n.read((()=>{const n=o.E();if(!(o.u(n)&&r.c(n,r.d)))return void l();if(n.anchor.key!==n.focus.key||n.anchor.offset!==n.focus.offset)return void l();const d=n.getNodes().find((e=>r.d(e))),c=t.getElementByKey(d.getKey()),u=d.getTextContent();if(s()){const[,e]=a();return void e.setQuery(u)}const h=U(e,d);e.appendChild(h);const p=r.e(c,h,{placement:"auto-start",strategy:"fixed",modifiers:[{name:"flip",options:{allowedAutoPlacements:["bottom-start","top-start"]}},{name:"offset",options:{offset:[0,2]}}]});h.setQuery(u),((e,t)=>{$.set(i,[e,t])})(p,h)}))}))}function j(){return e.x`<rte-plugin .beforeCreateEditorCallback="${F}" .createEditorCallback="${H}"></rte-plugin>`}const V="min-h-[44px]",z="min-h-[7rem]",K="rte-show-table-menu-event";function q(e){const t={};return e.forEach((e=>{const i=e.dataset.key;if(i){const o={...e.dataset};delete o.key,t[i]=o}})),t}function G(e,t){if(void 0===e)return t;const i=parseInt(e,10);return Number.isNaN(i)?t:i}const Y=[function(e){const t=n.b(e);return null===t?null:{index:t.index,length:t.text.length,text:t.text,url:t.url,attributes:{target:"_blank"}}}];function W(e,t){for(let i=0;i<t.length;i++){const o=t[i](e);if(o)return o}return null}const J=/[,;\s]/;function X(e){return J.test(e)}function Q(e){return X(e[e.length-1])}function Z(e){return X(e[0])}function ee(e){let t=e.getPreviousSibling();return o.g(t)&&(t=t.getLastDescendant()),null===t||o.p(t)||o.w(t)&&Q(t.getTextContent())}function te(e){let t=e.getNextSibling();return o.g(t)&&(t=t.getFirstDescendant()),null===t||o.p(t)||o.w(t)&&Z(t.getTextContent())}function ie(e,t,i,o){return!!(e>0?X(i[e-1]):ee(o))&&(t<i.length?X(i[t]):te(o))}function oe(e,t,i){const r=e.getChildren(),n=r.length;for(let t=0;t<n;t++){const n=r[t];if(!o.w(n)||!n.isSimpleText())return re(e),void i(null,e.getURL())}const s=e.getTextContent(),a=W(s,t);if(null===a||a.text!==s)return re(e),void i(null,e.getURL());if(!ee(e)||!te(e))return re(e),void i(null,e.getURL());const l=e.getURL();l!==a.url&&(e.setURL(a.url),i(a.url,l))}function re(e){const t=e.getChildren();for(let i=t.length-1;i>=0;i--)e.insertAfter(t[i]);return e.remove(),t.map((e=>e.getLatest()))}function ne(e){return P(e,[{nodeType:r.h,nodeTypeConfig:{validChildren:[o.j.getType()]}},{nodeType:{replace:o.A,with:e=>new r.h(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle()}),withKlass:r.h}}])}function se(e,t){const i=e.getEditor();if(!i.hasNodes([r.h]))throw new Error("RedditAutoLinkNode: RedditAutoLinkNode is not registered for the editor");const s=(e,i)=>{t&&t(e,i)};o.t(i.registerNodeTransform(o.j,(t=>{const i=t.getParentOrThrow(),a=t.getPreviousSibling();i&&r.k(i)&&i.getIsUnlinked()||(r.k(i)?oe(i,Y,s):L(e,i)&&(r.l(i)&&n.b(t.getTextContent())||!t.isSimpleText()||!Z(t.getTextContent())&&a&&r.k(a)||function(e,t,i){const n=e.getTextContent();let s,a=n,l=0,d=e;for(;(s=W(a,t))&&null!==s;){const t=s.index,c=s.length,u=t+c;if(ie(l+t,l+u,n,e)){let e;l+t===0?[e,d]=d.splitText(l+c):[,e,d]=d.splitText(l+t,l+t+c);const n=r.m(s.url,s.attributes??{}),a=o.Z(s.text);a.setFormat(e.getFormat()),a.setDetail(e.getDetail()),n.append(a),e.replace(n),i(s.url,null),l=0}else l+=u;a=a.substring(u)}}(t,Y,s),function(e,t,i){const o=e.getPreviousSibling(),n=e.getNextSibling(),s=e.getTextContent();s!==r.B&&(o&&r.k(o)&&!Z(s)&&(o.append(e),oe(o,t,i),i(null,o.getURL())),n&&r.k(n)&&!Q(s)&&(re(n),oe(n,t,i),i(null,n.getURL())))}(t,Y,s)))})),i.registerCommand(r.j,(e=>{if(!e.currentSelection)return!1;if(!o.u(e.currentSelection))return!1;const t=e.currentSelection.focus.getNode().getParent();if(!t||!r.k(t))return!1;const i=e.currentSelection.clone();return o.l(i),t.setIsUnlinked(!0),r.r(t.getKey()),!0}),o.R))}function ae(){return e.x`<rte-plugin .beforeCreateEditorCallback="${ne}" .createEditorCallback="${se}"></rte-plugin>`}const le=new Set([o.y.getType(),o.C.getType(),o.$.getType()]);function de(e){const t=e.getEditor();return t.registerCommand(o.D,(e=>{const i=o.E();if(!o.u(i))return!1;return!!i.getNodes().some((e=>o.G(e,(e=>le.has(e.getType())))))&&(e.preventDefault(),t.dispatchCommand(e.shiftKey?o.H:o.N,void 0))}),o.O)}function ce(){return e.x`<rte-plugin .createEditorCallback="${de}"></rte-plugin>`}function ue(e,t,i=1e3){const r=e.getEditor();o.P(r,t||o.Q(),i)}function he(){return e.x`<rte-plugin .createEditorCallback="${ue}"></rte-plugin>`}const pe="rte-toolbar-button-click";var ge;!function(e){e.Bold="bold",e.Italic="italic",e.Strikethrough="strikethrough",e.Superscript="superscript",e.BlockQuote="blockquote",e.CodeBlock="codeblock",e.CodeHighlight="code",e.Heading="heading",e.Link="link",e.BulletList="bulletlist",e.NumberList="numberlist",e.Spoiler="spoiler",e.Table="table",e.Gif="gif",e.Image="image",e.ImageFromURL="imageFromURL",e.Video="video",e.Embed="embed"}(ge||(ge={}));let me=class extends r.n{constructor(){super(...arguments),this.removeEditableListener=null,this.isMobile=!1,this.selected=!1,this.ignoreFocus=!1,this.isToggle=!1,this._disabled=!1}static get styles(){return[e.t,e.V("rte-toolbar-button {\n  background: var(--button-color-background);\n  border-radius: 999px;\n  border: none;\n  border: var(--button-border-width, 0) solid var(--button-border-color, transparent);\n  box-shadow: var(--button-shadow);\n  box-sizing: border-box;\n  color: var(--button-color-text);\n  cursor: pointer;\n  display: inline-block;\n  font: var(--button-font);\n  height: var(--button-height);\n  line-height: calc(var(--button-height) - (2 * var(--button-border-width, 0px)));\n  overflow: hidden;\n  padding: 0 calc(var(--button-padding) - var(--button-border-width, 0px));\n  text-align: center;\n  text-decoration: none;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  outline-offset: 0;\n  --button-border-color: var(--button-border-color-default);\n  --button-border-width: var(--button-border-width-default);\n  --button-color-background: var(--button-color-background-default);\n  --button-color-text: var(--button-color-text-default);\n  /* Media query prevents sticky :hover states on mobile */\n  /* This is :active, AKA Pressed */\n  /* This is Selected */\n  --button-height: var(--size-button-sm-h);\n  --button-padding: var(--spacer-2xs);\n  --button-font: var(--font-button-sm);\n  --button-border-width-default: var(--line-button-sm-border);\n  --button-color-background-default: var(--color-primary-background);\n  --button-color-background-focus: var(--color-primary-background);\n  --button-color-background-hover: var(--color-button-primary-background-hover);\n  --button-color-background-active: linear-gradient(var(--color-button-primary-background-hover), var(--color-button-primary-background-hover));\n  --button-color-background-disabled: var(--color-button-primary-background-disabled);\n  --button-color-background-activated: var(--color-button-primary-background-activated);\n  --button-color-text-default: var(--color-global-white);\n  --button-color-text-disabled: var(--color-button-primary-text-disabled);\n  --button-color-text-activated: var(--color-button-primary-text-activated);\n  --button-border-color-default: transparent;\n}\nrte-toolbar-button.icon {\n  width: var(--button-height);\n}\nrte-toolbar-button .button-icon {\n  margin-inline-end: var(--spacer-xs);\n}\nrte-toolbar-button .dropdown-icon {\n  transform: rotate(0deg);\n  transition: transform 0.2s ease-in-out;\n}\nrte-toolbar-button:focus {\n  --button-color-overlay: var(--color-button-overlay-focus);\n}\nrte-toolbar-button.hover {\n  --button-color-overlay: var(--color-button-overlay-focus);\n  --button-border-color: var(--button-border-color-hover);\n  --button-color-background: var(--button-color-background-hover);\n  --button-color-text: var(--button-color-text-hover, var(--button-color-text-default));\n}\n@media (hover: hover) {\n  rte-toolbar-button:hover {\n    --button-color-overlay: var(--color-button-overlay-focus);\n    --button-border-color: var(--button-border-color-hover);\n    --button-color-background: var(--button-color-background-hover);\n    --button-color-text: var(--button-color-text-hover, var(--button-color-text-default));\n  }\n}\nrte-toolbar-button:active,\nrte-toolbar-button.active {\n  --button-color-overlay: var(--color-button-overlay-active);\n  --button-color-background: linear-gradient(var(--color-interactive-pressed), var(--color-interactive-pressed)), var(--button-color-background-active);\n}\nrte-toolbar-button:disabled,\nrte-toolbar-button.anchor-disabled {\n  --button-border-color-hover: var(--button-border-color-default);\n  --button-color-background: var(--button-color-background-disabled);\n  --button-color-text: var(--button-color-text-disabled);\n  cursor: not-allowed;\n  pointer-events: none;\n}\nrte-toolbar-button.disabled.pointer-all {\n  --button-border-color-hover: var(--button-border-color-default);\n  --button-color-background: var(--button-color-background-disabled);\n  --button-color-text: var(--button-color-text-disabled);\n  cursor: not-allowed;\n  pointer-events: all;\n}\nrte-toolbar-button.button-activated {\n  --button-border-color: var(--button-border-color-activated);\n  --button-color-background: var(--button-color-background-activated);\n  --button-color-text: var(--button-color-text-activated);\n}\n.button:disabled,\n.button[aria-disabled='true'] {\n  color: var(--button-color-text-disabled);\n}\n.button[aria-disabled='true'] {\n  --button-border-color-hover: var(--button-border-color-default);\n  --button-color-background: var(--button-color-background-disabled);\n  --button-color-text: var(--button-color-text-disabled);\n}\nfaceplate-screen-reader-content {\n  border-width: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n}\n")]}shouldDisable(){return!!this._editor?.getEditorState().read((()=>this.$shouldDisable()))}$shouldDisable(){return!1}get disabled(){return this._disabled||!this._editor?.isEditable()||this.shouldDisable()}set disabled(e){const t=this.disabled;this._disabled=e,this.requestUpdate("disabled",t)}focusOnEditor(){this._editor?.dispatchCommand(a.R,{})}focus(){this.button?.focus()}createEditor(e){super.createEditor(e),this.requestUpdate();const t=this._editor;this.isMobile="true"===r.o(t,"plugins.composer.isMobile"),this.removeEditableListener=t.registerEditableListener((()=>{this.requestUpdate()})),t.registerCommand(o.Y,(()=>(`${this.disabled}`!==this.button?.ariaDisabled&&this.requestUpdate(),!1)),o.R)}updated(e){0===this.shadowRoot?.children.length?this.classList.add("disallowed-button"):this.classList.remove("disallowed-button")}disconnectedCallback(){this.removeEditableListener?.(),super.disconnectedCallback()}onClick(t){this.disabled?t.stopImmediatePropagation():this.name&&(this.dispatchEvent(e.d(pe,{name:this.name},!0)),t.preventDefault(),this.focusOnEditor(),this.handleClick())}handleClick(){throw new Error("Not implemented")}setTooltip(e){const t=this.tooltip?.querySelector("button");if(!t)return;this.shadowRoot?.removeChild(this.tooltip);const i=document.createElement(e);i.appendChild(t),t.setAttribute("slot","trigger"),this.shadowRoot?.appendChild(i)}render(){const{disabled:t,screenReaderContent:i,selected:o}=this,n=this._editor&&!this.isMobile,s={...{appearance:"plain",attributes:{className:"min-w-[2rem] text-secondary-weak","aria-disabled":`${t}`,onclick:this.onClick,tabindex:this.ignoreFocus?"-1":"0",type:"button"},shape:"pill",size:e.v.Small,screenReaderContent:i,selected:o}};return this.isToggle&&s.attributes&&(s.attributes["aria-pressed"]=this.selected?"true":"false"),void 0!==this.text&&(s.screenReaderContent??(s.screenReaderContent=this.text)),this.leadingIcon&&(s.leadingIcon=this.leadingIcon({size:e.a4.Small})),n?e.x`<rpl-tooltip class="flex" content="${s.screenReaderContent??""}">${r.p(s)}</rpl-tooltip>`:r.p(s)}};e._([e.n({type:Boolean})],me.prototype,"selected",void 0),e._([e.n({type:Boolean,attribute:"ignore-focus"})],me.prototype,"ignoreFocus",void 0),e._([e.n({type:String})],me.prototype,"name",void 0),e._([e.n({type:String})],me.prototype,"text",void 0),e._([e.n({type:String})],me.prototype,"screenReaderContent",void 0),e._([e.n()],me.prototype,"leadingIcon",void 0),e._([e.n({type:Boolean})],me.prototype,"isToggle",void 0),e._([e.Y("button")],me.prototype,"button",void 0),e._([e.Y("rpl-tooltip")],me.prototype,"tooltip",void 0),e._([e.j()],me.prototype,"_disabled",void 0),me=e._([e.e("rte-toolbar-button")],me);class be{constructor(e,t){(this.host=e).addController(this),this.disabled=e.disabled,this.selected=e.selected,this.toolbar=t}hostUpdate(){this.disabled===this.host.disabled&&this.selected===this.host.selected||(this.disabled=this.host.disabled,this.selected=this.host.selected,this.toolbar.requestUpdate())}}let fe=class extends e.s{static get styles(){return[e.t]}constructor(){super(),this.overflowItems=[]}handleKeyDown(e){"ArrowLeft"===e.key?(e.preventDefault(),this.moveFocus({isBackward:!0})):"ArrowRight"===e.key&&(e.preventDefault(),this.moveFocus({isBackward:!1}))}getNextChild(e,t,i=!1){let o=i?t-1:t+1;o<0?o=e.length-1:o>e.length-1&&(o=0);const r=e[o];return r instanceof me||r instanceof HTMLButtonElement?r:this.getNextChild(e,o,i)}getSlottedFixedChildren(){return this.shadowRoot.querySelector('slot[name="fixed"]')?.assignedElements({flatten:!0})||[]}blockFocusOnSlottedChildren(){for(const e of this.getSlottedFixedChildren())e.setAttribute("tabindex","-1"),e.setAttribute("slotted","true")}moveFocus({isBackward:e=!1}={}){this.overflowMenu?.hide();const t=[...(this.visibleChildren ?? []),...(this.overflowItems.length&&this.overflowMenuButton ? [this.overflowMenuButton] : []),...this.getSlottedFixedChildren()],i=this.focusedChild&&t?.findIndex((e=>e===this.focusedChild))||0,o=this.getNextChild(t,i??0,e);this.setFocusedChild({element:o,focusElementImmediately:!0})}setFocusedChild({element:e,focusElementImmediately:t=!1}){this.focusedChild?.getAttribute("slotted")?this.focusedChild.setAttribute("tabindex","-1"):this.focusedChild?.setAttribute("ignore-focus",""),e.getAttribute("slotted")?e.setAttribute("tabindex","0"):e.removeAttribute("ignore-focus"),this.focusedChild=e,t&&e.focus()}firstUpdated(e){super.firstUpdated(e);const t=this.visibleChildren?.[0];t&&"toolbar"===this.getAttribute("role")&&([...(this.visibleChildren ?? []),...(this.hiddenChildren ?? [])].forEach((e=>{e.setAttribute("ignore-focus","")})),this.blockFocusOnSlottedChildren(),this.setFocusedChild({element:t}),this.addEventListener("keydown",this.handleKeyDown))}updated(e){this.focusedChild&&this.overflowMenuButton&&this.hiddenChildren?.includes(this.focusedChild)&&this.setFocusedChild({element:this.overflowMenuButton}),super.updated(e)}connectedCallback(){super.connectedCallback(),this.resizeObserver=new ResizeObserver((()=>{this.requestUpdate()})),this.resizeObserver.observe(this)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.disconnect(),this.removeEventListener("keydown",this.handleKeyDown),this.hasUpdated=!1}focus(){this.focusedChild?.focus()}render(){const{overflowItems:t}=this;return e.x` <div class="px-xs py-2xs"> <div class="flex toolbar w-full max-w-full"> <div class="rte-toolbar-fixed ms-auto gap-2xs flex flex-nowrap flex-row-reverse grow-0 order-2"> <slot name="fixed"></slot> </div> <div class="rte-toolbar-responsive gap-2xs flex flex-row grow flex-nowrap order-1"> <slot name="responsive"></slot> <rpl-dropdown placement="bottom" style="--rpl-z-index-dropdown:10"> ${r.p({attributes:{className:"min-w-[2rem] text-secondary-weak ms-auto",tabindex:this.focusedChild&&this.hiddenChildren?.includes(this.focusedChild)||this.focusedChild instanceof HTMLButtonElement?"0":"-1","aria-label":"More options"},appearance:"plain",shape:"pill",size:e.v.Small,leadingIcon:l.o({size:e.I.Small})})} ${t.length>0?e.x`<rpl-menu slot="content" hidden class="max-h-[300px]">${t.map((e=>e.html))}</rpl-menu>`:e.x``} </rpl-dropdown> </div> </div> </div> `;}async getUpdateComplete(){const e=await super.getUpdateComplete(),t=(await (this.overflowMenu?.updateComplete))??!1;return e&&t}rteToolbarButtonToListItem(t){const{screenReaderContent:i,text:o,leadingIcon:r,disabled:n,selected:s}=t,a=new be(t,this);return{button:t,disabled:n,controller:a,html:e.x`<rpl-menu-item appearance="default" ?disabled="${n}" ?selected="${s}" @click="${e=>{e.preventDefault(),t.shadowRoot?.querySelector("button")?.click()}}"> ${i||o||""} ${r?r({size:e.I.Small,attributes:{slot:"leading-icon"}}):e.x``} </rpl-menu-item>`}}htmlButtonToListItem(t){const{disabled:i,textContent:o}=t;return{button:t,disabled:i,html:e.x`<rpl-menu-item appearance="default" ?disabled="${i}" @click="${()=>t.click()}"> ${o||""} ${d.t({size:e.I.Small,attributes:{slot:"leading-icon"}})} </rpl-menu-item>`}}willUpdate(){if(!(this.toolbarContainer&&this.fixedButtonsContainer&&this.responsiveButtonsContainer&&this.overflowMenu&&this.hiddenChildren&&this.visibleChildren))return;const{width:e}=this.toolbarContainer.getBoundingClientRect(),{width:t}=this.fixedButtonsContainer.getBoundingClientRect();for(const e of this.hiddenChildren??[])e.classList.remove("hidden");for(const{button:e,controller:t}of this.overflowItems)e instanceof me&&t&&e.removeController(t);this.overflowMenu.classList.add("hidden");const{width:i,x:o}=this.responsiveButtonsContainer.getBoundingClientRect();this.overflowMenu.classList.remove("hidden");const r=this.responsiveButtonsContainer.getBoundingClientRect().width-i,n=e-t;if(i<=n)this.overflowMenu.classList.add("hidden"),this.overflowItems.length>0&&(this.overflowItems=[]),this.focusedChild===this.overflowMenuButton&&this.setFocusedChild({element:this.visibleChildren[0]});else{const{visibleChildren:e}=this,t=n-r,i=e.findIndex((e=>{const{x:i,width:r}=e.getBoundingClientRect();return(e instanceof me||e instanceof HTMLButtonElement)&&i-o+r>t}));if(i>0){const t=e[i-1];t instanceof HTMLHRElement&&t.classList.add("hidden")}const s=[];e.slice(i).forEach((e=>{e.classList.add("hidden"),e instanceof me?s.push(this.rteToolbarButtonToListItem(e)):e instanceof HTMLButtonElement&&s.push(this.htmlButtonToListItem(e))})),this.overflowItems=s}}};e._([e.Y(".toolbar")],fe.prototype,"toolbarContainer",void 0),e._([e.Y(".toolbar .rte-toolbar-responsive")],fe.prototype,"responsiveButtonsContainer",void 0),e._([e.Y(".toolbar .rte-toolbar-fixed")],fe.prototype,"fixedButtonsContainer",void 0),e._([e.Y("rpl-dropdown")],fe.prototype,"overflowMenu",void 0),e._([e.Y("rpl-dropdown > button")],fe.prototype,"overflowMenuButton",void 0),e._([e.r({slot:"responsive",flatten:!0,selector:".hidden:not(.disallowed-button)"})],fe.prototype,"hiddenChildren",void 0),e._([e.r({slot:"responsive",flatten:!0,selector:":not(.hidden)"})],fe.prototype,"visibleChildren",void 0),e._([e.j()],fe.prototype,"overflowItems",void 0),e._([e.j()],fe.prototype,"focusedChild",void 0),fe=e._([e.e("rte-toolbar")],fe);const{svg:ve}=e.a(),Ee=e.m(ve`<path d="M16.045 16.93a2.888 2.888 0 002.885-2.884v-2.091a2.888 2.888 0 00-2.885-2.884h-2.09c-.109 0-.213.019-.318.032a1.68 1.68 0 00-.81.376l-.076-.068.394-1.079c.722-2.288 2.69-3.354 2.792-3.407a.9.9 0 00-.82-1.602c-.165.084-4.044 2.114-4.044 6.731v3.993a2.888 2.888 0 002.884 2.884l2.088-.001zm-3.175-4.975c0-.598.486-1.084 1.084-1.084h2.09c.598 0 1.085.486 1.085 1.084v2.091c0 .598-.487 1.084-1.085 1.084h-2.09a1.085 1.085 0 01-1.084-1.084v-2.091zM6.045 16.93a2.888 2.888 0 002.885-2.884v-2.091a2.888 2.888 0 00-2.885-2.884h-2.09c-.109 0-.213.019-.318.032a1.68 1.68 0 00-.81.376l-.076-.068.394-1.079c.722-2.288 2.69-3.354 2.792-3.407a.9.9 0 00-.82-1.602c-.165.084-4.044 2.114-4.044 6.731v3.993a2.888 2.888 0 002.884 2.884l2.088-.001zM2.87 11.955c0-.598.486-1.084 1.084-1.084h2.09c.598 0 1.085.486 1.085 1.084v2.091c0 .598-.487 1.084-1.085 1.084h-2.09a1.085 1.085 0 01-1.084-1.084v-2.091z"></path>`,"0 0 20 20","quote-start"),Ce=Symbol("mixins/with-should-disable-block-node");function ye(e){if(Ce in e)return e;class t extends e{$shouldDisable(){const e=o.E();return!(!e||this.selected)&&!(o.u(e)&&!r.c(e,(e=>r.q(e,o.y))))}}return t[Ce]=!0,t}const Te=Symbol("mixins/with-should-disable-inline-formatting");function we(e){if(Te in e)return e;class t extends e{$shouldDisable(){const e=o.E();return!(!e||this.selected)&&!!(!o.u(e)&&!o._(e)||o.u(e)&&r.c(e,(e=>r.q(e,o.$,r.b,o.a0))))}}return t[Te]=!0,t}const Ie={},xe={};function _e(){const e=o.E();return!!o.u(e)&&(o.a5(e,o.a7),!0)}function Se(){const e=o.E();return!!o.u(e)&&(o.a5(e,o.I),!0)}let Re=class extends(ye(me)){constructor(){super(),this.isBlockQuote=!1,this.leadingIcon=Ee,this.text="Quote Block",this.name=ge.BlockQuote,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(this.isBlockQuote?xe:Ie,void 0)}beforeCreateEditor(e){e=super.beforeCreateEditor(e);const t=[o.j,o.a1,o.o,r.s,o.A,r.h,r.b,r.t,o.a2].map((e=>e.getType()));return O(e,o.a3,{validChildren:t})}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.a3]))throw new Error("RTEToolbarButtonBlockQuote: QuoteNode not registered on editor");o.t(t.registerCommand(Ie,_e,o.R),t.registerCommand(xe,Se,o.R),t.registerCommand(o.a4,r.u(e,o.a3,{shouldMergeSameNodeType:!0}),o.R),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isBlockQuote=o.u(e)&&r.c(e,o.a6),this.selected=this.isBlockQuote}))})))}};e._([e.j()],Re.prototype,"isBlockQuote",void 0),Re=e._([e.e("rte-toolbar-button-block-quote")],Re);const ke=/^\d+$/;const Ne=/\[['"]?([^'"\]]+)['"]?]/gm,Le=/^\./gm;function Me(e,t,i){const o=function(e){return"string"==typeof e&&(e=(e=(e=e.replace(Ne,".$1")).replace(Le,"")).split(".")),e.slice()}(t),r=o.slice(-1)[0],n=function(e,t){let i=e;for(let e=0;e<t.length-1;e++){const o=t[e];if(!(o in i)){const r=t[e+1];"number"==typeof r||ke.test(r)?i[o]=[]:i[o]={}}i=i[o]}return i}(e,o);return n[r]=i,e}const De=["bold","underline","strikethrough","italic","highlight","subscript","superscript","code"];function Pe(e,t){if(o.w(e))for(const i of t)e.hasFormat(i)&&e.toggleFormat(i)}const Oe=e=>Pe(e,De),Ae="code",Be=De.filter((e=>e!==Ae));function $e(e,t){const i=o.E();if(o.u(i))if(i.isCollapsed()){const e=new o.j("");if(i.insertNodes([e]),e.select(),t===Ae)for(const e of Be)i.hasFormat(e)&&i.toggleFormat(e);else i.hasFormat(Ae)&&i.toggleFormat(Ae)}else((e,t)=>{e.extract().forEach((e=>Pe(e,t)))})(i,t===Ae?Be:[Ae]);return!1}let Ue=class extends(we(me)){constructor(){super(),this.leadingIcon=c.c,this.text="Code",this.name=ge.CodeHighlight,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(o.i,Ae)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"theme.text.code","code"),O(e,o.a2,{validChildren:[o.j.getType()]})}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.a2]))throw new Error("CodePlugin: CodeHighlightNode not registered on editor");t.registerCommand(o.i,$e.bind(null,t),o.R),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.selected=o.u(e)&&e.hasFormat(Ae)}))})),r.v(t,(()=>!this.shouldDisable()),Ae)}};Ue=e._([e.e("rte-toolbar-button-code")],Ue);const Fe={},He={};function je(e,t){return t.update((()=>{let e=o.E();if(o.u(e)||o._(e)){let t;if(e.isCollapsed()){const[i]=e.getNodes();t=i.getParentOrThrow().getChildren(),o.a5(e,(()=>o.a8()))}else{const i=e.getTextContent(),r=o.a8();e.insertNodes([r]),e=o.E(),o.u(e)&&e.insertRawText(i),t=r.getChildren()}t.forEach(Oe)}})),!0}function Ve(e,t){return t.update((()=>{const e=o.E();o.u(e)&&o.a5(e,(()=>o.I()))})),!0}function ze(e){const t=o.E()?.getNodes()[0];return!(!o.r(t)&&!o.r(t?.getParent()))&&(e.preventDefault(),o.E()?.insertRawText("  "),!0)}let Ke=class extends(ye(me)){constructor(){super(),this.isCodeBlock=!1,this.leadingIcon=t.c,this.text="Code Block",this.name=ge.CodeBlock,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(this.isCodeBlock?He:Fe,void 0)}beforeCreateEditor(e){Me((e=super.beforeCreateEditor(e)).lexical,"theme.code","block p-xs mt-xs rounded-none");const t=[o.a1,o.j].map((e=>e.getType()));return O(e,o.$,{validChildren:t})}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.$]))throw new Error("CodeNodePlugin: CodeNode not registered on editor");o.t(t.registerCommand(Fe,je,o.R),t.registerCommand(He,Ve,o.R),t.registerCommand(o.D,ze,o.s),t.registerCommand(o.a4,r.u(e,o.$),o.R),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isCodeBlock=o.u(e)&&r.c(e,o.r),this.selected=this.isCodeBlock}))})),r.w(o.$,e))}};function qe(e,t){return Math.min(e,Math.max(t,20))}function Ge({mediaWidth:e,mediaHeight:t,maxDimension:i}){if(e<=0||t<=0)return{width:0,height:0};let o=e,r=t;if(e<t&&t>i){o=e*(i/t)}else if(e>t&&e>i){r=t*(i/e)}return{width:qe(i,o),height:qe(i,r)}}function Ye(e){e.stopPropagation()}function We(t,i){const o=e.d("faceplate-alert",{level:e.a0.error,cause:"uncategorized",message:i});t.getRootElement().dispatchEvent(o)}e._([e.j()],Ke.prototype,"isCodeBlock",void 0),Ke=e._([e.e("rte-toolbar-button-code-block")],Ke);class Je extends(ye(me)){constructor({leadingIcon:e,mediaType:t,nodeType:i,toolbarButtonName:o,tooltipText:r}){super(),this.isOverMediaLimit=!1,this.maxCurrentMediaTypeCount=Number.POSITIVE_INFINITY,this.currentMediaNodeCount=0,this.handleCustomConfigValidationResults=()=>{},this.leadingIcon=e,this.text=r,this._mediaType=t,this._nodeType=i,this.name=o}handleClick(){this.dispatchEvent(e.d(this.openTooltipEvent,void 0,!0)),this.fileInput?.click()}connectedCallback(){super.connectedCallback(),this.registerCommands()}disconnectedCallback(){this.unsubscribeFn?.(),super.disconnectedCallback()}willExceedMediaLimit(e){const t=Math.min(this.maxCurrentMediaTypeCount,this.pluginConfig.maxMediaCount);return this.currentMediaNodeCount+e>t}constructDragDropPasteCommands(e){if(!this.pluginConfig.allowMediaDragDrop&&!this.pluginConfig.allowMediaPaste)return[];const t=r.u(e,this._nodeType,{isValidPlacement:e=>this.willExceedMediaLimit(e.length)?(this.fireOverMediaLimitAlertEvent(),!1):!this.disabled||(this.fireInvalidPlacementAlertEvent(),!1),handleFiles:(t,i)=>{const r=i.filter((({type:e})=>e.includes(`${this._mediaType}/`)));if(r.length>0)if(this.pluginConfig.allowCreation){const e=t?.target instanceof Element?t.target.getAttribute("key"):null,i=e?this._editor?.getEditorState().read((()=>o.S(e))):null;this.startUpload(t instanceof DragEvent?"drag_and_drop":"clipboard",r,i??void 0)}else We(e.getEditor(),this.mediaNotAllowedErrorMessage)}});return[[o.z,this.pluginConfig.allowMediaDragDrop],[o.a4,this.pluginConfig.allowMediaPaste]].reduce(((e,[i,r])=>r?[...e,this._editor.registerCommand(i,t,o.R)]:e),[])}handleInputCancel(){this._isMediaPlaceholderInsertion=!1}insertMedia(e){const t=this.createMediaNode(e);r.x([t],this._rte)}async triggeNodesUpload(t){const i=t.map((e=>e.getKey()));if(t.length>0&&this._rte){const n=this._rte.getEditor();n.update((()=>{t.forEach((e=>{e.getWritable().uploadStatus="validating"}))}));const s=await Promise.allSettled(Array.from(t).filter((e=>!!e.blob)).map((async e=>this.parseAndValidateMediaFile(e.blob,this.pluginConfig))));for(let t=0;t<s.length;t++){const a=s[t],l=i[t];if("fulfilled"===a.status){const e=a.value;n.update((()=>{const t=o.S(l);if(t&&t instanceof this._nodeType){const i=t;this.updateNodeWithValidatedMetadata(i,e)}}),{tag:r.H})}else{const{message:t,reason:i}=a.reason,s=i||"ERROR";n.update((()=>{const e=o.S(l);e&&e.remove()}),{tag:r.H}),We(n,t);const d=this.errorEvent;n.getRootElement()?.dispatchEvent(e.d(d,{reason:s}))}}}}async triggerUpload(e,t,i){if(t?.length&&this._rte){const o=this._rte.getEditor(),n=i instanceof r.M?i.caption:void 0,s=[];o.update((()=>{i instanceof r.M&&i.remove(),Array.from(t).forEach((t=>{const i=this.createDefaultPayload(t,e,n),o=this.createMediaNode(i);r.x([o],this._rte),s.push(o)}))}),{onUpdate:()=>{this.triggeNodesUpload(s).then((()=>{this._isMediaPlaceholderInsertion=!1}))}})}}$shouldDisable(){return super.$shouldDisable()&&!this._isMediaPlaceholderInsertion||this.isOverMediaLimit}onSelect(e){const t=this._editor?.getEditorState().read((()=>o.E()?.getNodes()?.[0]));this.startUpload("fileselector",e.target?.files,t),this.fileInput&&(this.fileInput.value="")}fireOverMediaLimitAlertEvent(){if(this._editor){let e="";e=this.pluginConfig.maxMediaCount<=this.maxCurrentMediaTypeCount?r.y.overAttachmentLimitErrorMessage(this.pluginConfig.maxMediaCount):this.overMediaLimitErrorMessage(),We(this._editor,e)}}fireInvalidPlacementAlertEvent(){if(this._editor){const e=this._editor.getEditorState().read((()=>{const e=o.E();return o.u(e)&&r.c(e,o.a9)?this.invalidNodePlacementWithinTableErrorMessage:this.invalidNodePlacementGenericErrorMessage}));We(this._editor,e)}}startUpload(e,t,i){if(this._rte&&t&&t.length>0){if(this.willExceedMediaLimit(t.length))return void this.fireOverMediaLimitAlertEvent();this.disabled||(this.focusOnEditor(),this.triggerUpload(e,t,i))}}beforeCreateEditor(e){e=super.beforeCreateEditor(e);const t=this.validateConfig(e.plugins);return void 0!==t&&("EXCEEDED_MAX_MEDIA_COUNT"===t?window.Sentry?.captureMessage?.(`RTE Media Plugin: Max ${this._mediaType} count exceeds the configured maximum media count. Media count: ${e.plugins.media?.maxMediaCount} - Image Count: ${e.plugins.images?.maxImageCount} - Video Count: ${e.plugins.videos?.maxVideoCount}`):"MISSING_REQUIRED_CONFIG_VALUES"===t?window.Sentry?.captureMessage?.(`RTE Media Plugin: Missing required configuration values. Plugin Config: ${JSON.stringify(e.plugins)}`):this.handleCustomConfigValidationResults(t,e.plugins)),this.pluginConfig=this.parseConfig(e.plugins),this.maxCurrentMediaTypeCount=this.getMaxCurrentMediaTypeCount(this.pluginConfig),Me(e.lexical,`theme.${this._mediaType}`,"whitespace-normal"),Me(e.lexical,`theme.${r.M.getType()}`,"whitespace-normal"),O(e,this._nodeType,{validChildren:[]})}createEditor(e){super.createEditor(e);if(!this._editor.hasNodes([this._nodeType]))throw new Error(`MediaPlugin: Node with media type "${this._mediaType}" is not registered on editor`);this.registerCommands()}registerCommands(){const t=this._editor,i=this._rte;if(!t||!i)return;const n=this.constructDragDropPasteCommands(i);this.unsubscribeFn=o.t(...n,t.registerCommand(this.INSERT_MEDIA_COMMAND,(e=>(this.insertMedia(e),!1)),o.R),t.registerCommand(r.z,(e=>(e.type!==this._mediaType||this.isOverMediaLimit||(this._isMediaPlaceholderInsertion=!0,this.fileInput?.click()),!1)),o.R),t.registerCommand(a.N,(e=>{const{decoratorNodeRegistry:t}=e,i=t.countOf(this._mediaType),o=r.A.reduce(((e,i)=>i!==this._mediaType?e+t.countOf(i):e),0);return this.currentMediaNodeCount=i,this.isOverMediaLimit=i>=this.maxCurrentMediaTypeCount||i+o>=this.pluginConfig.maxMediaCount,!1}),o.R),t.registerNodeTransform(this._nodeType,(e=>{try{let n=e.getParent();n&&o.K(n)&&(n.replace(e),n=e.getParent()),n&&!r.i(i,n,e)&&(e.remove(),this.fireInvalidPlacementAlertEvent()),e&&r.C(e.src)&&!e.uploadStatus&&t.update((()=>{const t=r.D(e.src),i=e.getWritable();i.blob=t,i.mimetype=t.type}),{tag:r.H,onUpdate:()=>this.triggeNodesUpload([e])})}catch(e){window.Sentry?.captureMessage?.(`Error validating ${this._mediaType} node location at transform time: ${e?.message}`)}})),t.registerMutationListener(this._nodeType,(i=>{const r=t.getEditorState().read((()=>Array.from(i).reduce(((e,[t,i])=>{if("updated"===i){const i=o.S(t);i&&"validated"===i.uploadStatus&&e.push(i)}return e}),[])));r?.forEach((i=>{try{i.upload(t)}catch(i){We(t,this.uploadErrorMessage),t.getRootElement()?.dispatchEvent(e.d(this.errorEvent,{reason:"ERROR"}))}}))})))}render(){return this.pluginConfig.allowCreation?e.x`<input type="file" accept="${this.allowedMimetypes(this.pluginConfig).join(", ")}" class="hidden" @cancel="${this.handleInputCancel}" @click="${Ye}" @change="${this.onSelect}" data-media-type="${this._mediaType}" ?multiple="${Math.min(this.maxCurrentMediaTypeCount,this.pluginConfig.maxMediaCount)>1}"> ${super.render()} `:e.x``}}function Xe(e){const{media:t}=e;return {...(t?.bearerToken ? {bearerToken:t.bearerToken} : {}),allowCaptions:"true"===t?.allowCaptions,allowMediaDragDrop:"false"!==t?.allowMediaDragDrop,allowMediaPaste:"false"!==t?.allowMediaPaste,maxMediaCount:G(t?.maxMediaCount,Number.POSITIVE_INFINITY)};}function Qe(e){if(!(e.images&&e.images.allowStaticImages&&e.images.allowAnimatedImages))return"MISSING_REQUIRED_CONFIG_VALUES";const t=G(e.media?.maxMediaCount,Number.POSITIVE_INFINITY),i=G(e.images?.maxImageCount,Number.POSITIVE_INFINITY);return void 0!==e.images?.maxImageCount&&i>t?"EXCEEDED_MAX_MEDIA_COUNT":void 0}function Ze(e){const{images:t}=e;return{...Xe(e),allowCreation:"true"===t?.allowCreation,minImageDimension:G(t?.minImageDimension,0),allowStaticImages:"true"===t?.allowStaticImages,allowAnimatedImages:"true"===t?.allowAnimatedImages,maxImageCount:G(t?.maxImageCount,Number.POSITIVE_INFINITY),maxImageDisplayDimension:G(t?.maxImageDisplayDimension,Number.POSITIVE_INFINITY)}}e._([e.j()],Je.prototype,"isOverMediaLimit",void 0),e._([e.Y("input[type=file]")],Je.prototype,"fileInput",void 0);const et={};SML.di("./Cszz6xIhIJ.js",import.meta.url,"Cszz6xIhIJ").then((function(e){return e.f}));let tt=class extends Je{constructor(){super({leadingIcon:u.i,mediaType:r.I.getType(),nodeType:r.I,toolbarButtonName:ge.Image,tooltipText:r.y.addImageButton()}),this.pluginConfig={allowAnimatedImages:!1,allowCreation:!1,allowMediaDragDrop:!0,allowMediaPaste:!0,allowStaticImages:!1,allowCaptions:!1,maxImageDisplayDimension:Number.POSITIVE_INFINITY,minImageDimension:0,maxImageCount:Number.POSITIVE_INFINITY,maxMediaCount:Number.POSITIVE_INFINITY},this.allowedMimetypes=e=>h.a(e),this.createMediaNode=r.F,this.errorEvent=r.G,this.INSERT_MEDIA_COMMAND=et,this.getMaxCurrentMediaTypeCount=e=>e.maxImageCount,this.openTooltipEvent=r.O,this.parseConfig=Ze,this.validateConfig=Qe,this.invalidNodePlacementWithinTableErrorMessage=r.y.invalidNodePlacementWithinTableErrorMessage(),this.invalidNodePlacementGenericErrorMessage=r.y.invalidNodePlacementGenericErrorMessage(),this.uploadErrorMessage=r.y.uploadErrorMessage(),this.mediaNotAllowedErrorMessage=r.y.mediaNotAllowedErrorMessage(),this.overMediaLimitErrorMessage=()=>r.y.overMediaLimitErrorMessageImage(this.maxCurrentMediaTypeCount),this.text=r.y.addImageButton()}constructPayload({bearerToken:e,src:t,width:i,height:o,caption:r},n,s){return{src:t,width:i,height:o,blob:n,mediaId:"",mimetype:n.type,uploadMethod:s,bearerToken:e,caption:r}}createDefaultPayload(e,t,i){return this.constructPayload({src:URL.createObjectURL(e),width:640,height:480,bearerToken:this.pluginConfig.bearerToken,caption:i},e,t)}async parseAndValidateMediaFile(e,t){let i=null;try{i=await h.g(e)}catch(e){throw new Error(r.y.unableToReadImageError())}const o=h.v(i,t);if(!o.valid&&o.error)throw new r.V(o.error,o.reason);const n=Ge({mediaWidth:i.width||0,mediaHeight:i.height||0,maxDimension:t.maxImageDisplayDimension});return{src:i.src,...n}}updateNodeWithValidatedMetadata(e,t){const i=e.getWritable();i.src=t.src,i.width=t.width,i.height=t.height,i.uploadStatus="validated"}};tt=e._([e.e("rte-toolbar-button-image")],tt);function it(t){const i=document.createElement("video"),o=function(){const t=window.navigator?.userAgent.toLowerCase()||"";return e.jc(t)}();return new Promise(((e,r)=>{const n=()=>{r(new Error(`Error creating video with src ${t}`))};i.addEventListener("error",n);const s=o?["progress"]:["loadedmetadata","loadeddata","suspend"],a=()=>{(function({video:e,isIos:t}){if(t&&1===e.readyState)e.load();else if(e.readyState>=2)return!0;return!1})({video:i,isIos:o})&&(s.forEach((e=>i.removeEventListener(e,a))),i.removeEventListener("error",n),e(i))};s.forEach((e=>i.addEventListener(e,a))),i.src=t,a()}))}async function ot(t,{count:i}){if(i<1)throw new Error("Number of thumbnails must be at least 1.");const o=[];if(function(){const t=window.navigator?.userAgent.toLowerCase()||"";return e.jb(t)}()&&1===i){const e=await rt(t);return e&&o.push(e),o}const r=t.duration,n=r/i;for(let e=0;e<i;e++){const i=n*e;if(i>=r)break;const s=await nt(t,i);s&&o.push(s)}return o}async function rt(e){return new Promise((t=>{const i=document.createElement("canvas");i.width=e.videoWidth,i.height=e.videoHeight;const o=i.getContext("2d");o?.drawImage(e,0,0),i.toBlob((e=>{t(e)}))}))}function nt(e,t){return new Promise((i=>{const o=()=>{rt(e).then((t=>{e.removeEventListener("seeked",o),i(t)}))};e.addEventListener("seeked",o),e.currentTime=t}))}async function st(e){const t=URL.createObjectURL(e),i=await it(t);return{src:t,duration:i.duration,getPosterBlob:async function(){return(await ot(i,{count:1}))[0]??null},width:i.videoWidth,height:i.videoHeight,type:e.type,size:e.size}}const at=1073741824,lt=["video/mp4","video/quicktime"];function dt(e,t){const{type:i,size:o,duration:r,width:n,height:s}=e,{minVideoDimension:a,skipVideoSizeAndDimensionValidation:l,allowExtendedVideoDuration:d,composerContext:c}=t;if(!lt.includes(i))return{valid:!1,error:h.u.videoMimetypeError(),reason:"INVALID_VIDEO_TYPE_ERROR"};if(!l&&o>at)return{valid:!1,error:h.u.videoMaxSizeError(Math.floor(1)),reason:"VIDEO_SIZE_LIMIT_EXCEEDED_ERROR"};if(!l){let e=900;if(d&&(e=1800),"comment"===c&&(e=180),r>e)return{valid:!1,error:h.u.videoIsTooLongError(Math.floor(e/60)),reason:"VIDEO_MAX_DURATION_ERROR"}}if(r<2)return{valid:!1,error:h.u.videoIsTooShortError(2),reason:"VIDEO_MIN_DURATION_ERROR"};if(0===n||0===s)return{valid:!1,error:h.u.videoCodecError(),reason:"VIDEO_CODEC_ERROR"};const u=a??50,p=a??50;return n<u||s<p?{valid:!1,error:h.u.videoMinDimensionError(u,p),reason:"VIDEO_MIN_DIMENSION_ERROR"}:o/r<1024?{valid:!1,error:h.u.videoMinRateError(Math.floor(1)),reason:"VIDEO_MIN_BITRATE_ERROR"}:{valid:!0,error:null}}function ct(e){const{maxMediaCount:t,maxVideoCount:i,playerUi:o}=ut(e);return void 0!==e.videos?.maxVideoCount&&i>t?"EXCEEDED_MAX_MEDIA_COUNT":["mobile","desktop"].includes(o)?void 0:"INVALID_PLAYER_UI_TYPE"}function ut(e){const{videos:t}=e;return{...Xe(e),allowCreation:"true"===t?.allowCreation,minVideoDimension:G(t?.minVideoDimension,0),maxVideoDisplayDimension:G(t?.maxVideoDisplayDimension,Number.POSITIVE_INFINITY),maxVideoCount:G(t?.maxVideoCount,Number.POSITIVE_INFINITY),playerUi:t?.playerUi??"desktop",skipVideoSizeAndDimensionValidation:"true"===t?.skipVideoSizeAndDimensionValidation,allowExtendedVideoDuration:"true"===t?.allowExtendedVideoDuration,composerContext:t?.composerContext}}const ht={};SML.di("./Cszz6xIhIJ.js",import.meta.url,"Cszz6xIhIJ").then((function(e){return e.f}));class pt extends r.V{}let gt=class extends Je{constructor(){super({leadingIcon:p.v,mediaType:r.J.getType(),nodeType:r.J,toolbarButtonName:ge.Video,tooltipText:r.y.video()}),this.pluginConfig={allowCreation:!1,allowCaptions:!1,allowMediaDragDrop:!0,allowMediaPaste:!0,maxVideoDisplayDimension:Number.POSITIVE_INFINITY,minVideoDimension:0,maxMediaCount:Number.POSITIVE_INFINITY,maxVideoCount:Number.POSITIVE_INFINITY,playerUi:"desktop"},this.allowedMimetypes=()=>lt,this.createMediaNode=r.K,this.errorEvent=r.L,this.handleCustomConfigValidationResults=(e,t)=>{"INVALID_PLAYER_UI_TYPE"===e&&window.Sentry?.captureMessage?.(`RTE Video Plugin: Invalid video player UI type specified. Plugin Config: ${JSON.stringify(t)}`)},this.INSERT_MEDIA_COMMAND=ht,this.getMaxCurrentMediaTypeCount=e=>e.maxVideoCount,this.openTooltipEvent=r.N,this.parseConfig=ut,this.validateConfig=ct,this.invalidNodePlacementWithinTableErrorMessage=r.y.invalidNodePlacementWithinTableErrorMessageVideo(),this.invalidNodePlacementGenericErrorMessage=r.y.invalidNodePlacementGenericErrorMessageVideo(),this.uploadErrorMessage=r.y.uploadErrorMessageVideo(),this.mediaNotAllowedErrorMessage=r.y.mediaNotAllowedErrorMessageVideo(),this.overMediaLimitErrorMessage=()=>r.y.overMediaLimitErrorMessageVideo(this.maxCurrentMediaTypeCount)}constructPayload({bearerToken:e,caption:t,src:i,width:o,height:r,getPosterBlob:n},s,a){return{src:i,width:o,height:r,blob:s,mediaId:"",mimetype:s.type,playerUi:this.pluginConfig.playerUi,uploadMethod:a,bearerToken:e,caption:t,getPosterBlob:n}}createDefaultPayload(e,t,i){return this.constructPayload({src:URL.createObjectURL(e),width:640,height:480,playerUi:this.pluginConfig.playerUi,bearerToken:this.pluginConfig.bearerToken,caption:i},e,t)}async parseAndValidateMediaFile(e,t){let i=null;try{i=await st(e)}catch(e){throw new Error(r.y.unableToReadVideoError())}const o=dt(i,t);if(!o.valid&&o.error)throw new pt(o.error,o.reason);const n=Ge({mediaWidth:i.width,mediaHeight:i.height,maxDimension:t.maxVideoDisplayDimension});return{src:i.src,getPosterBlob:i.getPosterBlob,...n}}updateNodeWithValidatedMetadata(e,t){const i=e.getWritable();i.src=t.src,i.width=t.width,i.height=t.height,i.uploadStatus="validated",t.getPosterBlob&&(i.getPosterBlob=t.getPosterBlob)}};gt=e._([e.e("rte-toolbar-button-video")],gt);const mt="k2kwyMA6VeyHM6ZRT96OXDGaersnx73Z";async function bt(e,t){const i=await fetch(e,t),o=await i.json();if(200!==o.meta.status)throw new Error(`${o.meta.status} ${o.meta.msg}`);return o}const ft={};let vt=class extends(ye(me)){static get styles(){return[...me.styles,e.i`@media (prefers-color-scheme:dark){#powered-by-giphy{filter:invert(1)}}`]}constructor(){super(),this.pluginConfig={allowCreation:!1,maxMediaCount:Number.POSITIVE_INFINITY},this.shouldShowGiphyBanner=!0,this.isOverMediaLimit=!1,this.hasVideos=!1,this.failedToFetchTheResults=!1,this.search=async e=>{this.failedToFetchTheResults=!1,this.searchOperationAbortController?.abort(),this.searchOperationAbortController=new AbortController;try{const t=""!==e?await async function({query:e,offset:t,rating:i,limit:o},r){const n=new URL("https://api.giphy.com/v1/gifs/search");return n.searchParams.set("api_key",mt),n.searchParams.set("q",e),n.searchParams.set("offset",(t||0).toString()),n.searchParams.set("limit",(o||25).toString()),n.searchParams.set("rating",(i||"pg").toString()),bt(n,r)}({query:e},this.searchOperationAbortController):await async function({offset:e,rating:t,limit:i},o){const r=new URL("https://api.giphy.com/v1/gifs/trending");return r.searchParams.set("api_key",mt),r.searchParams.set("offset",(e||0).toString()),r.searchParams.set("limit",(i||25).toString()),r.searchParams.set("rating",(t||"pg").toString()),bt(r,o)}({},this.searchOperationAbortController);this.searchOperationAbortController=void 0,this.searchResults=t.data.map((e=>{const t=e.images.fixed_width,i=e.images.downsized.url?e.images.downsized:t;return{mediaId:`giphy|${e.id}`,title:e.title,media:{preview:{width:Number.parseInt(i.width),height:Number.parseInt(i.height),src:i.url},original:{width:Number.parseInt(t.width),height:Number.parseInt(t.height),src:t.url}}}}))}catch(e){"AbortError"!==e.name&&(this.searchResults=void 0,this.failedToFetchTheResults=!0)}},this.debouncedSearch=e.ae(this.search,500),this.handleSearchInput=()=>{const e=this.searchInput?.value||"";this.shouldShowGiphyBanner=0===e.length,this.debouncedSearch(e)},this.handleMenuClose=()=>{this.searchInput&&(this.searchInput.value=""),this.searchOperationAbortController?.abort(),this.searchOperationAbortController=void 0,this.searchResults=[],this._editor?.focus()},this.handleSearchInputClear=()=>{this.searchInput&&(this.searchInput.value=""),this.search("")},this.handleImageClick=e=>{this.dropdownMenu?.close();const t=e.currentTarget,i=t.dataset.mediaId,o=t.dataset.src,r=Number.parseInt(t.dataset.width),n=Number.parseInt(t.dataset.height);this.focusOnEditor(),this._editor?.dispatchCommand(ft,{mediaId:i,src:o,width:r,height:n}),this.dispatchEvent(new CustomEvent("select-giphy-image",{bubbles:!0,composed:!0}))},this.handleReloadButtonClick=()=>{const e=this.searchInput?.value||"";this.search(e)},this.stopPropagation=e=>{e.stopPropagation()},this.searchInputCopy=r.y.searchGiphy(),this.leadingIcon=m.g,this.text=r.y.gif(),this.name=ge.Gif}$shouldDisable(){return super.$shouldDisable()||this.isOverMediaLimit||this.hasVideos}disconnectedCallback(){this.searchOperationAbortController?.abort()}beforeCreateEditor(e){return e=super.beforeCreateEditor(e),this.pluginConfig=function(e){return{allowCreation:"true"===e.plugins.giphy?.allowCreation,maxMediaCount:G(e.plugins.media?.maxMediaCount,Number.POSITIVE_INFINITY)}}(e),O(e,r.I,{validChildren:[]})}createEditor(e){super.createEditor(e);const t=this._editor;o.t(t.registerCommand(ft,(e=>{const i={...e,mimetype:"image/gif",uploadMethod:"giphy"};return t.dispatchCommand(et,i),!0}),o.R),t.registerCommand(a.N,(e=>{const{decoratorNodeRegistry:t}=e,i=t.countOf(r.J.getType());if(this.hasVideos=i>0,void 0!==this.pluginConfig.maxMediaCount){const e=t.countOf(r.I.getType());this.isOverMediaLimit=e>=this.pluginConfig.maxMediaCount}return!1}),o.R))}updated(e){super.updated(e),e.has("searchResults")&&this.dropdownMenuContainer&&(this.dropdownMenuContainer.scrollTop=0)}handleClick(){this.search(""),setTimeout((()=>this.searchInput?.focus()),100),this.dispatchEvent(new CustomEvent("open-giphy-tooltip",{bubbles:!0,composed:!0}))}renderReloadButton(){return this.failedToFetchTheResults?e.x`${r.p({appearance:"plain",leadingIcon:b.r({size:e.I.Small}),children:r.y.reload(),attributes:{className:"mx-auto mt-4xl",onclick:this.handleReloadButtonClick,"data-testid":"btn-reload"}})}`:e.x``}renderGiphyImage(t){const i=`${t.media.preview.width}/${t.media.preview.height};`;return e.x` <button @click="${this.handleImageClick}" class="block bg-transparent border-0 m-0 p-0 cursor-pointer rounded-4 overflow-hidden" data-media-id="${t.mediaId}" data-src="${t.media.original.src}" data-width="${t.media.original.width}" data-height="${t.media.original.height}"> <img src="${t.media.preview.src}" alt="${t.title}" class="block w-full" style="aspect-ratio:${i}" loading="lazy"> </button> `}renderGiphyResults(){if(!this.searchResults)return e.x``;if(0===this.searchResults.length)return e.x` <p class="mt-4xl text-center text-neutral-content-weak">${r.y.noResults()}</p> `;const[t,i]=function(e){const t={height:0,images:[]},i={height:0,images:[]};for(const o of e){const e=t.height<=i.height?t:i;e.images.push(o);const r=o.media.preview.height/o.media.preview.width;e.height+=r}return[t.images,i.images]}(this.searchResults);return e.x` <div class="flex flex-row gap-xs" data-testid="giphy-images"> <div class="flex flex-col gap-xs flex-1 shrink-0 p-0 m-0" data-testid="first-column"> ${e.bO(t,(e=>e.mediaId),(e=>this.renderGiphyImage(e)))} </div> <div class="flex flex-col gap-xs flex-1 shrink-0 p-0 m-0" data-testid="second-column"> ${e.bO(i,(e=>e.mediaId),(e=>this.renderGiphyImage(e)))} </div> </div> `}renderGiphyForm(){return e.x` <div id="dropdown-menu-container" class="w-[375px] h-[300px] overflow-auto bg-ui-modalbackground py-xs px-md" slot="menu" @click="${this.stopPropagation}" @keyup="${this.stopPropagation}"> <div class="w-full sticky top-0"> <faceplate-search-input appearance="${h.T.SECONDARY}" @input="${this.handleSearchInput}" placeholder="${this.searchInputCopy}" ariaControls="${this.searchInputCopy}" class="w-full m-0 mb-xs"> ${f.s({attributes:{slot:"leadingIcon"},size:e.I.Medium})} ${r.p({size:e.v.Small,appearance:"plain",attributes:{slot:"clearIcon",onclick:this.handleSearchInputClear,"data-testid":"btn-clear"},leadingIcon:g.c({size:e.I.Small}),screenReaderContent:r.y.clearInput()})} </faceplate-search-input> ${i.n(this.shouldShowGiphyBanner,(()=>e.x` <img src="${window?.CLIENT_CONFIG?.STATIC_BASE_URL?`${window.CLIENT_CONFIG.STATIC_BASE_URL}assets/powered-by-giphy.png`:"/components/giphy/powered-by-giphy.png"}" alt="${r.y.poweredByGiphy()}" id="powered-by-giphy" class="absolute end-sm top-md"> `))} </div> ${this.renderGiphyResults()} ${this.renderReloadButton()} </div> `}render(){return this.pluginConfig.allowCreation?e.x` <faceplate-dropdown-menu position="bottom-start" .onclose="${this.handleMenuClose}" ?disabled="${this.disabled}"> ${super.render()} ${this.renderGiphyForm()} </faceplate-dropdown-menu> `:e.x``}};e._([e.j()],vt.prototype,"shouldShowGiphyBanner",void 0),e._([e.j()],vt.prototype,"isOverMediaLimit",void 0),e._([e.j()],vt.prototype,"hasVideos",void 0),e._([e.Y("faceplate-search-input",!0)],vt.prototype,"searchInput",void 0),e._([e.Y("#dropdown-menu-container",!0)],vt.prototype,"dropdownMenuContainer",void 0),e._([e.Y("faceplate-dropdown-menu",!0)],vt.prototype,"dropdownMenu",void 0),e._([e.j()],vt.prototype,"searchResults",void 0),e._([e.j()],vt.prototype,"failedToFetchTheResults",void 0),vt=e._([e.e("rte-toolbar-button-giphy")],vt);const Et={},Ct={};function yt(e){const t=o.E();if(!o.u(t))return!1;const i=t.getNodes();return[...i[0].getPreviousSiblings(),...i,...i[i.length-1].getNextSiblings()].forEach(Oe),o.a5(t,(()=>o.aa(e))),!0}function Tt(){const e=o.E();return!!o.u(e)&&(o.a5(e,o.I),!0)}function wt(){return{h1:r.y.headingLevel(1),h2:r.y.headingLevel(2),h3:r.y.headingLevel(3),h4:r.y.headingLevel(4),h5:r.y.headingLevel(5),h6:r.y.headingLevel(6)}}let It=class extends(ye(me)){constructor(){super(),this.isHeading=!1,this.selectedHeadingTagType=null,this.allowHeadingLevelSelection=!1,this.toggleHeadingLevel=()=>{this.isHeading?this._editor?.dispatchCommand(Ct,void 0):this._editor?.dispatchCommand(Et,"h1")},this.handleNormalTextSelection=()=>{this.focusOnEditor(),this._editor?.dispatchCommand(Ct,void 0)},this.handleHeadingLevelSelection=e=>{this.focusOnEditor(),this._editor?.dispatchCommand(Et,e)},this.leadingIcon=t.t,this.text="Heading",this.name=ge.Heading}connectedCallback(){super.connectedCallback(),this.isToggle=!this.allowHeadingLevelSelection}handleClick(){this.allowHeadingLevelSelection||this.toggleHeadingLevel()}beforeCreateEditor(e){e=super.beforeCreateEditor(e);for(const[t,i]of Object.entries({h1:"text-24 leading-7",h2:"text-20 leading-6",h3:"text-16 leading-5",h4:"text-14 leading-4",h5:"text-12 leading-3",h6:"text-10 leading-2"}))Me(e.lexical,`theme.heading.${t}`,`${i} mt-large mb-x6`);const t=[o.j,o.o,r.s,o.A,r.h,r.b].map((e=>e.getType()));return O(e,o.a0,{validChildren:t})}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.a0]))throw new Error("RTEToolbarButtonHeading: HeadingNode not registered on editor");this.allowHeadingLevelSelection="true"===r.o(t,"plugins.headings.allowHeadingLevelSelection"),o.t(t.registerCommand(Et,yt,o.R),t.registerCommand(Ct,Tt,o.R),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E(),t=o.u(e);this.isHeading=t&&r.c(e,o.ab),this.selected=this.isHeading,this.selectedHeadingTagType=this.allowHeadingLevelSelection&&t?function(e){for(const t in wt()){function i(e){return o.ab(e)&&e.getTag()===t}if(e.getNodes().every((e=>i(e)||e.getParents().some(i))))return t}return null}(e):null}))})),r.w(o.a0,e,{nodeHandlers:{[o.a1.getType()]:({parent:e})=>{r.P(e,(()=>o.aa(e.getTag())))}}}),...(this.allowHeadingLevelSelection ? [] : [t.registerMutationListener(o.a0,(e=>{t.update((()=>{for(const[t,i]of e)if("created"===i){const e=o.S(t);e&&"h1"!==e.getTag()&&e.replace(o.aa("h1"),!0)}}))}),{skipInitialization:!1})]))}renderHeadingLevelDropdown(){return e.x` <rpl-menu slot="content"> <rpl-menu-item ?selected="${!this.selectedHeadingTagType}" type="button" data-heading-style="normal-text" @click="${this.handleNormalTextSelection}" @keydown="${e=>{s.aE(e.code)&&this.handleNormalTextSelection()}}"> <span class="text-14"> ${r.y.headingLevelNormalText()} </span> </rpl-menu-item> ${Object.entries(wt()).map((([t,i])=>{const o=t;return e.x` <rpl-menu-item ?selected="${this.selectedHeadingTagType===o}" type="button" data-heading-style="${o}" @click="${()=>this.handleHeadingLevelSelection(o)}" @keydown="${e=>{s.aE(e.code)&&this.handleHeadingLevelSelection(o)}}"> <span class="${{h1:"text-24 leading-7",h2:"text-20 leading-6",h3:"text-16 leading-5",h4:"text-14 leading-4",h5:"text-12 leading-3",h6:"text-10 leading-2"}[o]}"> ${i} </span> </rpl-menu-item> `}))} </rpl-menu> `}render(){return this.allowHeadingLevelSelection?e.x` <rpl-dropdown placement="bottom-start" ?disabled="${this.disabled}"> ${super.render()} ${this.renderHeadingLevelDropdown()} </rpl-dropdown> `:super.render()}};e._([e.j()],It.prototype,"isHeading",void 0),e._([e.j()],It.prototype,"selectedHeadingTagType",void 0),e._([e.j()],It.prototype,"allowHeadingLevelSelection",void 0),It=e._([e.e("rte-toolbar-button-heading")],It);const xt={},_t={};function St(e){const t=e.getChildren();for(let i=0;i<t.length;i++)e.insertBefore(t[i]);e.remove()}function Rt(e,t,i){const o=Array.isArray(e)?e:[e],r=o[0].getParent(),n=o[0].getIndexWithinParent();return t.append(...o),i?i.insertAfter(t):r&&r?.splice(n,0,[t]),t}function kt(){const e=o.E();if(!o.u(e))return!1;const t=e.getNodes().filter((e=>r.a(e)));if(t.length>0)return t.forEach((e=>{St(e)})),!0;const i=e.focus.getNode(),n=o.af(i,r.t);if(n){const t=n.getTextContent();if(n.getTextContent()===r.B||""===t.trim())n.remove();else if(e.isCollapsed()&&o.ag(e.focus)){const e=o.Z(r.B);n.insertAfter(e),e.select(1,1)}else St(n);return!0}return!1}function Nt(){const e=o.E();if(!o.u(e))return!1;const t=e.getNodes(),i=e.focus.getNode();if(t.length>1)return function(e){const t=e.extract().filter(o.w).reduce(((e,t)=>{const i=e[e.length-1],n=function(e){const t=e.getParents();return t.find((e=>o.ah(e)||r.d(e)))??e}(t);return 0===i.length||i[i.length-1].is(n.getPreviousSibling())?i.push(n):e.push([n]),e}),[[]]),i=t.map((e=>Rt(e,r.Q(),e[0].getPreviousSibling())));i[i.length-1]?.select()}(e),!0;if(function(e){if(o.K(e)){const t=r.Q();return e.append(t),t.selectEnd(),!0}return!1}(i))return!0;if(o.w(i)){const t=r.Q(),o=i.getParent();if(o?.isInline())Rt(o,t);else if(r.d(i))Rt(i,t);else if(0===e.getTextContent().length)r.T(e,i,t),t.selectEnd();else{const o=e.extract();o.length>0&&(o[0].is(i)?Rt(i,t):(t.append(o[0]),i.insertAfter(t)))}return!0}return!1}function Lt(e,{isBackwards:t}){const{shouldMoveSelectionToSibling:i,sibling:n,focusSpoilerNode:s}=e.getEditorState().read((()=>{let e=!1,i=null,n=null,s=null;const a=o.E();if(o.u(a)&&(n=a.focus.getNode(),i=o.w(n)?o.af(n,r.t):n,o.w(n))){const o=n.getTextContent(),l=t?o.charAt(a.focus.offset-1):o.charAt(a.focus.offset);s=t?i?.getPreviousSibling():i?.getNextSibling();const d=function(e,t){if(!e)return t.offset;let i=0,o=t.getNode();for(;o&&!o.is(e);)i+=o.is(t.getNode())?t.offset:o.getTextContentSize(),o=o.getPreviousSibling()||(o.getParent()?.is(e)?null:o.getParent()?.getPreviousSibling());return i}(i,a.focus);e=!!i&&(l===r.B||t&&0===d||!t&&d===i.getTextContentSize())}return{shouldMoveSelectionToSibling:e,focusNode:n,focusSpoilerNode:i,sibling:s}}));return!(!i||n)&&(e.update((()=>{if(s){const e=o.Z(r.B);t?s.insertBefore(e):s.insertAfter(e),e.select(1,1)}})),!0)}let Mt=class extends me{constructor(){super(),this.isSpoiler=!1,this.leadingIcon=v.c,this.text="Spoiler",this.name=ge.Spoiler,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(this.isSpoiler?_t:xt,void 0)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"theme.spoiler","bg-tone-4 rounded-1 py-2xs px-2xs empty:pr-0 mx-2xs first:ml-0"),O(e,r.t,{validChildren:[o.j.getType(),o.o.getType(),r.s.getType()]})}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([r.t]))throw new Error("SpoilerPlugin: SpoilerNode not registered on editor");o.t(t.registerCommand(xt,Nt,o.R),t.registerCommand(_t,kt,o.R),t.registerCommand(o.ae,(()=>{const e=o.E();if(o.u(e)){let i=e.focus.getNode();if(o.w(i)&&(i=i.getParent()),i&&r.a(i)&&(""===i.getTextContent().trim()||i.getTextContent()===r.B))return t.update((()=>{i.remove()}),{skipTransforms:!0}),!0}return!1}),o.R),t.registerCommand(o.ad,(e=>!e.shiftKey&&Lt(t,{isBackwards:!1})),o.O),t.registerCommand(o.ac,(e=>!e.shiftKey&&Lt(t,{isBackwards:!0})),o.O),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isSpoiler=o.u(e)&&r.c(e,r.a),this.selected=this.isSpoiler}))})),t.registerNodeTransform(o.j,(e=>{const t=o.E();e.getTextContent()!==r.B&&(e.getTextContent().startsWith(r.B)&&(e.setTextContent(e.getTextContent().replace(new RegExp(`^${r.B}`),"")),o.u(t)&&t.isCollapsed()&&t.focus.getNode().is(e)&&e.select(t?.anchor.offset-1,t.focus.offset-1)),e.getTextContent().endsWith(r.B)&&e.setTextContent(e.getTextContent().replace(new RegExp(`${r.B}$`),"")))})),t.registerNodeTransform(r.t,(e=>{const t=e.getFirstChild(),i=o.E();if(!t||!o.w(t)){const i=o.Z(r.B);t?.insertBefore(i)||e.append(i)}if(o.u(i)&&i.isCollapsed()){const t=i.focus.getNode();(t.is(e)||o.w(t)&&t.getParent()?.is(e))&&0===i.focus.offset&&e.getFirstChild()?.select(1,1)}})))}$shouldDisable(){const e=o.E();return!(!e||this.selected)&&(!o.u(e)||r.c(e,(e=>r.q(e,o.$,o.a0))))}};e._([e.j()],Mt.prototype,"isSpoiler",void 0),Mt=e._([e.e("rte-toolbar-button-spoiler")],Mt);let Dt=class extends me{constructor(){super(),this.isTable=!1,this.leadingIcon=t.a,this.text=r.y.table(),this.name=ge.Table}handleClick(){this._editor?.dispatchCommand(o.ai,{columns:"3",rows:"3",includeHeaders:{columns:!1,rows:!0}})}beforeCreateEditor(e){Me((e=super.beforeCreateEditor(e)).lexical,"theme.tableCell","px-sm py-xs leading-5 border border-solid border-neutral-border relative"),Me(e.lexical,"theme.table","relative table-fixed");const t=[o.F,o.j,o.a2,r.t,o.o,r.s,o.A,r.h,r.b].map((e=>e.getType()));return P(e,[{nodeType:o.y,nodeTypeConfig:{validChildren:[o.aj.getType()]}},{nodeType:o.aj,nodeTypeConfig:{validChildren:[o.ak.getType()]}},{nodeType:o.ak,nodeTypeConfig:{validChildren:t}}])}createEditor(t){super.createEditor(t);const i=this._editor;if(!i.hasNodes([o.y,o.ak,o.aj]))throw new Error("TablePlugin: TableNode, TableRowNode, and TableCellNode are not registered.");const n=new Map;o.t(i.registerMutationListener(o.y,function(e,t){return i=>{for(const[r,n]of i)if("created"===n)e.getEditorState().read((()=>{const i=o.S(r);o.a9(i)&&Pt(e,t,i)}));else if("destroyed"===n){const e=t.get(r);void 0!==e&&(e.removeListeners(),t.delete(r))}}}(i,n)),i.registerCommand(o.ai,(({columns:e,rows:t,includeHeaders:i})=>(function(e,t,i){const r=o.as(e,t,i);o.at(r);const n=r.getFirstDescendant();o.w(n)&&n.select()}(Number.parseInt(t),Number.parseInt(e),i),!0)),o.s),i.registerCommand(o.M,(e=>{const t=o.E();if(!o.u(t))return!1;e.preventDefault();const i=t.getNodes(),r=i[i.length-1],n=o.am(r);if(n){const t=o.an(n),i=o.ao(n),r=o.ap(n),s=e?.shiftKey?r.getPreviousSibling():r.getNextSibling();if(s){const e=s.getChildren()[i];o.aq(e)&&e.select()}else e?.shiftKey?t.selectPrevious():t.selectNext();return!0}return!1}),o.ar),i.registerUpdateListener(function(t){let i=!1;return()=>{t.getEditorState().read((()=>{n(t)}))};function r(t,o){(o.show||i)&&(t.getRootElement()?.dispatchEvent(e.d(K,o)),i=o.show)}function n(e){const t=o.E(),i=window.getSelection(),n=document.activeElement,s=e.getRootElement();if(o.u(t)&&null!=s&&null!=i&&s.contains(i.anchorNode)){const i=o.am(t.anchor.getNode());if(null==i)return void r(e,{show:!1});const n=e.getElementByKey(i.getKey());if(null==n)return void r(e,{show:!1});r(e,{cell:n,show:!0,editor:e})}else n||r(e,{show:!1})}}(i)),i.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.selected=o.u(e)&&r.c(e,o.a9)||o._(e),this.isTable=this.selected}))})),i.registerCommand(o.a4,r.u(t,o.y),o.R),r.w(o.ak,t,{collapseBlock:!0,fixUpNode:e=>{if(!o.K(e.getFirstChild())){const t=o.I();t.append(...e.getChildren()),e.append(t)}}}),i.registerNodeTransform(o.y,(e=>{if(e.getChildrenSize()>0){const t=e.getChildAtIndex(0);if(t&&t.getChildrenSize()>0){const e=t.getFirstChild();e&&!e.hasHeader()&&e.setHeaderStyles(o.al.ROW)}}})))}$shouldDisable(){const e=o.E();return this.selected||null!=e&&!o.u(e)}};function Pt(e,t,i){const r=i.getKey(),n=e.getElementByKey(r);if(n&&!t.has(r)){const s=o.au(i,n,e);t.set(r,s)}}e._([e.j()],Dt.prototype,"isTable",void 0),Dt=e._([e.e("rte-toolbar-button-table")],Dt);var Ot=function(e,t,i){var o=null,r=null,n=i&&i.leading,s=i&&i.trailing;null==n&&(n=!0);null==s&&(s=!n);1==n&&(s=!1);var a=function(){o&&(clearTimeout(o),o=null)},l=function(){var i=n&&!o,a=this,l=arguments;if(r=function(){return e.apply(a,l)},o||(o=setTimeout((function(){if(o=null,s)return r()}),t)),i)return i=!1,r()};return l.cancel=a,l.flush=function(){var e=r;a(),e&&e()},l};let At=class extends e.s{constructor(){super(...arguments),this.shown=!1,this.translateTop="-10000px",this.translateLeft="-10000px",this.isHeaderRow=!1,this.useBottomSheet=!1,this.onResize=Ot(this.updatePosition.bind(this),50),this.close=()=>{this.shadowRoot?.querySelector("rpl-bottom-sheet")?.hide()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this.onResize)}async updatePosition(){this.cell&&this.editor&&(await this.toggle({cell:this.cell,editor:this.editor,show:this.shown}))}setIsHeaderRow(){this.cellNode&&(this.isHeaderRow=(this.cellNode.__headerState&o.al.ROW)===o.al.ROW)}async toggle(e){const{cell:t,editor:i,show:n}=e??{};if(e&&(this.cell=t,this.editor=i,this.useBottomSheet=!!this.editor&&"true"===r.o(this.editor,"plugins.composer.isMobile")),i&&n&&t){i.update((()=>{this.cellNode=o.av(this.cell),this.setIsHeaderRow()}));const e=this.offsetParent.getBoundingClientRect(),r=t.getBoundingClientRect();this.translateLeft=r.right-e.left+window.scrollX-38+"px",this.translateTop=r.top-e.top+4+"px"}else this.translateTop="-10000px",this.translateLeft="-10000px";this.shown=n??this.shown,this.requestUpdate()}insertRow(e=!0){return t=>{if(t.preventDefault(),this.editor){let t,i,r;this.editor.update((()=>{this.cellNode&&(t=o.an(this.cellNode),i=o.aw(this.cellNode),r=o.ax(e),i=e?i:i+1)}),{onUpdate:()=>{this.editor&&this.editor.update((()=>{const e=t.getChildAtIndex(i);if(r&&e){const t=e.getChildren();r.getChildren().forEach(((e,i)=>{const o=t[i].getFirstChild().getFormatType();e.getFirstChild().setFormat(o)}))}}))}})}}}deleteRow(){return e=>{e.preventDefault(),this.editor&&(this.editor.dispatchCommand(a.R,{}),this.editor.update((()=>{o.ay()})))}}insertColumn(e=!0){return t=>{t.preventDefault(),this.editor&&this.editor.update((()=>{o.az(e)}))}}deleteColumn(){return e=>{e.preventDefault(),this.editor&&(this.editor.dispatchCommand(a.R,{}),this.editor.update((()=>{o.aA()})))}}deleteTable(){return e=>{e.preventDefault(),this.editor&&(this.editor.dispatchCommand(a.R,{}),this.editor.update((()=>{const e=o.E();if(o.u(e)){const t=o.G(e.getNodes()[0],(e=>o.a9(e)));t?.remove(!1)}})))}}alignColumn(e){return t=>{t.preventDefault(),this.editor.update((()=>{const t=o.an(this.cellNode),i=o.ao(this.cellNode);t.getChildren().forEach((t=>{t.getChildren()[i].getFirstChild().setFormat(e)}))}))}}renderButton(t){const i=r.y.tableActionsMenu();return e.x`<rpl-tooltip> ${r.p({attributes:{className:"opacity-90",onclick:t},leadingIcon:l.o({size:e.I.Small}),size:e.v.Small,shape:"pill",screenReaderContent:i})} <span slot="content">${i}</span> </rpl-tooltip>`}renderDropdown(t){return e.x` <rpl-dropdown placement="right-start" trigger="click"> <span> ${this.renderButton()} </span> <rpl-menu slot="content" hidden> ${t.map((t=>e.x` <rpl-menu-item @click="${t.onClick}"> <span slot="leading-icon">${t.leadingIcon}</span> ${t.label} </rpl-menu-item> ${t.addDividerBelow?e.x`<hr>`:e.x``} `))} </rpl-menu> </rpl-dropdown>`}renderBottomSheet(t){const i=e.x`<rpl-modal-card> <div slot="title">${r.y.tableActionsMenu()}</div> <div slot="close-button"> ${r.p({appearance:"secondary",leadingIcon:e.al({size:e.I.Small}),size:e.v.Small,attributes:{onclick:this.close},screenReaderContent:r.y.closeTableActionsMenu()})} </div> <rpl-menu> ${t.map((t=>e.x` <rpl-menu-item @click="${e=>{t.onClick(e),this.close()}}"> <span slot="leading-icon">${t.leadingIcon}</span> ${t.label} </rpl-menu-item> ${t.addDividerBelow?e.x`<hr>`:e.x``} `))} </rpl-menu></rpl-modal-card>`;return e.x` <rpl-bottom-sheet dialog-id="rte-table-menu-bottom-sheet" .litTemplateChildren="${i}"> </rpl-bottom-sheet> ${this.renderButton((()=>{this.shadowRoot?.querySelector("rpl-bottom-sheet")?.showModal()}))}`}render(){const i=[...(this.isHeaderRow ? [] : [{label:r.y.insertRowAbove(),leadingIcon:E.a(),onClick:this.insertRow(!1),addDividerBelow:!1}]),{label:r.y.insertRowBelow(),leadingIcon:E.a(),onClick:this.insertRow(!0),addDividerBelow:!1},{label:r.y.deleteRow(),leadingIcon:C.d(),onClick:this.deleteRow(),addDividerBelow:!0},{label:r.y.insertColumnBefore(),leadingIcon:E.a(),onClick:this.insertColumn(!1),addDividerBelow:!1},{label:r.y.insertColumnAfter(),leadingIcon:E.a(),onClick:this.insertColumn(!0),addDividerBelow:!1},{label:r.y.deleteColumn(),leadingIcon:C.d(),onClick:this.deleteColumn(),addDividerBelow:!0},{label:r.y.alignLeft(),leadingIcon:t.b(),onClick:this.alignColumn("left"),addDividerBelow:!1},{label:r.y.alignCenter(),leadingIcon:t.d(),onClick:this.alignColumn("center"),addDividerBelow:!1},{label:r.y.alignRight(),leadingIcon:t.e(),onClick:this.alignColumn("right"),addDividerBelow:!0},{label:r.y.deleteTable(),leadingIcon:C.d(),onClick:this.deleteTable(),addDividerBelow:!1}];return e.x`<div id="rte-table-menu-container" style="transform:translate(${this.translateLeft},${this.translateTop})" class="z-10 absolute start-0 top-0 ${this.shown?"":"hidden"}"> ${this.useBottomSheet?this.renderBottomSheet(i):this.renderDropdown(i)} </div>`}};At.styles=[e.t],e._([e.j()],At.prototype,"shown",void 0),e._([e.j()],At.prototype,"translateTop",void 0),e._([e.j()],At.prototype,"translateLeft",void 0),e._([e.j()],At.prototype,"isHeaderRow",void 0),At=e._([e.e("rte-table-menu")],At);const Bt="rte-link-modal";let $t=class extends e.s{constructor(){super(...arguments),this.disableSubmit=!0,this.submitFormOnReturnKey=e=>{"Enter"===e.key&&(e.preventDefault(),this.form?.submit())},this.stopFocusPropagation=e=>{e.stopPropagation()},this.initFormFields=()=>{this.form=this.modal?.portalContainer.querySelector("#rte-link-modal faceplate-form")??void 0,this.textField=this.modal?.portalContainer.querySelector("#rte-link-modal faceplate-text-input[name=text]")??void 0,this.urlField=this.modal?.portalContainer.querySelector("#rte-link-modal faceplate-text-input[name=url]")??void 0,this.submitButton=this.modal?.portalContainer.querySelector('#rte-link-modal [data-testid="btn-save-link"]')??void 0,this.textField?.addEventListener("keydown",this.submitFormOnReturnKey),this.urlField?.addEventListener("keydown",this.submitFormOnReturnKey),requestAnimationFrame((()=>{this.disableSubmit=!this.isValid()}))},this.close=()=>{this.disableSubmit=!0,this.form?.reset(),this.modal?.hide(),this.textField?.removeEventListener("keydown",this.submitFormOnReturnKey),this.urlField?.removeEventListener("keydown",this.submitFormOnReturnKey)},this.onCancel=e=>{e.stopPropagation(),this.close()},this.onSubmit=e=>{if(e.preventDefault(),e.stopPropagation(),this.isValid()){const e={url:this.getNormalizedUrlValue(),text:this.textField?.value||this.urlField?.value,nodeKey:this.link?.nodeKey,currentSelection:this.link?.currentSelection};this.link?.nodeKey?this.editor?.dispatchCommand(r.U,e):this.editor?.dispatchCommand(r.W,e),this.close()}},this.onRemove=e=>{e.preventDefault();const t={currentSelection:this.link?.currentSelection};this.editor?.dispatchCommand(r.j,t),this.close()},this.updateValidityFields=()=>{const e=this.isValidText(),t=this.isValidUrl(),i=e&&t;this.submitButton&&(this.disableSubmit=!i),""===this.getUrlValue()||t||this.form?.invalidateFieldWithMessage(this.urlField?.name,r.y.invalidUrl())},this.handleFormFocusout=()=>{this.updateValidityFields()},this.handleFormInput=e=>{this.updateValidityFields(),this.textField?.dispatchEvent(new Event("focusout",{bubbles:!0})),e.target===this.urlField&&this.urlField?.dispatchEvent(new Event("focusout",{bubbles:!0}))}}static get styles(){return[e.t]}async open(e,t){this.editor=e,this.link=t,await(this.modal?.showModal())}disconnectedCallback(){this.textField?.removeEventListener("keydown",this.submitFormOnReturnKey),this.urlField?.removeEventListener("keydown",this.submitFormOnReturnKey),super.disconnectedCallback()}getUrlValue(){return this.urlField?.value||""}getNormalizedUrlValue(){const e=this.getUrlValue(),t=n.b(e);return t?t.url:null}isValid(){return this.isValidText()&&this.isValidUrl()}isValidText(){return this.textField?.checkValidity()??!1}isValidUrl(){return null!==this.getNormalizedUrlValue()}renderLinkModal(){return e.x` <rpl-modal-card @focusin="${this.stopFocusPropagation}"> <div slot="title" class="text-center"> ${this.link?.nodeKey?r.y.editLink():r.y.addLink()} </div> <div slot="close-button"> ${r.p({appearance:"secondary",leadingIcon:e.al({size:e.I.Small}),size:e.v.Small,attributes:{onclick:this.close},screenReaderContent:r.y.closeLinkModal()})} </div> <faceplate-form @faceplate-submit="${this.onSubmit}" @input="${this.handleFormInput}" @focusout="${this.handleFormFocusout}" class="mb-0 mt-xl min-w-[350px]"> <div> <faceplate-text-input name="text" value="${this.link?.text}" class="w-100" faceplate-focusable> <span slot="label"> ${r.y.text()} </span> </faceplate-text-input> </div> <div class="mt-md"> <faceplate-text-input name="url" required inputmode="url" value="${this.link?.url}" class="w-100" faceplate-focusable helper-text-placeholder=" "> <span slot="label"> ${r.y.link()} </span> </faceplate-text-input> </div> <div class="mt-lg flex gap-md"> ${r.p({size:e.v.Medium,appearance:"secondary",children:r.y.cancel(),attributes:{"data-testid":"btn-cancel-link",className:"w-1/2",onclick:this.onCancel}})} ${r.p({size:e.v.Medium,appearance:"primary",children:r.y.save(),attributes:{className:"w-1/2","data-testid":"btn-save-link",onclick:this.onSubmit,disabled:this.disableSubmit}})} </div> </faceplate-form> </rpl-modal-card> `}focusTextField(){requestAnimationFrame((()=>{this.textField?.focus()}))}render(){return e.x`<rpl-dialog-sheet .overlayBlur="${!1}" id="${Bt}" dialog-id="${Bt}" label="${r.y.richTextEditorLinkDialog()}" class="min-h-[auto]" .litTemplateChildren="${this.renderLinkModal()}" @rpl-dialog-sheet:after-hide="${()=>this.close()}" @rpl-dialog-sheet:show="${()=>this.initFormFields()}" @rpl-dialog-sheet:initial-focus="${()=>this.focusTextField()}"> </rpl-dialog-sheet>`}};e._([e.j()],$t.prototype,"link",void 0),e._([e.Y("rpl-dialog-sheet",!0)],$t.prototype,"modal",void 0),e._([e.j()],$t.prototype,"disableSubmit",void 0),$t=e._([e.e("rte-link-modal")],$t);const Ut="rte-link-action-modal";let Ft=class extends e.s{constructor(){super(...arguments),this.close=()=>{this.modal?.hide()},this.onEdit=e=>{e.preventDefault(),this.editor?.dispatchCommand(r.X,this.link),this.modal?.hide()},this.onRemove=e=>{if(e.preventDefault(),this.editor){const e={currentSelection:this.link?.currentSelection};this.editor.dispatchCommand(r.j,e)}this.modal?.hide()}}static get styles(){return[e.t]}async open(e,t){this.editor=e,this.link=t,await(this.modal?.showModal())}renderActions(){return e.x` <rpl-modal-card> <div slot="title" class="text-center">${r.y.linkOptions()}</div> <div slot="close-button"> ${r.p({appearance:"secondary",leadingIcon:e.al({size:e.I.Small}),size:e.v.Small,screenReaderContent:r.y.closeLinkModal(),attributes:{onclick:this.close}})} </div> <div> <a href="${this.link?.url}" style="max-width:302px" target="_blank" class="truncate inline-block me-sm"> ${this.link?.url} </a> </div> <div class="me-sm -ms-sm"> ${r.p({attributes:{onclick:this.onEdit},shape:"pill",appearance:"plain",size:e.v.Small,leadingIcon:y.e({size:e.I.Small}),children:r.y.editLink()})} </div> <div class="me-sm -ms-sm"> ${r.p({attributes:{onclick:this.onRemove,className:"text-danger-content"},shape:"pill",appearance:"plain",size:e.v.Small,leadingIcon:C.d({size:e.I.Small}),children:r.y.removeLink()})} </div> </rpl-modal-card> `}render(){return e.x`<rpl-dialog-sheet .overlayBlur="${!1}" id="${Ut}" dialog-id="${Ut}" label="${r.y.richTextEditorLinkActionsDialog()}" class="min-h-[auto]" .litTemplateChildren="${this.renderActions()}"> </rpl-dialog-sheet>`}};function Ht(t,i){t.getRootElement()?.dispatchEvent(e.d(k,i))}function jt(e,t){const i=o.E();return!!o.u(i)&&(Ht(t,{text:i.getTextContent().length>0?i.getTextContent():"",url:"",currentSelection:i}),!0)}function Vt(t,i){const r=o.E();return!!o.u(r)&&(function(t,i){t.getRootElement()?.dispatchEvent(e.d(N,i))}(i,{text:t.text,url:t.url,nodeKey:t.nodeKey,currentSelection:r}),!0)}function zt(e){if(!e.url||!e.currentSelection)return!1;const t=e.currentSelection.clone();o.l(t);const i=e.text||e.url;if(t.getTextContent().length>0){o.aD(e.url,{target:"_blank"});const n=t.focus.getNode().getParent();if(n&&r.l(n)){const e=n.getChildren();if(e.length>0){const[t,...o]=e;t.setTextContent(i),t.setFormat(0),o.forEach((e=>e.remove()))}n.selectEnd()}}else{const n=r.a1(e.url,{target:"_blank"}),s=o.Z(i);n.append(s);const a=t.focus.getNode();o.w(a)?r.T(t,a,n):t.insertNodes([n]),n.selectEnd()}return!0}function Kt(e){const t=e.nodeKey?o.S(e.nodeKey):null;if(t&&r.k(t)){const i=t.getFirstChild();if(i){if(i.getTextContent()===e.text||e.url===e.text)t?.setURL(e.url),i.setTextContent(e.text),t.selectEnd();else{const i=r.a1(e.url,{target:"_blank"}),n=o.Z(e.text);i.append(n),t.replace(i),i.select(),i.selectEnd()}return!0}}if(t&&r.l(t)){const i=t.getFirstChild();if(i){const o=e.text||e.url;return i.setTextContent(o),t.setURL(e.url),t.selectEnd(),!0}}return!1}function qt(e,t){if(e)return Ht(t,e),!0;const i=t.getEditorState().read((()=>o.E()));if(!o.u(i))return!1;const r=i.focus.getNode(),n=o.af(r,o.o);return!(!n||!r)&&(Ht(t,{text:r.getTextContent(),url:n.getURL(),nodeKey:n.getKey(),currentSelection:i}),!0)}e._([e.j()],Ft.prototype,"link",void 0),e._([e.Y("rpl-dialog-sheet",!0)],Ft.prototype,"modal",void 0),Ft=e._([e.e("rte-link-action-modal")],Ft),[o.a1,o.aB,o.C,o.F,o.a3,o.aC,o.ak,o.y,o.aj,o.j].map((e=>e.getType()));let Gt=class extends me{constructor(){super(),this.isLink=!1,this.leadingIcon=T.l,this.text=r.y.addLinkButton(),this.name=ge.Link}handleClick(){this._editor?.dispatchCommand(this.isLink?r.X:r.Y,void 0)}beforeCreateEditor(e){return P(e=super.beforeCreateEditor(e),[{nodeType:r.s,nodeTypeConfig:{validChildren:[o.j.getType()]}},{nodeType:{replace:o.o,with:e=>new r.s(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle()}),withKlass:r.s}}])}showTooltip(e,t){const i=o.E();o.u(i)&&e.show({text:t.getTextContent(),nodeKey:t.getKey(),url:t.getURL(),currentSelection:i.clone()})}closeTooltip(e){e.hide()}tooltipFactory(e){return new r.Z(e)}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.o]))throw new Error("LinkPlugin: LinkNode not registered on editor");o.t(t.registerCommand(r.Y,jt,o.R),t.registerCommand(r.a0,Vt,o.R),t.registerCommand(r.W,zt,o.R),t.registerCommand(r.U,Kt,o.R),t.registerCommand(r.j,(e=>{if(!e.currentSelection)return!1;if(!o.u(e.currentSelection))return!1;const t=e.currentSelection.focus.getNode().getParent();return!(t&&!r.l(t))&&function(e){if(!e.currentSelection)return!1;const t=e.currentSelection.clone();return o.l(t),o.aD(null),!0}(e)}),o.R),t.registerCommand(r.X,qt,o.R),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();o.u(e)?this.isLink=r.c(e,(e=>r.l(e)||r.k(e))):this.isLink=!1,this.selected=this.isLink,this.disabled=this.$shouldDisable()}))})),r._(r.s,e))}$shouldDisable(){const e=o.E();if(!e||this.isLink)return!1;if(!o.u(e)||!this._rte)return!0;const t=e,i=t.getNodes(),n=i.map((e=>e.getParent()));if(t.isCollapsed()){const[e]=i,[t]=n;return!r.i(this._rte,r.q(e,o.j,o.a1)?t:e,o.o)}{const[e]=n;return!(i.every(((t,i)=>r.q(t,o.j)&&e===n[i]))&&r.i(this._rte,e,o.o))}}};e._([e.j()],Gt.prototype,"isLink",void 0),Gt=e._([e.e("rte-toolbar-button-link")],Gt);const Yt=[o.j,o.o,r.s,o.A,r.h,r.b,o.a2,r.t,o.C].map((e=>e.getType()));function Wt(e){return e instanceof o.C&&"bullet"===e.getListType()}let Jt=class extends(ye(me)){constructor(){super(),this.isBulletedList=!1,this.leadingIcon=w.l,this.text=r.y.bulletList(),this.name=ge.BulletList,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(this.isBulletedList?o.aE:o.aF,void 0)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"theme.list.nested.listitem","list-none"),P(e,[{nodeType:o.C,nodeTypeConfig:{validChildren:[o.aB.getType()]}},{nodeType:o.aB,nodeTypeConfig:{validChildren:Yt}}])}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.C,o.aB]))throw new Error("RTEToolbarButtonBulletedList: ListNode or ListItemNode not registered on editor");o.t(t.registerCommand(o.aF,(()=>(t.update((()=>{o.aI("bullet")})),!0)),o.s),t.registerCommand(o.aE,(()=>!!this.isBulletedList&&(t.update((()=>{o.aH()})),!0)),o.s),t.registerCommand(o.h,(()=>!!this.isBulletedList&&o.aG()),o.s),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isBulletedList=o.u(e)&&r.c(e,Wt),this.selected=this.isBulletedList}))})),r.w(o.aB,e,{collapseBlock:!1}))}};function Xt(e){return e instanceof o.C&&"number"===e.getListType()}e._([e.j()],Jt.prototype,"isBulletedList",void 0),Jt=e._([e.e("rte-toolbar-button-bulleted-list")],Jt);let Qt=class extends(ye(me)){constructor(){super(),this.isNumberedList=!1,this.leadingIcon=t.l,this.text=r.y.numberList(),this.name=ge.NumberList,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(this.isNumberedList?o.aE:o.aJ,void 0)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"list.nested.listitem","list-none"),P(e,[{nodeType:o.C,nodeTypeConfig:{validChildren:[o.aB.getType()]}},{nodeType:o.aB,nodeTypeConfig:{validChildren:Yt}}])}createEditor(e){super.createEditor(e);const t=this._editor;if(!t.hasNodes([o.C,o.aB]))throw new Error("RTEToolbarButtonNumberedList: ListNode or ListItemNode not registered on editor");o.t(t.registerCommand(o.aJ,(()=>(o.aL(t,"number"),!0)),o.s),t.registerCommand(o.aE,(()=>!!this.isNumberedList&&(o.aK(t),!0)),o.s),t.registerCommand(o.h,(()=>!!this.isNumberedList&&o.aG()),o.s),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isNumberedList=o.u(e)&&r.c(e,Xt),this.selected=this.isNumberedList}))})),r.w(o.aB,e,{collapseBlock:!1}))}};function Zt(e){const t=e.registerUpdateListener((()=>{t(),e.update((()=>{const e=o.E();if(o.u(e)){const t=e.anchor.getNode(),i=e.focus.getNode();if(!e.isCollapsed()&&!t.is(i)){let r=t,n=e.anchor.offset,s=i,a=e.focus.offset;if(e.isBackward()&&i.getTextContentSize()===e.focus.offset?(s=i.getNextSibling(),a=0):e.isBackward()||t.getTextContentSize()!==e.anchor.offset||(r=t.getNextSibling(),n=0),r=ei(r),s=ei(s),r&&s){const t=e.clone();t.setTextNodeRange(r,n,s,a),o.l(t)}}}}))}))}e._([e.j()],Qt.prototype,"isNumberedList",void 0),Qt=e._([e.e("rte-toolbar-button-numbered-list")],Qt);const ei=e=>o.g(e)?e.getAllTextNodes()[0]:e,ti="bold";let ii=class extends(we(me)){constructor(){super(),this.isBold=!1,this.leadingIcon=I.b,this.text=r.y.bold(),this.name=ge.Bold,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(o.i,ti)}createEditor(e){super.createEditor(e);const t=this._editor;o.e(t),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isBold=o.u(e)&&e.hasFormat(ti),this.selected=this.isBold}))})),r.v(t,(()=>!this.shouldDisable()),ti),t.registerCommand(o.i,(e=>(e!==ti||this.disabled||Zt(t),e===ti&&this.disabled)),o.J)}$shouldDisable(){const e=super.$shouldDisable();if(!e){const e=o.E();if(e&&(o.u(e)||o._(e))&&e.getNodes().some((e=>e.getParents().some((e=>o.aq(e)&&e.hasHeaderState(o.al.ROW))))))return!0}return e}};e._([e.j()],ii.prototype,"isBold",void 0),ii=e._([e.e("rte-toolbar-button-bold")],ii);const oi="italic";let ri=class extends(we(me)){constructor(){super(),this.isItalic=!1,this.leadingIcon=I.i,this.text=r.y.italic(),this.name=ge.Italic,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(o.i,oi)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"theme.text.italic",oi),e}createEditor(e){super.createEditor(e);const t=this._editor;o.e(t),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isItalic=o.u(e)&&e.hasFormat(oi),this.selected=this.isItalic}))})),r.v(t,(()=>!this.shouldDisable()),oi),t.registerCommand(o.i,(e=>(e!==oi||this.disabled||Zt(t),e===oi&&this.disabled)),o.J)}};e._([e.j()],ri.prototype,"isItalic",void 0),ri=e._([e.e("rte-toolbar-button-italic")],ri);const ni="strikethrough";let si=class extends(we(me)){constructor(){super(),this.isStrikethrough=!1,this.leadingIcon=t.s,this.text=r.y.strikethrough(),this.name=ge.Strikethrough,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(o.i,ni)}beforeCreateEditor(e){return Me((e=super.beforeCreateEditor(e)).lexical,"theme.text.strikethrough","line-through"),e}createEditor(e){super.createEditor(e);const t=this._editor;o.e(t),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isStrikethrough=o.u(e)&&e.hasFormat(ni),this.selected=this.isStrikethrough}))})),r.v(t,(()=>!this.shouldDisable()),ni),t.registerCommand(o.i,(e=>(e!==ni||this.disabled||Zt(t),e===ni&&this.disabled)),o.J)}};e._([e.j()],si.prototype,"isStrikethrough",void 0),si=e._([e.e("rte-toolbar-button-strikethrough")],si);const ai="superscript";let li=class extends(we(me)){constructor(){super(),this.isSuperscript=!1,this.leadingIcon=t.f,this.text=r.y.superscript(),this.name=ge.Superscript,this.isToggle=!0}handleClick(){this._editor?.dispatchCommand(o.i,ai)}createEditor(e){super.createEditor(e);const t=this._editor;o.e(t),t.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=o.E();this.isSuperscript=o.u(e)&&e.hasFormat(ai),this.selected=this.isSuperscript}))})),r.v(t,(()=>!this.shouldDisable()),ai),t.registerCommand(o.i,(e=>(e!==ai||this.disabled||Zt(t),e===ai&&this.disabled)),o.J)}};var di;e._([e.j()],li.prototype,"isSuperscript",void 0),li=e._([e.e("rte-toolbar-button-superscript")],li);let ci=di=class extends(i.T()){static get styles(){return[e.t,super.styles,e.i`:host{width:100%;display:block}:host([readonly]) ::slotted(div[contenteditable]){background-color:var(--color-interactive-background-disabled)}`]}static renderDefaultPlugins(){return e.x` ${ae()} ${j()} ${ce()} ${he()} `}removeAutoLink(e){this._removedAutoLinkKeySet.add(e)}hasAutoLinkRemoved(e){return this._removedAutoLinkKeySet.has(e)}get editorRoot(){if(!this._editorRoot){const{rootElements:e=[]}=this,[t,...i]=e;if(!t||i.length>0)throw new Error("A single child div should be passed into RedditRTE. e.g: <reddit-rte><div></div></reddit-rte>");this._editorRoot=t}return this._editorRoot}get buttons(){const{toolbarTopResponsivePlugins:e=[],actionBarPlugins:t=[],internalButtons:i=[]}=this;return[...e,...t,...i]}get plugins(){const{nonToolbarPlugins:e=[],buttons:t}=this;return[...e,...t]}get mediaMetadata(){return this._mediaMetadataMap||(this._mediaMetadataMap=function(e){const t=q(e),i={};for(const[e,o]of Object.entries(t)){const t=e,{src:r,width:n,height:s,mimetype:a,poster:l}=o;t&&r&&(i[t]={width:parseInt(n??"",10)||void 0,height:parseInt(s??"",10)||void 0,mimetype:a,src:r,poster:l})}return i}(this.mediaElements??[])),this._mediaMetadataMap}get redditorMetadata(){return(this.redditorElements??[]).map((e=>({id:e.dataset.id,name:e.dataset.name,isAuthor:"true"===e.dataset.isAuthor})))}get isDirty(){return this._isDirty}set isDirty(e){this._isDirty=e}set canShowPlaceholder(e){this._canShowPlaceholder=e}getEditor(){if(!this._editor){const{plugins:e}=this,t=q(this.configElements??[]),i=e.reduce(((e,t)=>{try{return t.beforeCreateEditor?.(e)||e}catch(t){return console.error(t),e}}),{lexical:M,plugins:t,nodes:{[o.aC.getType()]:{validChildren:[o.F,o.C,o.a0,r.I,o.a3,o.$,o.y,r.J,r.M].map((e=>e.getType()))},[o.F.getType()]:{validChildren:[o.j,o.a1,o.o,r.s,o.A,r.h,r.b,r.t,o.a2].map((e=>e.getType()))},[o.a1.getType()]:{validChildren:[]},[o.j.getType()]:{validChildren:[]}}});this._editor=this.editorFactory(i),r.a2(this._editor,i);const n=r.o(this._editor,"plugins.actionBar.showLeftActionBar"),s=r.o(this._editor,"plugins.actionBar.showRightActionBar"),a=r.o(this._editor,"plugins.formattingBar.showFormattingBar");void 0!==n&&(this.leftActionBarVisible="true"===n),void 0!==s&&(this.rightActionBarVisible="true"===s),void 0!==a&&(this.formattingBarVisible="true"===a),e.forEach((e=>{try{e.createEditor?.(this)}catch(e){console.error(e)}}))}return this._editor}getRTJSON(){if(!this._editor)return null;const e=this._editor.getEditorState();return r.a3(e.toJSON())}setRTJSON(e,t){if(!this._editor)throw new Error("editor uninitialized");return this.clear(),new Promise((i=>{this._editor?.update((()=>{r.R(e,t??this.mediaMetadata),o.b().selectEnd(),i()}),{skipTransforms:!0})}))}getPlainText(){return this.getEditor().getEditorState().read((()=>o.b().getTextContent()))}getRichTextMedia(){return this.getEditor().getEditorState().read((()=>[...o.U(r.I),...o.U(r.J)].map((e=>({id:e.mediaId,url:e.src,...(r.a4(e) ? {poster:e.poster,posterUploadedUrl:e.posterUploadedUrl,videoUploadedUrl:e.uploadedUrl} : {}),uploadedUrl:e.uploadedUrl,width:e.width,height:e.height,mimetype:e.mimetype})))));}async init(){const{editorRoot:t}=this;!function(t,{placeholder:i,readonly:o,size:r}){t.setAttribute("name","body"),t.setAttribute("contenteditable",o?"false":"true"),t.setAttribute("role","textbox"),["px-md","py-sm","outline-none","relative","resize-y","overflow-y-auto",r===e.ig.Small?V:z,"leading-5","box-border","[&_*:first-child:not(li)]:mt-0","[&_*:last-child]:mb-0"].forEach((e=>t.classList.add(e))),t.setAttribute("tabindex","1"),t.setAttribute("aria-placeholder",i)}(t,{placeholder:this.placeholder||"",readonly:this.readonly,size:this.size});const i=this.getEditor();if(i.setRootElement(t),i.setEditable(!this.readonly),i.registerCommand(o.aM,(()=>(this.dispatchEvent(e.d(e.gL,{},!0)),!1)),o.s),i.registerCommand(o.i,(e=>"underline"===e),o.J),this.initNodeRegistry(),this.initPersistedSelection(),function(e){e.getEditor().registerUpdateListener((({editorState:t})=>{e.canShowPlaceholder=t.read((()=>o.V(e.getEditor().isComposing())))}))}(this),this.initialValue?await this.setRTJSON(JSON.parse(this.initialValue)):this.addEmptyParagraphToRoot(!1),function(e){e.getEditor().registerUpdateListener((({dirtyElements:t,dirtyLeaves:i,prevEditorState:o,tags:r})=>{(i.size>0||t.size>0)&&(!o.isEmpty()&&!r.has("history-merge")||i.size>0)&&(e.isDirty=!0,e.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})))}))}(this),function(e){e.getEditor().registerUpdateListener((({editorState:t})=>{t.read((()=>0===o.b().getChildrenSize()))&&e.addEmptyParagraphToRoot()}))}(this),function(e){e.getEditor().registerMutationListener(o.F,(t=>{for(const[i,r]of t)"created"===r&&e.getEditor().update((()=>{const e=o.S(i);""!==e?.getFormatType()&&e?.setFormat("")}),{tag:"history-merge"})}))}(this),this._initialized=!0,this.readyState=a.a.Ready,this.onAfterInitCallback){const e=this.onAfterInitCallback;this.onAfterInitCallback=null,void 0!==window.requestIdleCallback?window.requestIdleCallback(e,{timeout:1e3}):window.requestAnimationFrame(e)}t.addEventListener("focus",(e=>{e.preventDefault(),i.focus()}))}addEmptyParagraphToRoot(e=!0){this.getEditor().update((()=>{const t=o.I();o.b().append(t),e&&t.selectEnd()}),{tag:"history-merge"})}clear(){this.getEditor().update((()=>{o.b().clear()}),{discrete:!0,onUpdate:()=>this.clearNodeRegistry()}),this.getEditor().dispatchCommand(o.aN,void 0)}reset(){this.clear(),this.initialValue&&this.getEditor().update((()=>{this.setRTJSON(JSON.parse(this.initialValue))})),this.getEditor().dispatchCommand(o.aN,void 0)}initNodeRegistry(){const e=function(e,t){const i=Array.from(e._nodes.values()).map((e=>e.klass)),o=[];for(const r of i){const i=e.registerMutationListener(r,((...e)=>{t(r,...e)}));o.push(i)}return()=>o.forEach((e=>e()))}(this.getEditor(),((e,t)=>{const i=e.prototype instanceof o.aP?this.decoratorNodeRegistry:this.elementNodeRegistry;let r=!1;for(const[o,n]of t)"created"===n?r=i.add(e.getType(),o)||r:"destroyed"===n&&(r=i.delete(e.getType(),o)||r);r&&this.getEditor().dispatchCommand(a.N,{decoratorNodeRegistry:this.decoratorNodeRegistry,elementNodeRegistry:this.elementNodeRegistry})}));this.unsubscribeFnList.push(e)}clearNodeRegistry(){this.decoratorNodeRegistry=new r.a5,this.elementNodeRegistry=new r.a5,this.getEditor().dispatchCommand(a.N,{decoratorNodeRegistry:this.decoratorNodeRegistry,elementNodeRegistry:this.elementNodeRegistry})}initPersistedSelection(){const e=this.getEditor().registerCommand(o.X,(()=>(this._isDirty?this.dispatchEvent(new Event("change",{bubbles:!0})):this.dispatchEvent(new Event("blur",{bubbles:!0})),this.selection=o.E()?.clone()??null,!1)),o.s),t=this.getEditor().registerCommand(a.R,(()=>(r.a6()===this._editor?.getRootElement()||(this.selection&&o.l(this.selection),this._editor?.focus((()=>{const e=this._editor?.getRootElement();r.a6()!==e&&e.focus({preventScroll:!0})}),{defaultSelection:"rootStart"})),!0)),o.ar);this.unsubscribeFnList.push(e,t)}firstUpdated(){this._initialized||this.init()}connectedCallback(){super.connectedCallback(),this.classList.add("flex"),this.classList.add("flex-col"),this._initialized&&(this.initNodeRegistry(),this.initPersistedSelection())}disconnectedCallback(){this.unsubscribeFnList.forEach((e=>e())),super.disconnectedCallback()}async getUpdateComplete(){const e=await super.getUpdateComplete(),t=await Promise.all([this.formattingBar?.updateComplete,this.actionBar?.updateComplete]);return e&&t.every((e=>e))}updated(t){t.has("readyState")&&this.dispatchEvent(e.d(a.b,this.readyState)),void 0!==t.get("readonly")&&(this._editor?.setEditable(!this.readonly),this.editorRoot.setAttribute("contenteditable",this.readonly?"false":"true"));void 0!==t.get("formattingBarVisible")&&this.formattingBarVisible&&this.formattingBar?.focus(),super.updated(t)}focus(){const e=()=>{this.editorRoot.focus()};this._initialized?e():this.onAfterInitCallback=e}hasFocus(){return!(!this.editorRoot||document.activeElement!==this.editorRoot)}isEmpty(){return!this._initialized||!(this.decoratorNodeRegistry.count()>0)&&this.getEditor().getEditorState().read((()=>o.aO(this.getEditor().isComposing(),!0)))}constructor(){super(),this._initialized=!1,this._isDirty=!1,this._events=new e.E(this),this._pendingNodes=new Set,this._errorNodes=new Set,this._removedAutoLinkKeySet=new Set,this.readonly=!1,this.initialValue="",this.editorFactory=A,this.placeholder="",this.size=e.ig.Small,this.readyState=a.a.Pending,this.formattingBarVisible=!0,this.leftActionBarVisible=!0,this.rightActionBarVisible=!0,this._canShowPlaceholder=!0,this._editorRoot=null,this.decoratorNodeRegistry=new r.a5,this.elementNodeRegistry=new r.a5,this.unsubscribeFnList=[],this.onAfterInitCallback=null,this.selection=null,this._events.define(k,(async e=>{const t=this.shadowRoot?.querySelector("rte-link-modal");t&&(await t.open(this.getEditor(),e.detail))})),this._events.define(N,(async e=>{const t=this.shadowRoot?.querySelector("rte-link-action-modal");t&&(await t.open(this.getEditor(),e.detail))})),this._events.define(K,(async e=>{const t=this.shadowRoot?.querySelector("rte-table-menu");t&&(await t.toggle(e.detail))})),this._events.define(a.c,(e=>{e.stopPropagation();const{resolveReadyState:t}=e.detail;this.readyState=a.a.Pending,this._pendingNodes.add(t),t.catch((()=>{})).finally((()=>{this._pendingNodes.delete(t),this._pendingNodes.size<1&&(this.readyState=a.a.Ready)}))})),this._events.define(a.d,(e=>{e.stopPropagation(),this._errorNodes.add(e.detail),this.setCustomValidity(r.y.thereAreSomeErrors())})),this._events.define(a.e,(e=>{e.stopPropagation(),this._errorNodes.delete(e.detail),0===this._errorNodes.size&&this.setCustomValidity("")}))}toggleFormattingBar(){this.formattingBarVisible=!this.formattingBarVisible}renderTranslationBar(){return e.x` <div class="action-bar order-3"> <slot name="translation-bar"></slot> </div> `}renderActionBar(){return this.leftActionBarVisible||this.rightActionBarVisible?e.x`<rte-toolbar class="action-bar order-3"> ${this.leftActionBarVisible&&e.x`<slot slot="responsive" name="action-bar"> <rte-toolbar-button-image></rte-toolbar-button-image> <rte-toolbar-button-video></rte-toolbar-button-video> <rte-toolbar-button-giphy></rte-toolbar-button-giphy> <rte-toolbar-button ?selected="${this.formattingBarVisible}" .leadingIcon="${t.g}" screenReaderContent="${this.formattingBarVisible?r.y.hideFormattingOptions():r.y.showFormattingOptions()}" @click="${this.toggleFormattingBar}"></rte-toolbar-button> </slot>`} ${this.rightActionBarVisible&&e.x`<slot slot="fixed" name="action-bar-right"></slot>`} </rte-toolbar>`:e.x``}parseFormattingBarConfig(e){return e?{isSticky:"true"===r.o(e,"plugins.formattingBar.isSticky"),isVisible:"false"!==r.o(e,"plugins.formattingBar.showFormattingBar"),stickyTopOffset:G(r.o(e,"plugins.formattingBar.stickyTopOffset"),0),stickyZIndex:G(r.o(e,"plugins.formattingBar.stickyZIndex"),0)}:{isSticky:!1}}renderTopToolbar(){const{isSticky:t,stickyTopOffset:i,stickyZIndex:o}=this.parseFormattingBarConfig(this._editor),n={hidden:!this.formattingBarVisible,sticky:t},s=t?{top:`${i}px`,zIndex:o}:{},a=()=>e.x`<hr class="mx-0 border-solid border-sm border-neutral-border-weak" role="presentation">`;return e.x` <rte-toolbar class="toolbar-top-responsive order-1 ${e.Q(n)}" role="toolbar" aria-orientation="horizontal" aria-label="${r.y.textFormattingToolbar()}" style="${e.a1(s)}" part="toolbar-top"> <slot slot="responsive" name="toolbar-top-responsive"> <rte-toolbar-button-bold></rte-toolbar-button-bold> <rte-toolbar-button-italic></rte-toolbar-button-italic> <rte-toolbar-button-strikethrough></rte-toolbar-button-strikethrough> <rte-toolbar-button-superscript></rte-toolbar-button-superscript> <rte-toolbar-button-heading></rte-toolbar-button-heading> ${a()} <rte-toolbar-button-link></rte-toolbar-button-link> <slot name="toolbar-additions"></slot> <rte-toolbar-button-bulleted-list></rte-toolbar-button-bulleted-list> <rte-toolbar-button-numbered-list></rte-toolbar-button-numbered-list> ${a()} <rte-toolbar-button-spoiler></rte-toolbar-button-spoiler> <rte-toolbar-button-block-quote></rte-toolbar-button-block-quote> <rte-toolbar-button-code></rte-toolbar-button-code> <rte-toolbar-button-code-block></rte-toolbar-button-code-block> <rte-toolbar-button-table></rte-toolbar-button-table> <slot name="top-toolbar-right"></slot> </slot> </rte-toolbar> `}render(){return e.x` <div class="order-2 relative"> ${this._canShowPlaceholder&&(this.placeholder||this.placeholderElement)?e.x` <p aria-hidden="true" class="absolute inset-0 m-0 px-md py-sm leading-5 text-neutral-content-weak flex items-baseline"> <slot name="placeholder-html">${this.placeholder}</slot> </p> `:e.x``} <slot></slot> </div> ${this.shouldRenderTranslation?this.renderTranslationBar():""} ${this.renderActionBar()} ${this.renderTopToolbar()} <slot name="plugins">${di.renderDefaultPlugins()}</slot> <rte-link-modal></rte-link-modal> <rte-link-action-modal></rte-link-action-modal> <rte-table-menu></rte-table-menu> `}};return ci.shadowRootOptions={...e.s.shadowRootOptions,delegatesFocus:!0},e._([e.ba("rte-toolbar-button")],ci.prototype,"internalButtons",void 0),e._([e.n({type:Boolean})],ci.prototype,"readonly",void 0),e._([e.n({type:String,attribute:"value"})],ci.prototype,"initialValue",void 0),e._([e.n({attribute:!1})],ci.prototype,"editorFactory",void 0),e._([e.n({type:String})],ci.prototype,"placeholder",void 0),e._([e.n({type:Boolean,attribute:"should-render-translation"})],ci.prototype,"shouldRenderTranslation",void 0),e._([e.n({type:String})],ci.prototype,"size",void 0),e._([e.r({slot:"placeholder-html",flatten:!0})],ci.prototype,"placeholderElement",void 0),e._([e.j()],ci.prototype,"readyState",void 0),e._([e.j()],ci.prototype,"formattingBarVisible",void 0),e._([e.j()],ci.prototype,"leftActionBarVisible",void 0),e._([e.j()],ci.prototype,"rightActionBarVisible",void 0),e._([e.j()],ci.prototype,"_canShowPlaceholder",void 0),e._([e.r({flatten:!0,selector:"data[value=config]"})],ci.prototype,"configElements",void 0),e._([e.r({flatten:!0,selector:"data[value=media]"})],ci.prototype,"mediaElements",void 0),e._([e.r({flatten:!0,selector:"data[value=redditor]"})],ci.prototype,"redditorElements",void 0),e._([e.r({flatten:!0,selector:"div"})],ci.prototype,"rootElements",void 0),e._([e.r({slot:"plugins",flatten:!0})],ci.prototype,"nonToolbarPlugins",void 0),e._([e.Y("rte-toolbar.toolbar-top-responsive")],ci.prototype,"formattingBar",void 0),e._([e.r({slot:"toolbar-top-responsive",flatten:!0})],ci.prototype,"toolbarTopResponsivePlugins",void 0),e._([e.Y("rte-toolbar.action-bar")],ci.prototype,"actionBar",void 0),e._([e.r({slot:"action-bar",flatten:!0})],ci.prototype,"actionBarPlugins",void 0),ci=di=e._([e.e("reddit-rte")],ci),{get R(){return ci},S:V,a:"min-h-[30rem]",b:z,c:pe,d:lt,e:async function(e,{count:t}){const i=await it(e);return(await ot(i,{count:t})).map((e=>({file:e,src:URL.createObjectURL(e)})))},g:st,s:x,v:dt}}));
SML.dm("BNvs6GxKML",[],(async()=>{var e,t;!function(e){e.Body="body",e.OptionalBody="optionalBody",e.CrosspostSourceId="crosspostSourceId",e.DraftId="draftId",e.EventStartDate="eventStartDate",e.EventStartTime="eventStartTime",e.Flair="flair",e.FlairId="flairId",e.FlairText="flairText",e.IsSpoiler="isSpoiler",e.IsNsfw="isNsfw",e.IsCommercialCommunication="isCommercialCommunication",e.Image="image",e.Link="link",e.PrefixedName="prefixedName",e.RecaptchaToken="recaptchaToken",e.ScheduledPostId="scheduledPostId",e.StartTimeToggle="startTimeToggle",e.SubmitType="submitType",e.SubredditId="subredditId",e.SubredditName="subredditName",e.Title="title",e.Type="type",e.Video="video",e.Schedule="schedule",e.EventType="eventType",e.TargetLanguage="targetLanguage",e.AMAEventDuration="amaEventDuration"}(e||(e={})),function(e){e.Now="now",e.Later="later"}(t||(t={}));return{get P(){return e},S:"schedule-input-section",get a(){return t}}}));

SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("BqP-pGuf5N",["CYrPuvCiTj"],(async t=>{let e;const n=new Uint8Array(16);function r(){if(!e&&(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=[];for(let t=0;t<256;++t)a.push((t+256).toString(16).slice(1));function c(t,e=0){return(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase()}function s(t){if(!function(t){return"string"==typeof t&&o.test(t)}(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}function l(t,e,n){function r(t,r,o,a){var l;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof r&&(r=s(r)),16!==(null===(l=r)||void 0===l?void 0:l.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let i=new Uint8Array(16+t.length);if(i.set(r),i.set(t,r.length),i=n(i),i[6]=15&i[6]|e,i[8]=63&i[8]|128,o){a=a||0;for(let t=0;t<16;++t)o[a+t]=i[t];return o}return c(i)}try{r.name=t}catch(t){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function i(t){return 14+(t+64>>>9<<4)+1}function u(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function f(t,e,n,r,o,a){return u((c=u(u(e,t),u(r,a)))<<(s=o)|c>>>32-s,n);var c,s}function d(t,e,n,r,o,a,c){return f(e&n|~e&r,t,e,o,a,c)}function g(t,e,n,r,o,a,c){return f(e&r|n&~r,t,e,o,a,c)}function p(t,e,n,r,o,a,c){return f(e^n^r,t,e,o,a,c)}function h(t,e,n,r,o,a,c){return f(n^(e|~r),t,e,o,a,c)}l("v3",48,(function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){const e=[],n=32*t.length,r="0123456789abcdef";for(let o=0;o<n;o+=8){const n=t[o>>5]>>>o%32&255,a=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);e.push(a)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[i(e)-1]=e;let n=1732584193,r=-271733879,o=-1732584194,a=271733878;for(let e=0;e<t.length;e+=16){const c=n,s=r,l=o,i=a;n=d(n,r,o,a,t[e],7,-680876936),a=d(a,n,r,o,t[e+1],12,-389564586),o=d(o,a,n,r,t[e+2],17,606105819),r=d(r,o,a,n,t[e+3],22,-1044525330),n=d(n,r,o,a,t[e+4],7,-176418897),a=d(a,n,r,o,t[e+5],12,1200080426),o=d(o,a,n,r,t[e+6],17,-1473231341),r=d(r,o,a,n,t[e+7],22,-45705983),n=d(n,r,o,a,t[e+8],7,1770035416),a=d(a,n,r,o,t[e+9],12,-1958414417),o=d(o,a,n,r,t[e+10],17,-42063),r=d(r,o,a,n,t[e+11],22,-1990404162),n=d(n,r,o,a,t[e+12],7,1804603682),a=d(a,n,r,o,t[e+13],12,-40341101),o=d(o,a,n,r,t[e+14],17,-1502002290),r=d(r,o,a,n,t[e+15],22,1236535329),n=g(n,r,o,a,t[e+1],5,-165796510),a=g(a,n,r,o,t[e+6],9,-1069501632),o=g(o,a,n,r,t[e+11],14,643717713),r=g(r,o,a,n,t[e],20,-373897302),n=g(n,r,o,a,t[e+5],5,-701558691),a=g(a,n,r,o,t[e+10],9,38016083),o=g(o,a,n,r,t[e+15],14,-660478335),r=g(r,o,a,n,t[e+4],20,-405537848),n=g(n,r,o,a,t[e+9],5,568446438),a=g(a,n,r,o,t[e+14],9,-1019803690),o=g(o,a,n,r,t[e+3],14,-187363961),r=g(r,o,a,n,t[e+8],20,1163531501),n=g(n,r,o,a,t[e+13],5,-1444681467),a=g(a,n,r,o,t[e+2],9,-51403784),o=g(o,a,n,r,t[e+7],14,1735328473),r=g(r,o,a,n,t[e+12],20,-1926607734),n=p(n,r,o,a,t[e+5],4,-378558),a=p(a,n,r,o,t[e+8],11,-2022574463),o=p(o,a,n,r,t[e+11],16,1839030562),r=p(r,o,a,n,t[e+14],23,-35309556),n=p(n,r,o,a,t[e+1],4,-1530992060),a=p(a,n,r,o,t[e+4],11,1272893353),o=p(o,a,n,r,t[e+7],16,-155497632),r=p(r,o,a,n,t[e+10],23,-1094730640),n=p(n,r,o,a,t[e+13],4,681279174),a=p(a,n,r,o,t[e],11,-358537222),o=p(o,a,n,r,t[e+3],16,-722521979),r=p(r,o,a,n,t[e+6],23,76029189),n=p(n,r,o,a,t[e+9],4,-640364487),a=p(a,n,r,o,t[e+12],11,-421815835),o=p(o,a,n,r,t[e+15],16,530742520),r=p(r,o,a,n,t[e+2],23,-995338651),n=h(n,r,o,a,t[e],6,-198630844),a=h(a,n,r,o,t[e+7],10,1126891415),o=h(o,a,n,r,t[e+14],15,-1416354905),r=h(r,o,a,n,t[e+5],21,-57434055),n=h(n,r,o,a,t[e+12],6,1700485571),a=h(a,n,r,o,t[e+3],10,-1894986606),o=h(o,a,n,r,t[e+10],15,-1051523),r=h(r,o,a,n,t[e+1],21,-2054922799),n=h(n,r,o,a,t[e+8],6,1873313359),a=h(a,n,r,o,t[e+15],10,-30611744),o=h(o,a,n,r,t[e+6],15,-1560198380),r=h(r,o,a,n,t[e+13],21,1309151649),n=h(n,r,o,a,t[e+4],6,-145523070),a=h(a,n,r,o,t[e+11],10,-1120210379),o=h(o,a,n,r,t[e+2],15,718787259),r=h(r,o,a,n,t[e+9],21,-343485551),n=u(n,c),r=u(r,s),o=u(o,l),a=u(a,i)}return[n,r,o,a]}(function(t){if(0===t.length)return[];const e=8*t.length,n=new Uint32Array(i(e));for(let r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}(t),8*t.length))}));var y={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function m(t,e,n){if(y.randomUUID&&!t)return y.randomUUID();const o=(t=t||{}).random||(t.rng||r)();return o[6]=15&o[6]|64,o[8]=63&o[8]|128,c(o)}function I(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:case 3:return e^n^r;case 2:return e&n^e&r^n&r}}function U(t,e){return t<<e|t>>>32-e}l("v5",80,(function(t){const e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const r=t.length/4+2,o=Math.ceil(r/16),a=new Array(o);for(let e=0;e<o;++e){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=t[64*e+4*r]<<24|t[64*e+4*r+1]<<16|t[64*e+4*r+2]<<8|t[64*e+4*r+3];a[e]=n}a[o-1][14]=8*(t.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<o;++t){const r=new Uint32Array(80);for(let e=0;e<16;++e)r[e]=a[t][e];for(let t=16;t<80;++t)r[t]=U(r[t-3]^r[t-8]^r[t-14]^r[t-16],1);let o=n[0],c=n[1],s=n[2],l=n[3],i=n[4];for(let t=0;t<80;++t){const n=Math.floor(t/20),a=U(o,5)+I(n,c,s,l)+i+e[n]+r[t]>>>0;i=l,l=s,s=U(c,30)>>>0,c=o,o=a}n[0]=n[0]+o>>>0,n[1]=n[1]+c>>>0,n[2]=n[2]+s>>>0,n[3]=n[3]+l>>>0,n[4]=n[4]+i>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));const S=(t,e)=>t.replace(e,"USER_ID"),w=(t,e,n)=>{window.Sentry?.withScope((r=>{r.setExtras({storageKey:S(t,n),valueSizeBytes:e.length}),((t,e)=>{try{const n=JSON.stringify(localStorage).length,r=Object.keys(localStorage),o=r.map((t=>({key:S(t,e),size:localStorage.getItem(t)?.length||0})));t.setExtras({"localStorageUsage.totalSize":n,"localStorageUsage.keyCount":r.length,"localStorageUsage.keySizes":o})}catch{}})(r,n),((t,e)=>{try{const n=b(e),r=n.map((t=>({size:JSON.stringify(t).length,contentLength:t.content?.length||0})));t.setExtras({"draftStorageInfo.draftCount":n.length,"draftStorageInfo.totalDraftSize":JSON.stringify(n).length,"draftStorageInfo.draftSizes":r})}catch{}})(r,n),window.Sentry?.captureMessage("localStorage quota exceeded while saving comment draft","warning")}))},A=({key:e,value:n,userId:r})=>{try{t.a6.setItem(e,n)}catch{w(e,n,r)}},v=e=>`${t.cU}${e}`,D=(t,e)=>t.filter((t=>!((t,e)=>Date.now()-t>864e5*e)(t.lastUpdatedTime,e))),b=e=>{const n=v(e);return(t=>{try{return JSON.parse(t||"")}catch{return null}})(t.a6.getItem(n))??[]};return{a:(t,e)=>b(t).find((t=>t.id===e))??null,b:(t,{postId:e,parentCommentId:n})=>b(t).find((t=>n?t.postId===e&&t.parentCommentId===n:t.postId===e&&!t.parentCommentId))??null,c:(t,e,n)=>{const r=m(),o=v(t);let a=b(t);20===a.length&&(a.sort(((t,e)=>e.lastUpdatedTime-t.lastUpdatedTime)),a.splice(-1),n?.());const c=D(a,14);return c.length<a.length&&(a=c,n?.()),a.push({...e,id:r,lastUpdatedTime:Date.now()}),A({key:o,value:JSON.stringify(a),userId:t}),r},d:(t,e)=>{const n=v(t),r=b(t).filter((t=>t.id!==e));A({key:n,value:JSON.stringify(r),userId:t})},g:b,h:t=>0!==b(t).length,u:(t,e,n)=>{const r=v(t),o=b(t).map((t=>t.id===e?{...t,...n,lastUpdatedTime:Date.now()}:t));A({key:r,value:JSON.stringify(o),userId:t})}}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("CApS9zNWCX",["CYrPuvCiTj"],(async a=>{const{svg:c}=a.a(),t=a.m(c`<path d="M15.744 10.998c.524.654.79 1.47.797 2.446 0 .889-.224 1.68-.673 2.37-.449.69-1.076 1.228-1.882 1.611-.806.383-1.734.575-2.782.575H7.003a2.004 2.004 0 01-2.004-2.004V4.004C4.999 2.897 5.896 2 7.003 2H9.88c1.114 0 2.083.175 2.907.526.824.351 1.455.833 1.893 1.448.438.615.66 1.313.667 2.094a4.325 4.325 0 01-.494 1.958A4.405 4.405 0 0113.6 9.55c.904.311 1.618.794 2.142 1.448h.002zM8.102 4.701V8.66h2.061c.427 0 .805-.085 1.134-.255.329-.17.584-.407.765-.711.181-.304.271-.654.271-1.052 0-.607-.208-1.083-.624-1.426-.416-.343-1.003-.515-1.763-.515H8.102zm3.038 10.598c.477 0 .891-.089 1.242-.266.351-.177.618-.425.803-.743.185-.318.277-.683.277-1.096 0-.665-.235-1.179-.705-1.54s-1.081-.542-1.833-.542h-2.82v4.187h3.036z"></path>`,"0 0 20 20","bold"),{svg:h}=a.a();return{b:t,i:a.m(h`<path d="M12.35 4c0 .75-.6 1.35-1.35 1.35-.75 0-1.35-.6-1.35-1.35 0-.75.6-1.35 1.35-1.35.75 0 1.35.6 1.35 1.35zM9.9 16.01c-.15-.1-.22-.26-.22-.49 0-.09 0-.16.02-.21l1.43-7.13a.976.976 0 00-.96-1.17c-.47 0-.87.33-.96.78l-1.45 7.12c-.07.32-.1.64-.1.95 0 .62.18 1.12.54 1.5.22.23.54.42.94.56.1.03.19.05.29.05.4 0 .78-.26.92-.67.27-.71-.18-1.16-.45-1.29z"></path>`,"0 0 20 20","italic")}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./Bb-T49I7YR.js",import.meta.url,"Bb-T49I7YR");SML.di("./DWvjLeuquR.js",import.meta.url,"DWvjLeuquR");SML.di("./G2F6lxYj4X.js",import.meta.url,"G2F6lxYj4X");
SML.dm("CJ0956vDhY",["CYrPuvCiTj","Bb-T49I7YR","DWvjLeuquR","G2F6lxYj4X"],(async(e,t)=>{const a={COMMENT:"comment",POST:"post"};let n=class extends e.s{constructor(){super(...arguments),this.translationContextValue=e.aN,this.showTranslationModal=()=>{this.translationModal.showModal()},this.hideTranslationModal=()=>{this.translationModal.close()},this.isCommentModal=()=>this.modalType===a.COMMENT,this.saveCommentTranslationModalSetting=()=>{if(this.hideTranslationCheckbox.checked){const a=this.translationContextValue;this.isCommentModal()?(a.showCommentTranslationModal=!1,e.k(this,t.h())):(a.showPostTranslationModal=!1,e.k(this,t.i()));const n=new CustomEvent("update-translation-context",{bubbles:!0,composed:!0,detail:a});this.dispatchEvent(n)}},this.modalRefuseClick=e=>{e.preventDefault(),e.stopPropagation(),this.saveCommentTranslationModalSetting(),this.hideTranslationModal(),this.handleTranslationRefuseClick()},this.modalConfirmClick=e=>{e.preventDefault(),e.stopPropagation(),this.saveCommentTranslationModalSetting(),this.hideTranslationModal(),this.handleTranslationConfirmClick()},this.renderTitleText=()=>e.x` ${this.isCommentModal()?"Translate your comment":"Translate your post"} `,this.renderBodyText=()=>e.x` ${this.isCommentModal()?"Users might not understand your comment without a translation. Would you like to translate your comment before posting it?":"Users might not understand your post without a translation. Would you like to translate you post?"} `,this.renderButtonText=()=>e.x` ${this.isCommentModal()?"Translate comment":"Translate post"} `,this.renderCheckBoxText=()=>e.x` ${this.isCommentModal()?"Don’t ask to translate my comments again.":"Don’t ask to translate my post again."} `}render(){return e.x` <faceplate-modal id="contribution-translation-modal" class="min-h-[auto]"> <div slot="title">${this.renderTitleText()}</div> <div slot="closeButton"> ${e.u({appearance:"secondary",leadingIcon:e.al({size:e.I.Small}),size:e.v.Small,attributes:{"aria-label":"Cancel",onclick:this.hideTranslationModal}})} </div> <div class="mb-0 w-[350px]"> <p class="mt-md text-14 leading-5 text-neutral-content" data-testid="translation-modal-body"> ${this.renderBodyText()} </p> <div> <faceplate-checkbox-input id="comment-translation-hide-checkbox" class="pt-[8px] text-14 leading-5 text-neutral-content"> ${this.renderCheckBoxText()} </faceplate-checkbox-input> </div> <div class="mt-lg flex gap-xs"> ${e.u({size:e.v.Medium,appearance:"secondary",children:"Refuse translation",attributes:{className:"w-1/2",onclick:this.modalRefuseClick,"data-testid":"translation-refuse-button"}})} ${e.u({size:e.v.Medium,appearance:"primary",children:this.renderButtonText(),attributes:{className:"w-1/2",onclick:this.modalConfirmClick,"data-testid":"translation-confirm-button"}})} </div> </div> </faceplate-modal> `;}};var i;n.styles=[e.t],e._([e.n({type:Object})],n.prototype,"handleTranslationConfirmClick",void 0),e._([e.n({type:Object})],n.prototype,"handleTranslationRefuseClick",void 0),e._([e.n({type:String,attribute:"modal-type"})],n.prototype,"modalType",void 0),e._([e.aM({context:e.aO,subscribe:!0}),e.j()],n.prototype,"translationContextValue",void 0),e._([e.Y("faceplate-checkbox-input#comment-translation-hide-checkbox")],n.prototype,"hideTranslationCheckbox",void 0),e._([e.Y("faceplate-modal#contribution-translation-modal",!0)],n.prototype,"translationModal",void 0),n=e._([e.e("translation-contribution-modal")],n),function(e){e.PostSubmit="post_submit",e.CommentSubmit="comment_submit"}(i||(i={}));return{M:a,R:2e3,get a(){return i},s:async function(e,t){e.value=await async function(e){const t=document.querySelector("reputation-recaptcha");if(!t)throw new Error("Unable to find reputation-recaptcha component");return await t.getToken(e)}(t)}}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("CigYKiUosZ",["CYrPuvCiTj"],(async c=>{const{svg:s}=c.a();return{l:c.m(s`<path d="M4 2.45c-.86 0-1.55.69-1.55 1.55 0 .86.69 1.55 1.55 1.55.86 0 1.55-.69 1.55-1.55 0-.86-.69-1.55-1.55-1.55zM4 8.45c-.86 0-1.55.69-1.55 1.55 0 .86.69 1.55 1.55 1.55.86 0 1.55-.69 1.55-1.55 0-.86-.69-1.55-1.55-1.55zM4 14.45c-.86 0-1.55.69-1.55 1.55 0 .86.69 1.55 1.55 1.55.86 0 1.55-.69 1.55-1.55 0-.86-.69-1.55-1.55-1.55zM9 4.9h8c.5 0 .9-.4.9-.9s-.4-.9-.9-.9H9c-.5 0-.9.4-.9.9s.4.9.9.9zM17 15.1H9c-.5 0-.9.4-.9.9s.4.9.9.9h8c.5 0 .9-.4.9-.9s-.4-.9-.9-.9zM17 9.1H9c-.5 0-.9.4-.9.9s.4.9.9.9h8c.5 0 .9-.4.9-.9s-.4-.9-.9-.9z"></path>`,"0 0 20 20","list-bulleted",!0)}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("DV-5OOn05m",["CYrPuvCiTj"],(async a=>{const{svg:c}=a.a();return{v:a.m(c`<path d="M8.797 14a1.78 1.78 0 01-.865-.224A1.816 1.816 0 017 12.187V7.812c0-.662.358-1.27.932-1.589a1.786 1.786 0 011.83.06L13.17 8.47c.521.334.831.906.831 1.53 0 .622-.31 1.194-.83 1.528l-3.408 2.187a1.79 1.79 0 01-.965.283V14zm0-6.188v4.375L12.204 10 8.797 7.812zM10 18.9c-1.516 0-2.946-.186-4.372-.57a5.626 5.626 0 01-3.958-3.956 16.605 16.605 0 01-.57-4.37c0-1.514.187-2.944.57-4.37a5.626 5.626 0 013.958-3.958 16.902 16.902 0 018.744 0 5.626 5.626 0 013.958 3.956c.384 1.428.57 2.858.57 4.371 0 1.513-.187 2.943-.57 4.37a5.626 5.626 0 01-3.958 3.957c-1.426.384-2.856.57-4.372.57zm-6.592-4.994a3.818 3.818 0 002.686 2.686 15.12 15.12 0 007.81 0 3.814 3.814 0 002.686-2.686c.342-1.273.508-2.55.508-3.903 0-1.353-.166-2.63-.508-3.904a3.818 3.818 0 00-2.686-2.686 15.12 15.12 0 00-7.81 0A3.814 3.814 0 003.408 6.1a14.841 14.841 0 00-.508 3.903c0 1.353.166 2.63.508 3.903v.001z"></path>`,"0 0 20 20","video")}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");SML.di("./BNvs6GxKML.js",import.meta.url,"BNvs6GxKML");
SML.dm("DjDHaQkcuh",["CYrPuvCiTj","nZA40q2akY","BNvs6GxKML"],(async(n,o,t)=>{var e,i,r,l,s,a,u;!function(n){n.Inform="inform",n.Report="report",n.Block="block",n.Educate="educate",n.Redirect="redirect",n.Guideline="guideline",n.Offtopic="offtopic",n.UserFlair="userflair"}(e||(e={})),function(n){n.Post="Post",n.Comment="Comment",n.User="User"}(i||(i={})),function(n){n.Keywords="Keywords",n.Regex="Regex",n.Url="Url",n.UrlDomain="UrlDomain",n.BooleanUserFlair="BooleanUserFlair",n.SpecificUserFlair="SpecificUserFlair"}(r||(r={})),function(n){n.Link="LINK",n.Image="IMAGE",n.Video="VIDEO",n.Text="TEXT",n.Poll="POLL",n.Gallery="GALLERY",n.Crosspost="CROSSPOST",n.Ama="AMA"}(l||(l={})),function(n){n.Include="Include",n.Exclude="Exclude"}(s||(s={})),function(n){n.Inform="Inform",n.Report="Report",n.Block="Block"}(a||(a={})),function(n){n.PostTitleAndPostBody="PostTitleAndPostBody",n.PostTitle="PostTitle",n.PostBody="PostBody",n.CommentBody="CommentBody",n.UserFlair="UserFlair",n.PostUrl="PostUrl"}(u||(u={}));const c="tab";var d,C,m,p,g,f;!function(n){n.Discover="discover",n.PostGuidance="post-guidance",n.CommentGuidance="comment-guidance"}(d||(d={})),function(n){n.Edit="edit",n.Preset="preset",n.New="new",n.Recommendation="recommendation"}(C||(C={})),function(n){n.KeywordsInclude="Keywords-Include",n.KeywordsExclude="Keywords-Exclude",n.RegexInclude="Regex-Include",n.RegexExclude="Regex-Exclude",n.UrlInclude="Url-Include",n.UrlExclude="Url-Exclude",n.UrlDomainInclude="UrlDomain-Include",n.UrlDomainExclude="UrlDomain-Exclude"}(m||(m={})),function(n){n.HasAnyUserFlair="BooleanUserFlair-Include",n.HasNoUserFlair="BooleanUserFlair-Exclude",n.HasSpecificUserFlair="SpecificUserFlair-Include",n.HasNoSpecificUserFlair="SpecificUserFlair-Exclude"}(p||(p={})),function(n){n.CHANGE_FLAIR="automation-preview-user-flair-picker:change-flair",n.REQUEST_FLAIR="automation-preview-user-flair-picker:request-flair",n.SEND_FLAIR="automation-preview-user-flair-picker:send-flair"}(g||(g={})),function(n){n.LIVE_PREVIEW="live-preview"}(f||(f={}));const x=()=>({booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:{features:[n.dp.PostTitle,n.dp.PostBody],values:[]},stringExactMatchCondition:null}),E={trigger:n.dn.Post,postType:l.Text,condition:x()},h=n=>{switch(n.__typename){case"AutomationRegexCondition":return{regexCondition:n,booleanCondition:null,compositeCondition:null,notCondition:null,stringCondition:null,stringExactMatchCondition:null};case"AutomationStringCondition":return{stringCondition:n,booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringExactMatchCondition:null};case"AutomationStringExactMatchCondition":return{stringExactMatchCondition:n,booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:null};case"AutomationBooleanCondition":return{booleanCondition:{feature:n.booleanFeature,value:n.booleanValue},compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null};case"AutomationNotCondition":return{notCondition:n,booleanCondition:null,compositeCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null};case"AutomationCompositeCondition":return{compositeCondition:{children:n.children.map((n=>n?h(n):null)).filter(o.f),operator:n.operator},booleanCondition:null,notCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null};default:return{booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null}}},T=n=>n.map((n=>{switch(n.__typename){case"AutomationInformAction":return{informAction:{message:n.message??""},blockAction:null,reportAction:null};case"AutomationBlockAction":return{blockAction:{message:n.message??""},informAction:null,reportAction:null};case"AutomationReportAction":return{reportAction:{message:n.message??""},informAction:null,blockAction:null};default:return}}),[]).filter(o.f),A=(n,t)=>{const e=h(t.condition);return e.compositeCondition?.children&&(e.compositeCondition.children=e.compositeCondition.children.filter(o.f).map((n=>{const{compositeCondition:o,...t}=n;return t}))),{subredditId:n,name:t.name,trigger:t.trigger,condition:e,actions:T(t.actions)}},y=o=>{if(o.length>1)return u.PostTitleAndPostBody;if(1===o.length)switch(o[0]){case n.dp.PostBody:return u.PostBody;case n.dp.PostTitle:return u.PostTitle;case n.dp.CommentBody:return u.CommentBody;case n.dp.UserFlairTemplateId:case n.dq.HasUserFlair:return u.UserFlair}return u.PostTitleAndPostBody},P=o=>{switch(o){case n.dp.PostBody:case n.dp.PostTitle:return i.Post;case n.dp.CommentBody:return i.Comment;case n.dp.UserFlairTemplateId:case n.dq.HasUserFlair:return i.User;default:return i.Post}},U=o=>{switch(o){case n.dp.UserFlairTemplateId:return r.SpecificUserFlair;case n.dq.HasUserFlair:return r.BooleanUserFlair;default:return}},I=(n,o)=>({conditionTarget:P(n.features[0]),filterType:o,phrases:n.values,locationType:y(n.features),phraseType:r.Keywords}),B=(n,o)=>({conditionTarget:P(n.features[0]),filterType:o,regex:n.value,isCaseSensitive:n.isCaseSensitive??!1,locationType:y(n.features),phraseType:r.Regex}),M=(n,o)=>({conditionTarget:P(n.feature),filterType:o,phrases:n.values,locationType:y([n.feature]),phraseType:U(n.feature)??r.SpecificUserFlair}),F=n=>Object.values(d).includes(n),R=(n,o)=>n.reduce(((n,t)=>{const{contentMessages:e}=t,i=e?.filter((n=>n.stringFeature===o));return i&&i.length>0&&n.push({...t,contentMessages:i}),n}),[])??[],{svg:v}=n.a(),b=n.m(v`<path d="M15.7 5H15v-.7C15 2.48 13.52 1 11.7 1H4.3C2.48 1 1 2.48 1 4.3v7.4C1 13.52 2.48 15 4.3 15H5v.7C5 17.52 6.48 19 8.3 19h7.4c1.82 0 3.3-1.48 3.3-3.3V8.3C19 6.48 17.52 5 15.7 5zM4.3 13.2c-.83 0-1.5-.67-1.5-1.5V4.3c0-.83.67-1.5 1.5-1.5h7.4c.83 0 1.5.67 1.5 1.5V5H8.3C6.48 5 5 6.48 5 8.3v4.9h-.7zm2.69 3.22l2.24-2.24c.5-.5 1.31-.5 1.81 0l3.03 3.02H8.3c-.57 0-1.05-.32-1.31-.78zm10.21-.72c0 .56-.32 1.05-.78 1.31l-4.1-4.1a3.09 3.09 0 00-4.36 0L6.8 14.07V8.31c0-.83.67-1.5 1.5-1.5h7.4c.83 0 1.5.67 1.5 1.5v7.39z"></path><path d="M14 11.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"></path>`,"0 0 20 20","gallery");return{get A(){return f},get B(){return C},C:"Untitled Rule",D:E,E:o=>{switch(o){case d.CommentGuidance:return n.dn.Comment;case d.PostGuidance:default:return n.dn.Post}},get F(){return e},G:n=>{switch(n){case"AutomationBlockOutcome":return a.Block;case"AutomationInformOutcome":return a.Inform;case"AutomationReportOutcome":return a.Report;default:return null}},H:(o,e)=>{switch(e){case t.P.Title:return R(o,n.dp.PostTitle);case t.P.Body:case t.P.OptionalBody:return R(o,n.dp.PostBody)}return[]},get a(){return g},get b(){return l},c:(n,o)=>({automationId:o.id,status:o.status,...A(n,o)}),d:A,e:()=>{const n=new URL(window.location.href).searchParams.get(c);if(n&&F(n))return n},f:c,g:b,h:n=>n.some((({__typename:n})=>"AutomationBlockOutcome"===n)),i:n=>n&&""!==n&&F(n)?`?${c}=${n}`:"",get j(){return d},k:h,l:T,m:o=>{switch(o){case n.dn.Post:return d.PostGuidance;case n.dn.Comment:return d.CommentGuidance;default:return""}},get n(){return p},get o(){return r},get p(){return s},get q(){return m},get r(){return u},get s(){return i},get t(){return a},u:({stringCondition:n,regexCondition:o,notCondition:t,booleanCondition:e,stringExactMatchCondition:i})=>n?I(n,s.Include):o?B(o,s.Include):e?(n=>({conditionTarget:P(n.feature),filterType:n.value?s.Include:s.Exclude,locationType:y([n.feature])??u.UserFlair,phraseType:U(n.feature)??r.BooleanUserFlair}))(e):i?M(i,s.Include):t?(n=>n.stringCondition?I(n.stringCondition,s.Exclude):n.regexCondition?B(n.regexCondition,s.Exclude):n.stringExactMatchCondition?M(n.stringExactMatchCondition,s.Exclude):null)(t):null,v:({phraseType:o,locationType:t,filterType:e,phrases:i,regex:l,isCaseSensitive:a=!1})=>{const c=(o=>{switch(o){case u.PostTitleAndPostBody:return[n.dp.PostBody,n.dp.PostTitle];case u.PostBody:return[n.dp.PostBody];case u.PostTitle:return[n.dp.PostTitle];case u.PostUrl:return[n.dp.PostUrl];case u.CommentBody:return[n.dp.CommentBody];case u.UserFlair:return[n.dp.UserFlairTemplateId];default:return[]}})(t);switch(o){case r.Regex:{const n={features:c,value:l??"",isCaseSensitive:a};return e===s.Include?{regexCondition:n,booleanCondition:null,compositeCondition:null,notCondition:null,stringCondition:null,stringExactMatchCondition:null}:{notCondition:{regexCondition:n,stringCondition:null,stringExactMatchCondition:null},booleanCondition:null,compositeCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null}}case r.Keywords:{const n={features:c,values:i??[]};return e===s.Include?{stringCondition:n,booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringExactMatchCondition:null}:{notCondition:{stringCondition:n,regexCondition:null,stringExactMatchCondition:null},booleanCondition:null,compositeCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null}}case r.BooleanUserFlair:return{booleanCondition:{feature:n.dq.HasUserFlair,value:e===s.Include},compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null};case r.SpecificUserFlair:{const o={feature:n.dp.UserFlairTemplateId,values:i??[]};return e===s.Include?{stringExactMatchCondition:o,booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:null}:{notCondition:{stringExactMatchCondition:o,regexCondition:null,stringCondition:null},booleanCondition:null,compositeCondition:null,regexCondition:null,stringCondition:null,stringExactMatchCondition:null}}default:return null}},w:n=>n.compositeCondition?n.compositeCondition.children.filter((n=>!!n)):[n],x:o=>{switch(o){case n.dn.Comment:return{booleanCondition:null,compositeCondition:null,notCondition:null,regexCondition:null,stringCondition:{features:[n.dp.CommentBody],values:[]},stringExactMatchCondition:null};case n.dn.Post:default:return x()}},y:({informAction:n,reportAction:o,blockAction:t})=>n?{actionType:a.Inform,message:n.message}:o?{actionType:a.Report,message:o.message}:t?{actionType:a.Block,message:t.message}:null,z:({actionType:n,customMessage:o})=>{switch(n){case a.Report:return{reportAction:{message:o},blockAction:null,informAction:null};case a.Block:return{blockAction:{message:o},informAction:null,reportAction:null};case a.Inform:return{informAction:{message:o},blockAction:null,reportAction:null};default:return null}}}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("pkk--QZ7vd",["CYrPuvCiTj"],(async a=>{const{svg:h}=a.a(),c=a.m(h`<path d="M19.68 17.061c-.08.595-.695.991-1.254.771-.594-.233-.857-.517-.857-.517-.221-.207-.365-.424-.434-.65h-.025c-.266.368-.655.673-1.168.914-.512.24-1.074.36-1.686.36-.594 0-1.124-.117-1.588-.353a2.647 2.647 0 01-1.083-.977 2.613 2.613 0 01-.386-1.406c0-.555.15-1.043.454-1.465.303-.422.756-.75 1.359-.985.603-.234 1.346-.353 2.229-.353h1.546v-.407c0-.465-.126-.861-.378-1.189-.252-.328-.704-.492-1.355-.492-.42 0-.872.073-1.36.221-.193.059-.387.115-.571.173a.848.848 0 01-1.045-.505c-.166-.43.033-.928.463-1.093.247-.094.517-.181.812-.258a7.618 7.618 0 011.757-.25c1.122-.027 1.947.171 2.475.591.499.396.807.827.926 1.291.119.465.179.957.179 1.479v2.956c0 .368.04.646.119.832 0 0 .05.18.353.338a.962.962 0 01.518.974zm-4.07-.892a2.29 2.29 0 00.91-.629c.247-.28.37-.618.37-1.015v-.68h-1.648c-.634 0-1.146.104-1.537.314-.391.209-.586.538-.586.985 0 .379.139.679.417.9.277.221.625.331 1.044.331.329 0 .672-.069 1.032-.208l-.001.002zm-5.924 1.732a.916.916 0 01-.886-.66l-1.003-3.562H3.489l-.983 3.56a.915.915 0 01-.886.662c-.608 0-1.05-.568-.885-1.14L4.69 2.954a.991.991 0 01.956-.706c.444 0 .834.288.956.705L10.57 16.76c.165.573-.276 1.141-.885 1.141zm-4.01-12.2h-.06l-1.742 6.371h3.56L5.677 5.7z"></path>`,"0 0 20 20","format"),{svg:l}=a.a(),t=a.m(l`<path d="M18 5.301V14.7c0 1.82-1.48 3.301-3.3 3.301H5.301A3.304 3.304 0 012 14.7v-4.499c.429.262.913.4 1.4.4.12 0 .238-.018.357-.034.013.021.031.037.044.057V14.7c0 .827.673 1.5 1.5 1.5h9.4c.827 0 1.499-.673 1.499-1.5V5.301a1.5 1.5 0 00-1.223-1.472 2.656 2.656 0 00-.276-.337L13.21 2.001h1.491c1.819 0 3.3 1.48 3.3 3.301L18 5.301zM6.93 9.337l1.594-7.5a.899.899 0 10-1.759-.375l-1.594 7.5a.899.899 0 101.759.375zm-2.893-.801a.9.9 0 000-1.273L2.173 5.4l1.864-1.863a.9.9 0 10-1.273-1.273l-2.5 2.499a.9.9 0 000 1.273l2.5 2.5a.897.897 0 001.273 0zm9.392-2.5a.9.9 0 000-1.273l-2.5-2.5a.9.9 0 10-1.273 1.273l1.864 1.863-1.864 1.863a.9.9 0 101.274 1.273l2.499-2.499z"></path>`,"0 0 20 20","code-block"),{svg:z}=a.a(),m=a.m(z`<path d="M19 2.9a.9.9 0 01-.9.9h-4.251v13.3a.9.9 0 01-1.8 0V3.8H7.9a.9.9 0 010-1.8h10.2a.9.9 0 01.9.9zM9.1 8H2.9a.9.9 0 000 1.8h2.18v7.3a.9.9 0 001.8 0V9.8h2.221A.9.9 0 109.1 8z"></path>`,"0 0 20 20","text-size"),{svg:v}=a.a(),p=a.m(v`<path d="M18 5.3C18 3.48 16.52 2 14.7 2H5.3C3.48 2 2 3.48 2 5.3v9.4C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V5.3zm-3.3-1.5c.83 0 1.5.67 1.5 1.5v1.9H9V3.8h5.7zm-9.4 0h1.9v3.4H3.8V5.3c0-.83.67-1.5 1.5-1.5zM3.8 14.7V9h3.4v7.2H5.3c-.83 0-1.5-.67-1.5-1.5zm12.4 0c0 .83-.67 1.5-1.5 1.5H9V9h7.2v5.7z"></path>`,"0 0 20 20","table"),{svg:H}=a.a(),M=a.m(H`<path d="M17 5.9H3a.9.9 0 010-1.8h14a.9.9 0 010 1.8zm.9 9.1a.9.9 0 00-.9-.9H3a.9.9 0 100 1.8h14a.9.9 0 00.9-.9zm-3.5-5a.9.9 0 00-.9-.9h-7a.9.9 0 100 1.8h7a.9.9 0 00.9-.9z"></path>`,"0 0 20 20","align-center"),{svg:s}=a.a(),g=a.m(s`<path d="M17 5.9H3a.9.9 0 010-1.8h14a.9.9 0 010 1.8zM10.9 10a.9.9 0 00-.9-.9H3a.9.9 0 100 1.8h7a.9.9 0 00.9-.9zm7 5a.9.9 0 00-.9-.9H3a.9.9 0 100 1.8h14a.9.9 0 00.9-.9z"></path>`,"0 0 20 20","align-left"),{svg:L}=a.a(),d=a.m(L`<path d="M17 5.9H3a.9.9 0 010-1.8h14a.9.9 0 010 1.8zm.9 9.1a.9.9 0 00-.9-.9H3a.9.9 0 100 1.8h14a.9.9 0 00.9-.9zm0-5a.9.9 0 00-.9-.9h-7a.9.9 0 100 1.8h7a.9.9 0 00.9-.9z"></path>`,"0 0 20 20","align-right"),{svg:e}=a.a(),r=a.m(e`<path d="M8.1 4a.9.9 0 01.9-.9h7.999a.9.9 0 010 1.8h-8a.9.9 0 01-.9-.9zM17 15.1H9a.9.9 0 000 1.8h8a.9.9 0 000-1.8zm0-6H9a.9.9 0 000 1.8h8a.9.9 0 000-1.8zM3.18 4.12l.025-.012v3.026a.817.817 0 001.632 0v-4.58a.504.504 0 00-.712-.459l-1.537.702a.726.726 0 00-.094 1.266.723.723 0 00.688.055l-.001.001zm2.09 12.361l-.32.002a4.928 4.928 0 00-.937.091l-.024-.055a4.454 4.454 0 001.47-1.267l.039-.051a2.95 2.95 0 00.337-.622c.093-.232.14-.477.14-.726 0-.352-.09-.669-.267-.943a1.77 1.77 0 00-.723-.641 2.225 2.225 0 00-1.002-.221c-.432.013-.805.089-1.127.27-.32.181-.57.428-.736.727l-.03.056a.794.794 0 00.13.916c.247.259.615.319.963.156a.652.652 0 00.328-.365l.02-.048a.423.423 0 01.167-.179c.168-.101.436-.085.572.048a.383.383 0 01.114.296.644.644 0 01-.08.329c-.416.74-.962 1.252-1.445 1.705a8.287 8.287 0 00-.662.668.786.786 0 00-.107.843.815.815 0 00.744.481h2.434a.733.733 0 000-1.468l.002-.002z"></path>`,"0 0 20 20","list-numbered",!0),{svg:V}=a.a(),i=a.m(V`<path d="M5.83 7.435a4.11 4.11 0 01-.26-1.473 3.906 3.906 0 01.547-2.077A3.65 3.65 0 017.647 2.5a5.027 5.027 0 012.267-.489 4.888 4.888 0 012.837.8c.46.312.866.698 1.2 1.143a.79.79 0 01-.366 1.188 1.391 1.391 0 01-1.43-.457 3.435 3.435 0 00-.968-.674A3 3 0 008.7 4c-.37.171-.686.442-.912.782A2.132 2.132 0 007.441 6a2.299 2.299 0 00.454 1.441L5.83 7.435zM18 8.998H2a.9.9 0 100 1.799h8.4c.3.116.565.227.791.332.469.23.89.545 1.243.928a2.199 2.199 0 01.611 1.583c.005.478-.134.947-.4 1.345a2.74 2.74 0 01-1.068.938 3.243 3.243 0 01-2.9-.005 3.447 3.447 0 01-1.126-.928 4.062 4.062 0 01-.34-.5.951.951 0 10-1.632.975 5.666 5.666 0 002.344 2.043c.701.334 1.47.505 2.246.5a5.052 5.052 0 002.353-.562 4.48 4.48 0 001.743-1.578 4.136 4.136 0 00.653-2.288 3.628 3.628 0 00-.781-2.39 6.709 6.709 0 00-.351-.39h4.213a.902.902 0 000-1.802z"></path>`,"0 0 20 20","strikethrough"),{svg:n}=a.a();return{a:p,b:g,c:t,d:M,e:d,f:a.m(n`<path d="M8.215 9.992v.086l4.314 6.384a.958.958 0 01-1.247 1.377.955.955 0 01-.345-.318L6.992 11.5h-.086l-3.944 6.021a.955.955 0 01-1.755-.574.957.957 0 01.162-.485l4.314-6.384v-.086L1.388 3.549a.908.908 0 111.517-.997l4 6.174h.086l4-6.174a.909.909 0 111.517.997L8.215 9.992zm10.12-2.807h-1.109l-.54.022.68-.843c.27-.331.471-.593.62-.8.153-.218.28-.453.38-.7a2.11 2.11 0 00.155-.8 1.9 1.9 0 00-.29-1.042 1.965 1.965 0 00-.8-.7 2.4 2.4 0 00-1.14-.25 2.575 2.575 0 00-1.218.282c-.348.183-.637.46-.835.8a2.472 2.472 0 00-.238.712.693.693 0 00.15.578.8.8 0 00.616.281 1.08 1.08 0 00.943-.8.616.616 0 01.235-.253.687.687 0 01.342-.09.611.611 0 01.424.161.532.532 0 01.158.403.988.988 0 01-.1.43c-.079.169-.174.33-.284.48-.117.16-.274.365-.467.6-.119.148-.208.259-.265.334l-1.368 1.701A.622.622 0 0014.87 8.7h3.466a.758.758 0 000-1.515z"></path>`,"0 0 20 20","superscript"),g:c,l:r,s:i,t:m}}));