SML.di("./C-PXJvnKib.js",import.meta.url,"C-PXJvnKib");SML.di("./Dr6iqxLOkn.js",import.meta.url,"Dr6iqxLOkn");SML.di("./DbMJq2WLcl.js",import.meta.url,"DbMJq2WLcl");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./Bq3qdqopCU.js",import.meta.url,"Bq3qdqopCU");SML.di("./nfXvUbiTZI.js",import.meta.url,"nfXvUbiTZI");SML.di("./DuqlmJMEve.js",import.meta.url,"DuqlmJMEve");SML.di("./D-loTAz0IJ.js",import.meta.url,"D-loTAz0IJ");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./hrqH5pRvGY.js",import.meta.url,"hrqH5pRvGY");SML.di("./D0lCIVsZym.js",import.meta.url,"D0lCIVsZym");SML.di("./CPEjWpDINz.js",import.meta.url,"CPEjWpDINz");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./Bu_0OLU9_w.js",import.meta.url,"Bu_0OLU9_w");SML.di("./buPlOxYAo2.js",import.meta.url,"buPlOxYAo2");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");SML.di("./DdQ8ToexAC.js",import.meta.url,"DdQ8ToexAC");SML.di("./CEkHpZAUVH.js",import.meta.url,"CEkHpZAUVH");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./CZtlI9NlXS.js",import.meta.url,"CZtlI9NlXS");SML.di("./Bu5yqfYL_w.js",import.meta.url,"Bu5yqfYL_w");SML.di("./NMIRxeD8JS.js",import.meta.url,"NMIRxeD8JS");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");SML.di("./DijGP8Hw3G.js",import.meta.url,"DijGP8Hw3G");SML.di("./Cke4oMIXaE.js",import.meta.url,"Cke4oMIXaE");SML.di("./DJaop39KNp.js",import.meta.url,"DJaop39KNp");SML.di("./BnnXQUvIiN.js",import.meta.url,"BnnXQUvIiN");SML.di("./DEMzfTzoPS.js",import.meta.url,"DEMzfTzoPS");SML.di("./CXJ58rbE8s.js",import.meta.url,"CXJ58rbE8s");SML.di("./D1jB1lRGDu.js",import.meta.url,"D1jB1lRGDu");SML.di("./B9Z38jXwJn.js",import.meta.url,"B9Z38jXwJn");SML.di("./GAfaH20Chw.js",import.meta.url,"GAfaH20Chw");SML.di("./HQokY_KEgH.js",import.meta.url,"HQokY_KEgH");SML.di("./BBSbW5jO-u.js",import.meta.url,"BBSbW5jO-u");SML.di("./BIlQ5upx3L.js",import.meta.url,"BIlQ5upx3L");SML.di("./CMNh7Qm-HC.js",import.meta.url,"CMNh7Qm-HC");SML.di("./CA7qO1Exxg.js",import.meta.url,"CA7qO1Exxg");SML.di("./zQvYWz_gjh.js",import.meta.url,"zQvYWz_gjh");SML.di("./CkEEx5T_uL.js",import.meta.url,"CkEEx5T_uL");SML.di("./BoQssu-hw1.js",import.meta.url,"BoQssu-hw1");SML.di("./BKIc7C4NNc.js",import.meta.url,"BKIc7C4NNc");
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("0oWl-8XRpj",["CYrPuvCiTj"],(async e=>{let t=class extends e.s{constructor(){super(...arguments),this.country="",this.onClick=()=>{this.confirmOver18()},this.onKeyPress=e=>{"Enter"!==e.key&&"Space"!==e.key||this.confirmOver18()}}redirect(e){window.location.href=e.toString()}refreshAndRememberSEO(){const t=new URL(window.location.href);t.searchParams.set(e.a$,"1"),this.redirect(t)}setOver18Cookie(){e.ao({country:this.country,name:e.b0,value:"true",options:e.b1})}async confirmOver18(){e.g()?await e.ag({operation:e.af.UpdateProfileSettings,variables:{input:{isNsfw:!0}}}):this.setOver18Cookie(),this.refreshAndRememberSEO()}render(){return e.x`<slot @click="${this.onClick}" @keypress="${this.onKeyPress}"></slot>`}};t.styles=[e.t],e._([e.n({type:String})],t.prototype,"country",void 0),t=e._([e.e("confirm-over-18")],t);e.b("icon-nsfw",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 19a3.29 3.29 0 01-2.333-.965l-5.702-5.702a3.304 3.304 0 010-4.666l5.701-5.702a3.303 3.303 0 014.668 0l5.701 5.702a3.304 3.304 0 010 4.666l-5.701 5.702A3.292 3.292 0 019.998 19H10zm0-16.2c-.383 0-.768.145-1.06.437L3.24 8.94a1.502 1.502 0 000 2.122l5.702 5.702a1.501 1.501 0 002.12 0l5.703-5.702a1.502 1.502 0 000-2.122l-5.702-5.702a1.496 1.496 0 00-1.06-.438H10zM5.834 7.74l-.029.013v1.44l1.23-.545v4.64H8.57V6.711h-.476L5.833 7.74v.001zm8.33 2.751a1.994 1.994 0 00-.665-.638 1.846 1.846 0 00.615-1.381c0-.364-.096-.688-.285-.964a1.884 1.884 0 00-.768-.643 2.45 2.45 0 00-1.05-.227c-.377 0-.73.075-1.051.224a1.906 1.906 0 00-.775.641 1.65 1.65 0 00-.292.965c0 .28.059.545.176.791.107.226.255.425.439.594a1.973 1.973 0 00-.665.641A1.708 1.708 0 009.89 12.4c.21.296.503.533.87.704.367.171.784.257 1.242.257.45 0 .865-.085 1.23-.252a2.15 2.15 0 00.873-.7c.212-.298.319-.634.319-1 0-.333-.088-.642-.264-.917h.003zm-1.338 1.236a.844.844 0 01-.336.282c-.147.07-.305.105-.482.105-.175 0-.335-.034-.48-.1a.836.836 0 01-.342-.279.68.68 0 01-.126-.402.7.7 0 01.123-.405.851.851 0 01.335-.293c.145-.072.31-.109.49-.109.183 0 .347.037.486.11a.83.83 0 01.332.292.72.72 0 010 .8zm-.131-2.757a.733.733 0 01-.284.272.823.823 0 01-.403.1.834.834 0 01-.406-.1.743.743 0 01-.284-1.029.698.698 0 01.285-.257.888.888 0 01.403-.092c.147 0 .284.031.404.092.121.06.214.144.284.256a.708.708 0 01.103.376.743.743 0 01-.103.383z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M12.823 10.928a.72.72 0 010 .799.844.844 0 01-.337.282c-.146.07-.304.105-.482.105a1.13 1.13 0 01-.479-.101.836.836 0 01-.343-.278.68.68 0 01-.125-.402.7.7 0 01.123-.405.852.852 0 01.335-.293c.144-.072.31-.11.49-.11.182 0 .346.038.486.11a.83.83 0 01.332.293zm-1.225-1.686c.12.066.257.1.406.1a.823.823 0 00.405-.1.733.733 0 00.385-.655.699.699 0 00-.103-.376.675.675 0 00-.283-.256.889.889 0 00-.403-.092.888.888 0 00-.404.092.698.698 0 00-.39.632.734.734 0 00.389.654h-.002zm6.437 3.09l-5.703 5.703A3.291 3.291 0 0110 19c-.844 0-1.69-.322-2.333-.965l-5.704-5.702a3.304 3.304 0 010-4.666l5.703-5.702a3.303 3.303 0 014.666 0l5.703 5.702a3.304 3.304 0 010 4.666zm-9.941-5.62L5.832 7.739l-.03.013v1.44l1.23-.545v4.64H8.57V6.71h-.475zm6.33 4.697c0-.333-.088-.642-.263-.917a1.996 1.996 0 00-.665-.638 1.86 1.86 0 00.615-1.382c0-.363-.097-.687-.286-.963a1.884 1.884 0 00-.766-.643 2.45 2.45 0 00-1.05-.227c-.377 0-.732.075-1.053.224a1.906 1.906 0 00-.774.64 1.65 1.65 0 00-.292.966c0 .279.059.545.175.79.107.227.255.426.44.595a1.974 1.974 0 00-.665.64 1.708 1.708 0 00.048 1.907c.209.296.502.533.87.704.367.17.784.257 1.24.257.45 0 .866-.085 1.232-.252a2.15 2.15 0 00.872-.7c.211-.298.319-.634.319-1l.003-.001z"/></svg>')}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./B58tzg41t5.js",import.meta.url,"B58tzg41t5");SML.di("./BJdHdrH8mb.js",import.meta.url,"BJdHdrH8mb");SML.di("./BFQMud8FSN.js",import.meta.url,"BFQMud8FSN");SML.di("./tXzIaFuSwM.js",import.meta.url,"tXzIaFuSwM");SML.di("./LX29t1LiDK.js",import.meta.url,"LX29t1LiDK");SML.di("./DcxJbk2B3f.js",import.meta.url,"DcxJbk2B3f");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./D4Ab94OqLr.js",import.meta.url,"D4Ab94OqLr");SML.di("./BG_G1Cif8U.js",import.meta.url,"BG_G1Cif8U");SML.di("./CrgF_JGUIv.js",import.meta.url,"CrgF_JGUIv");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");
SML.dm("3iWYwwyrQS",["CYrPuvCiTj","LX29t1LiDK","B58tzg41t5","BJdHdrH8mb","BFQMud8FSN","tXzIaFuSwM","DcxJbk2B3f","wzdls1o9Kk","D4Ab94OqLr","BG_G1Cif8U","CrgF_JGUIv","nZA40q2akY"],(async(e,o)=>{let t=class extends e.s{constructor(){super(...arguments),this.isUiModernizationEnabled=!1,this.isDropdownOpen=!1,this.onDropdownClose=()=>this.isDropdownOpen=!1,this.onDropdownOpen=()=>this.isDropdownOpen=!0,this.closeDropdownMenu=()=>this.dropdownMenu?.close(),this.onKeyUp=e=>{"Enter"!==e.key&&"Escape"!==e.key||this.closeDropdownMenu()}}static get styles(){return[e.t]}connectedCallback(){super.connectedCallback(),this.dropdownMenu?.hasAttribute("hidden")&&this.isDropdownOpen&&this.onDropdownClose()}disconnectedCallback(){super.disconnectedCallback()}show(){this.isUiModernizationEnabled?this.faceplateSelectButton?.dropdownMenu?.show():this.dropdownMenu?.show()}render(){return this.isUiModernizationEnabled?e.x`<faceplate-select-button> ${o.s({"aria-expanded":this.isDropdownOpen?"true":"false"},this.isUiModernizationEnabled)} <slot name="dropdown-items"></slot> </faceplate-select-button>`:e.x`<faceplate-dropdown-menu class="nd:hidden" .onopen="${this.onDropdownOpen}" .onclose="${this.onDropdownClose}"> ${o.s({"aria-expanded":this.isDropdownOpen?"true":"false"},this.isUiModernizationEnabled)} <faceplate-menu slot="menu" class="overflow-y-auto max-h-[50vh]" hidden> <slot name="dropdown-items" @click="${this.closeDropdownMenu}" @keyup="${this.onKeyUp}"></slot> </faceplate-menu> </faceplate-dropdown-menu>`}};e._([e.Y("faceplate-dropdown-menu")],t.prototype,"dropdownMenu",void 0),e._([e.Y("faceplate-select-button")],t.prototype,"faceplateSelectButton",void 0),e._([e.n({type:Boolean,attribute:"is-ui-modernization-enabled"})],t.prototype,"isUiModernizationEnabled",void 0),e._([e.j()],t.prototype,"isDropdownOpen",void 0),t=e._([e.e("search-sort-dropdown-menu")],t)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("B41bwkZWe9",["CYrPuvCiTj"],(async e=>{let t=class extends e.s{constructor(){super(...arguments),this.noun=""}get dataFaceplateTrackingContext(){const{search:t,action_info:r,subreddit:a,user_preferences:c,post:n,profile:s}=e.gB(null)||{};return{search:t,action_info:r,subreddit:a,user_preferences:c,post:n,profile:s}}firstUpdated(){this.tracker?.trackEvent?.()}render(){return e.x`<faceplate-tracker source="search" action="load" noun="${this.noun}" data-faceplate-tracking-context="${JSON.stringify(this.dataFaceplateTrackingContext)}" data-testid="nested-faceplate-tracker"> </faceplate-tracker>`}};e._([e.n({type:String})],t.prototype,"noun",void 0),e._([e.Y("faceplate-tracker")],t.prototype,"tracker",void 0),t=e._([e.e("search-load-tracker")],t)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./BJdHdrH8mb.js",import.meta.url,"BJdHdrH8mb");SML.di("./D4Ab94OqLr.js",import.meta.url,"D4Ab94OqLr");SML.di("./CrgF_JGUIv.js",import.meta.url,"CrgF_JGUIv");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./B58tzg41t5.js",import.meta.url,"B58tzg41t5");
SML.dm("BFQMud8FSN",["CYrPuvCiTj","D4Ab94OqLr","CrgF_JGUIv","wzdls1o9Kk","BJdHdrH8mb","B58tzg41t5"],(async(e,t,l,i)=>{let s=class extends t.F{constructor(){super(...arguments),this.label="",this.multiple=!1,this.multipleText="",this.emitter=i.n(this),this._selectController=new l.S(this),this.syncSelectButtonText=()=>{let e=this.label;if(this.value){e=this.multiple&&this.selectedOptions.length>1&&this.multipleText?this.multipleText:this.selectedOptions.map((e=>e.displayText))?.join(", ")}const t=this.triggerSlot[0]?.querySelector("#select-button-text");null!=t&&t.innerText!==e&&(t.innerText=e??"")},this.focus=()=>{this.referenceElement?.focus()}}get referenceElement(){return this.triggerSlot[0]}get selectedOptions(){return this._selectController.selectedOptions}get selectedIndex(){return this._selectController.selectedIndex}get value(){return this._selectController.value}set value(e){e!==this.value&&(this._selectController.value=e)}updated(){this.syncSelectButtonText()}static get styles(){return e.i`:host{display:inline-block}::slotted([slot=trigger]){display:inline-flex;justify-content:space-between!important}faceplate-menu{height:var(--faceplate-select-menu-height,auto);width:var(--faceplate-select-menu-width,auto);overflow:auto}`}associateTrigger(){this.referenceElement&&this.dropdownMenu?._popperController.updateOptions({reference:this.referenceElement})}render(){return e.x`<faceplate-dropdown-menu ?disabled="${this.disabled}" position="bottom-start" manual-trigger-focus> <slot name="trigger" slot="" @slotchange="${this.associateTrigger}"></slot> <faceplate-menu slot="menu" id="menu" ariarole="listbox" faceplate-popper-content> <slot></slot> </faceplate-menu> </faceplate-dropdown-menu>`}};s.selectButton=({label:t,selected:i,attributes:s,...o})=>e.u({...o,shape:"pill",attributes:{...s,className:`${s?.className??""} gap-2xs grow`},hideChildrenOverflow:!0,children:e.x`<span id="select-button-text" class="overflow-hidden text-ellipsis">${t&&!i?t:""}</span>`,trailingIcon:l.i({attributes:{"aria-hidden":"true"}})}),e._([e.n({type:String})],s.prototype,"label",void 0),e._([e.n({type:Boolean})],s.prototype,"multiple",void 0),e._([e.n({type:String,attribute:"multiple-text"})],s.prototype,"multipleText",void 0),e._([e.r()],s.prototype,"options",void 0),e._([e.r({selector:"faceplate-option:not([hidden])"})],s.prototype,"visibleOptions",void 0),e._([e.r({slot:"trigger"})],s.prototype,"triggerSlot",void 0),e._([e.Y("faceplate-dropdown-menu")],s.prototype,"dropdownMenu",void 0),s=e._([e.e("faceplate-select-button")],s)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("Bu5yqfYL_w",["CYrPuvCiTj"],(async c=>{const{svg:a}=c.a();return{p:c.m(a`<path d="M15.802 3.188c-1.09-.058-2.723-.243-4.304-1.17a2.967 2.967 0 00-2.998 0c-1.581.927-3.214 1.112-4.305 1.17-1.22.066-2.175 1.063-2.175 2.27v4.845c0 4.485 4.023 7.528 7.76 8.458a.896.896 0 00.437 0c3.736-.93 7.76-3.974 7.76-8.458V5.458c0-1.207-.954-2.203-2.175-2.27zm-5.803 13.77V10H3.822V5.458c0-.251.206-.458.47-.473 1.278-.07 3.198-.29 5.118-1.415.185-.108.387-.162.589-.162V10h6.176v.303c0 3.436-3.16 5.83-6.176 6.655z"></path>`,"0 0 20 20","premium-fill")}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("C-PXJvnKib",["CYrPuvCiTj"],(async e=>{let t=class extends e.s{constructor(){super(...arguments),this.inputSelector=e.y.HeaderLarge}static get styles(){return[e.t]}get focusSearchInput(){return{[e.y.HeaderSmall]:document.querySelector(this.inputSelector)?.handleToggleSearchDialog,[e.y.HeaderLarge]:document.querySelector(this.inputSelector)?.focusSearchInput,[e.y.PdpCommentSearchInput]:document.querySelector(this.inputSelector)?.focusSearchInput,[e.y.SearchInputSmall]:document.querySelector(this.inputSelector)?.focusSearchInput}[this.inputSelector]}onClick(e){e.preventDefault(),e.stopPropagation(),this.focusSearchInput?.()}render(){return e.x`<a class="text-primary no-visited" href="#" @click="${this.onClick}"><slot></slot></a>`}};e._([e.n({attribute:"input-selector",type:String})],t.prototype,"inputSelector",void 0),t=e._([e.e("adjust-search-query-link")],t)}));
SML.di("./CZtlI9NlXS.js",import.meta.url,"CZtlI9NlXS");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");
SML.di("./DuqlmJMEve.js",import.meta.url,"DuqlmJMEve");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CZtlI9NlXS.js",import.meta.url,"CZtlI9NlXS");SML.di("./BA-YMBSJ68.js",import.meta.url,"BA-YMBSJ68");SML.di("./C1SFSFuxmZ.js",import.meta.url,"C1SFSFuxmZ");SML.di("./Cke4oMIXaE.js",import.meta.url,"Cke4oMIXaE");SML.di("./K2R-k6uMNv.js",import.meta.url,"K2R-k6uMNv");SML.di("./CA_3X1MrHP.js",import.meta.url,"CA_3X1MrHP");SML.di("./CVt1u3m_U2.js",import.meta.url,"CVt1u3m_U2");SML.di("./D9WsnGY-GI.js",import.meta.url,"D9WsnGY-GI");SML.di("./DJJ9sof-xv.js",import.meta.url,"DJJ9sof-xv");SML.di("./BcLz9SQAFR.js",import.meta.url,"BcLz9SQAFR");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./BEcPDyVyFQ.js",import.meta.url,"BEcPDyVyFQ");SML.di("./CCzrQmnfhp.js",import.meta.url,"CCzrQmnfhp");SML.di("./By2sopqXTk.js",import.meta.url,"By2sopqXTk");SML.di("./hgVDyxZ2rL.js",import.meta.url,"hgVDyxZ2rL");SML.di("./COfLy9zygd.js",import.meta.url,"COfLy9zygd");SML.di("./gMEDXxO5ap.js",import.meta.url,"gMEDXxO5ap");SML.di("./D2VJiRUxKq.js",import.meta.url,"D2VJiRUxKq");SML.di("./BDMOQ0-Tf9.js",import.meta.url,"BDMOQ0-Tf9");SML.di("./vhsAG6S_0w.js",import.meta.url,"vhsAG6S_0w");SML.di("./3jd2bjBQv5.js",import.meta.url,"3jd2bjBQv5");SML.di("./DdQ8ToexAC.js",import.meta.url,"DdQ8ToexAC");SML.di("./CsnZoaUuMa.js",import.meta.url,"CsnZoaUuMa");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./CEkHpZAUVH.js",import.meta.url,"CEkHpZAUVH");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./B7CRAos5Iy.js",import.meta.url,"B7CRAos5Iy");SML.di("./BJdHdrH8mb.js",import.meta.url,"BJdHdrH8mb");SML.di("./CXOS1kNFW2.js",import.meta.url,"CXOS1kNFW2");SML.di("./CVN1JN5P6I.js",import.meta.url,"CVN1JN5P6I");SML.di("./tXzIaFuSwM.js",import.meta.url,"tXzIaFuSwM");SML.di("./DcxJbk2B3f.js",import.meta.url,"DcxJbk2B3f");SML.di("./Cup7YLVD71.js",import.meta.url,"Cup7YLVD71");SML.di("./CZSZx8Z9nd.js",import.meta.url,"CZSZx8Z9nd");SML.di("./BNhmBC31Qc.js",import.meta.url,"BNhmBC31Qc");SML.di("./Cv4uyJM28X.js",import.meta.url,"Cv4uyJM28X");SML.di("./q5XTF3XWlp.js",import.meta.url,"q5XTF3XWlp");SML.di("./hz18Vlqikv.js",import.meta.url,"hz18Vlqikv");SML.di("./BaesuPO9Of.js",import.meta.url,"BaesuPO9Of");SML.di("./DcFz6mYbCk.js",import.meta.url,"DcFz6mYbCk");SML.di("./DkidhsLweq.js",import.meta.url,"DkidhsLweq");SML.di("./C7tY_fu9Em.js",import.meta.url,"C7tY_fu9Em");SML.di("./DDqgWwsuds.js",import.meta.url,"DDqgWwsuds");SML.di("./Bov9e_IWR8.js",import.meta.url,"Bov9e_IWR8");SML.di("./DSIyHwStgC.js",import.meta.url,"DSIyHwStgC");SML.di("./DiH4zLRIso.js",import.meta.url,"DiH4zLRIso");SML.di("./eBJPTvxH2_.js",import.meta.url,"eBJPTvxH2_");SML.di("./B5hztqUCve.js",import.meta.url,"B5hztqUCve");SML.di("./CiSu63MOrp.js",import.meta.url,"CiSu63MOrp");SML.di("./BgHhDaqVOR.js",import.meta.url,"BgHhDaqVOR");SML.di("./BTXMyvabmU.js",import.meta.url,"BTXMyvabmU");SML.di("./DJaop39KNp.js",import.meta.url,"DJaop39KNp");SML.di("./DwBbT5sc7p.js",import.meta.url,"DwBbT5sc7p");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");SML.di("./B6C_8s9j0g.js",import.meta.url,"B6C_8s9j0g");SML.di("./BpkEtnKDO3.js",import.meta.url,"BpkEtnKDO3");SML.di("./B5-3_kcphz.js",import.meta.url,"B5-3_kcphz");
SML.di("./BNRfi4XN6P.js",import.meta.url,"BNRfi4XN6P");SML.di("./i6yXqnjJFw.js",import.meta.url,"i6yXqnjJFw");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./C-PXJvnKib.js",import.meta.url,"C-PXJvnKib");SML.di("./DKP07AmMm9.js",import.meta.url,"DKP07AmMm9");SML.di("./DXjwz3hl6z.js",import.meta.url,"DXjwz3hl6z");SML.di("./hrqH5pRvGY.js",import.meta.url,"hrqH5pRvGY");SML.di("./CfOIJFvDlJ.js",import.meta.url,"CfOIJFvDlJ");SML.di("./CEBL3uuwif.js",import.meta.url,"CEBL3uuwif");SML.di("./B41bwkZWe9.js",import.meta.url,"B41bwkZWe9");SML.di("./DEgnJa98M9.js",import.meta.url,"DEgnJa98M9");SML.di("./BONkG2e5dl.js",import.meta.url,"BONkG2e5dl");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./CN37VDT_yn.js",import.meta.url,"CN37VDT_yn");SML.di("./CPEjWpDINz.js",import.meta.url,"CPEjWpDINz");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");SML.di("./piqxRzNCoR.js",import.meta.url,"piqxRzNCoR");SML.di("./DLdgTt_kCu.js",import.meta.url,"DLdgTt_kCu");SML.di("./Bb-T49I7YR.js",import.meta.url,"Bb-T49I7YR");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./Cz_WrixFD5.js",import.meta.url,"Cz_WrixFD5");SML.di("./de0dPcz3qH.js",import.meta.url,"de0dPcz3qH");SML.di("./Bu_0OLU9_w.js",import.meta.url,"Bu_0OLU9_w");
SML.dm("CUjNl3Qsqg",["CYrPuvCiTj","BNRfi4XN6P","i6yXqnjJFw","C-PXJvnKib","DKP07AmMm9","DXjwz3hl6z","hrqH5pRvGY","CfOIJFvDlJ","CEBL3uuwif","B41bwkZWe9","DEgnJa98M9","BONkG2e5dl","wzdls1o9Kk","CN37VDT_yn","CPEjWpDINz","005PrA1Byk","piqxRzNCoR","DLdgTt_kCu","Bb-T49I7YR","C8CrqKCiqJ","Cz_WrixFD5","de0dPcz3qH","Bu_0OLU9_w"],(async E=>{let T=class extends E.s{constructor(){super(...arguments),this.clickListeners={}}get tabLinks(){return this.querySelectorAll("a[id^=search-results-page-tab-]")}connectedCallback(){super.connectedCallback(),this.tabLinks.forEach((T=>{var D;this.clickListeners[T.id]=(D=T.getAttribute("href")||"",T=>{if(T.preventDefault(),D.startsWith(E.gC))return E.dF(D),void E.c7(D);E.gD(D)}),T.addEventListener("click",this.clickListeners[T.id])}))}disconnectedCallback(){super.disconnectedCallback(),this.tabLinks.forEach((E=>{E.removeEventListener("click",this.clickListeners[E.id])}))}createRenderRoot(){return this}};E._([E.j()],T.prototype,"clickListeners",void 0),T=E._([E.e("search-results-page-tabs")],T)}));
SML.dm("CVN1JN5P6I",[],(async()=>{var o;!function(o){o.Ban="ban",o.Mute="mute",o.SendModMail="send-mod-mail",o.AddModNote="add-mod-note",o.EditUserFlair="edit-user-flair",o.OpenDetailedView="open-detailed-view",o.UserModLog="user-mod-log",o.ReportUser="report-user",o.Approve="approve"}(o||(o={}));var e,n;return function(o){o.Violation="violation-ban-modal-input",o.Duration="duration-ban-modal-input",o.ModNote="mod-note-ban-modal-input",o.Message="message-ban-modal-input",o.SavedResponse="saved-response-id-ban-modal-input",o.WithThingId="with-thing-id-ban-modal-input"}(e||(e={})),function(o){o.Duration="duration-mute-modal-input",o.ModNote="mod-note-mute-modal-input"}(n||(n={})),{get B(){return e},M:"mod-ban-modal",a:"mod-mute-modal",b:"user-man-ban-submit-button",c:"user-man-mute-submit-button",d:"mod-ban-modal-close-button",e:"mod-mute-modal-close-button",f:"mod-ban-modal-cancel-button",g:"mod-mute-modal-cancel-button",get h(){return n},get i(){return o},j:"mod-ban-modal-header",k:"mod-mute-modal-header",l:"mod-ban-modal-loading",m:"mod-ban-modal-content",n:"mod-mute-modal-loading",o:"mod-mute-modal-content"}}));

SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./D1jB1lRGDu.js",import.meta.url,"D1jB1lRGDu");SML.di("./B9Z38jXwJn.js",import.meta.url,"B9Z38jXwJn");SML.di("./GAfaH20Chw.js",import.meta.url,"GAfaH20Chw");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./HQokY_KEgH.js",import.meta.url,"HQokY_KEgH");
SML.dm("CXJ58rbE8s",["CYrPuvCiTj","D1jB1lRGDu","GAfaH20Chw","wzdls1o9Kk","HQokY_KEgH","B9Z38jXwJn"],(async(t,e,i,s,n)=>{const o=/^(?:[a-zA-Z0-9-]+\.)?reddit\.com$/,a=/^shreddit\.local\.snoo\.dev:\d+$/,r=["out.reddit.com","alb.reddit.com","blog.reddit.com","status.reddit.com","code.reddit.com","sp.reddit.com"],c=/^\u0020|[\u0000-\u0019\u1680\u180E\u2000-\u2029\u205f\u3000]/,h=["http:","https:"];function d(t){if("string"!=typeof t||c.test(t))return!1;try{const{host:e,protocol:i}=new URL(t.toLowerCase());return!!i&&!!e&&h.includes(i)&&(o.test(e)||a.test(e))&&!r.includes(e)}catch(t){return!1}}let l=window.location;function u(e={}){const{destinationUrl:i,additionalParams:s,suppressLoginToast:n}=e;n||t.cF();try{const e=new URL(l.href);e.pathname.match(t.cG)&&(e.pathname="");let n=i||e.searchParams.get("dest");if(n?.startsWith("/")&&(n=new URL(n,window.location.origin).toString()),n&&d(n)){const t=new URL(n);"old.reddit.com"===t.hostname&&t.searchParams.set("cache-bust",Date.now().toString()),e.href=t.toString()}else e.searchParams.delete("dest");if(s)for(const[t,i]of s)e.searchParams.set(t,i);const o=e.toString();o===l.href?l.reload():l.href=o}catch(t){l.reload()}}let p=u,m=t.ax,S=t.ag,E=e.o,g=t.w,f=window.location,b=class extends t.s{constructor(){super(...arguments),this.stepName=null,this.isStandalonePage=!1,this.open=!1,this.authContext={},this.history=[],this.events=new t.E(this),this.scrollBlocker=new i.S(this),this.findStepElement=t=>this.querySelector(`[slot="${t}"]`),this.requestClose=()=>{this.blocking?this.isStandalonePage&&this.redirectToHome():this.close()},this.redirectToHome=()=>{f.href=location.origin},this.reloadToLoggedIn=async(t=!1)=>{let e;if(void 0===this.authContext.thingId||void 0===this.authContext.actionSource||!1===await this.isExperimentEnabled("shreddit_next_action"))return void p({});const i=await this.handleGatedAction();i&&(e=new URLSearchParams,e.set("aga",`${this.authContext.actionSource}:${this.authContext.thingId}:${t}`)),p({destinationUrl:this.authContext.destination,additionalParams:e,suppressLoginToast:i})},this.handleEscKey=this.events.define("keydown",(t=>{"Escape"!==t.key||this.blocking||this.close()})),this.handleGatedAction=async()=>{const{actionSource:e,thingId:i}=this.authContext;if(!e||!i)return!1;const s=n.g(i);return e===t.cH.Upvote||e===t.cH.Downvote?this.handleVoteAction(e,i,s):e===t.cH.Join&&this.handleSubscriptionAction(i)},this.handleVoteAction=async(i,s,o)=>{if(o!==n.T.Post&&o!==n.T.Comment)return!1;const a=i===t.cH.Upvote?e.V.Upvote:e.V.Downvote;try{return await E(s,o===n.T.Post?"post":"comment",a),!0}catch{return!1}},this.handleSubscriptionAction=async e=>{try{const i=await S({operation:t.af.UpdateSubredditSubscriptions,variables:{input:{inputs:[{subredditId:e,subscribeState:t.cI.Subscribed}]}}});return!!i?.data?.updateSubredditSubscriptions?.ok}catch{return!1}},this.deprecated__onFaceplateTrack=this.events.define("faceplate-track",(e=>{const{source:i,action:n,noun:o}=e.detail;i===s.at&&n===s.au&&t.cJ.has(o)&&this.requestClose()}))}get blocking(){if(this.isStandalonePage)return!0;if(this.open&&this.stepName){const t=this.findStepElement(this.stepName);return t?.hasAttribute("blocking")}return!1}connectedCallback(){if(super.connectedCallback(),null!==this.stepName){const t=new URLSearchParams(window.location.search).get("action_source");this.show(this.stepName,{queryParams:{...t&&{actionSource:t}}})}}hasStep(t){return!!this.findStepElement(t)}onInitialFlowOpen(){this.open||this.dispatchEvent(t.d("auth-flow-initial-open"))}setAuthContext(t){this.authContext={...t}}async show(e,i){const s=this.findStepElement(e),n=s?.getAttribute("feature-name"),o=t.N();if(!s||!n)return!1;try{const e={...i?.queryParams,is_standalone:this.isStandalonePage};o&&(e.source_page=o.toString()),await g({root:s,name:n,renderMode:t.P.Contents,...i,queryParams:e})}finally{this.onInitialFlowOpen(),this.open=!0,this.history.push(e),this.stepName=e,this.scrollBlocker.blockPageScrolling()}return!0}back(){if(!this.open)return;this.history.pop();const t=this.history.at(-1);if(!t)return this.requestClose();this.stepName=t}close(){this.dispatchEvent(t.d("auth-flow-dismiss")),this.open=!1,this.stepName=null,this.history=[],this.scrollBlocker.unblockPageScrolling(),this.authContext={}}async isExperimentEnabled(e){if("enabled"===new URLSearchParams(window.location.search).get(e))return!0;try{const i=await S({operation:t.af.ExperimentVariant,variables:{name:e}}),s=i.data.experimentVariant?.name,n=i.data.experimentVariant?.version;return"string"==typeof s&&"string"==typeof n&&(!!i&&(m({experimentName:e,variant:s,experimentVersion:n}),"enabled"===s))}catch{return!1}}render(){return this.open?t.x` <div class="z-[100] fixed"> <div class="${t.aa(this.isStandalonePage?void 0:"fixed top-0 end-0 bottom-0 start-0 bg-black opacity-50 backdrop-blur-sm")}" tabindex="-1" @click="${this.requestClose}"></div> <slot name="${this.stepName}"></slot> <slot></slot> </div> `:t.A}};return b.styles=[t.t],t._([t.n({attribute:"step-name",type:String,reflect:!0})],b.prototype,"stepName",void 0),t._([t.n({attribute:"is-standalone",type:Boolean})],b.prototype,"isStandalonePage",void 0),t._([t.j()],b.prototype,"open",void 0),t._([t.j()],b.prototype,"authContext",void 0),b=t._([t.e("auth-flow-manager")],b),{i:d,r:u}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CVN1JN5P6I.js",import.meta.url,"CVN1JN5P6I");SML.di("./tXzIaFuSwM.js",import.meta.url,"tXzIaFuSwM");SML.di("./Cup7YLVD71.js",import.meta.url,"Cup7YLVD71");SML.di("./CZSZx8Z9nd.js",import.meta.url,"CZSZx8Z9nd");SML.di("./DcxJbk2B3f.js",import.meta.url,"DcxJbk2B3f");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./BNhmBC31Qc.js",import.meta.url,"BNhmBC31Qc");SML.di("./Cv4uyJM28X.js",import.meta.url,"Cv4uyJM28X");SML.di("./q5XTF3XWlp.js",import.meta.url,"q5XTF3XWlp");SML.di("./hz18Vlqikv.js",import.meta.url,"hz18Vlqikv");SML.di("./DdQ8ToexAC.js",import.meta.url,"DdQ8ToexAC");SML.di("./BaesuPO9Of.js",import.meta.url,"BaesuPO9Of");SML.di("./DcFz6mYbCk.js",import.meta.url,"DcFz6mYbCk");SML.di("./DkidhsLweq.js",import.meta.url,"DkidhsLweq");SML.di("./C7tY_fu9Em.js",import.meta.url,"C7tY_fu9Em");SML.di("./DDqgWwsuds.js",import.meta.url,"DDqgWwsuds");SML.di("./Bov9e_IWR8.js",import.meta.url,"Bov9e_IWR8");SML.di("./DSIyHwStgC.js",import.meta.url,"DSIyHwStgC");SML.di("./DiH4zLRIso.js",import.meta.url,"DiH4zLRIso");SML.di("./eBJPTvxH2_.js",import.meta.url,"eBJPTvxH2_");SML.di("./B5hztqUCve.js",import.meta.url,"B5hztqUCve");SML.di("./CiSu63MOrp.js",import.meta.url,"CiSu63MOrp");SML.di("./BgHhDaqVOR.js",import.meta.url,"BgHhDaqVOR");SML.di("./BTXMyvabmU.js",import.meta.url,"BTXMyvabmU");SML.di("./3jd2bjBQv5.js",import.meta.url,"3jd2bjBQv5");SML.di("./DJaop39KNp.js",import.meta.url,"DJaop39KNp");SML.di("./DwBbT5sc7p.js",import.meta.url,"DwBbT5sc7p");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");
SML.dm("CXOS1kNFW2",["CYrPuvCiTj","CVN1JN5P6I","Cup7YLVD71","CZSZx8Z9nd","tXzIaFuSwM","DcxJbk2B3f","wzdls1o9Kk","BNhmBC31Qc","Cv4uyJM28X","q5XTF3XWlp","hz18Vlqikv","DdQ8ToexAC","BaesuPO9Of","DcFz6mYbCk","DkidhsLweq","C7tY_fu9Em","DDqgWwsuds","Bov9e_IWR8","DSIyHwStgC","DiH4zLRIso","eBJPTvxH2_","B5hztqUCve","CiSu63MOrp","BgHhDaqVOR","BTXMyvabmU","3jd2bjBQv5","DJaop39KNp","DwBbT5sc7p","005PrA1Byk"],(async(t,e,a,s)=>{const i="user-mod-actions-button";let o=class extends t.s{constructor(){super(...arguments),this.active=!1,this.isSmall=!1,this.isPlain=!1,this.isBordered=!1,this.applySelected=!1}static get styles(){return[t.t,t.V(".button-caution {\n  --button-color-background-default: var(--color-button-caution-background);\n  --button-color-background-hover: var(--color-button-caution-background-hover);\n  --button-color-background-disabled: var(--color-button-caution-background-disabled);\n  --button-color-text-default: var(--color-button-caution-text);\n}\n")]}getTooltipText(){if(!this.action)return t.x``;const a={[e.i.Ban]:this.active?"Unban":"Ban",[e.i.Mute]:this.active?"Unmute":"Mute",[e.i.Approve]:this.active?"Remove from approved users":"Approve user"}[this.action];let s;this.active&&(void 0!==this.daysTotal&&this.action!==e.i.Approve?s={[e.i.Ban]:t.bZ({one:`${this.daysTotal} day ban.`,other:`${this.daysTotal} days ban.`,count:this.daysTotal||0}),[e.i.Mute]:t.bZ({one:`${this.daysTotal} day mute.`,other:`${this.daysTotal} days mute.`,count:this.daysTotal||0})}[this.action]:this.action===e.i.Ban&&(s="Permanent ban"));let i="";return s&&void 0!==this.daysLeft&&(i=this.active&&!this.daysLeft?"":t.bZ({one:` ${this.daysLeft} day left.`,other:` ${this.daysLeft} days left.`,count:this.daysLeft||0})),t.x` <div class="font-semibold">${a}</div> ${s}${i} `;}render(){const a=this.isBordered?"bordered":this.isPlain||this.active?"plain":"secondary";return t.x`<faceplate-tracker source="moderator" action="click" noun="${t.aa(this.action&&(s=this.action,i=this.active,(i?{[e.i.Mute]:"unmute",[e.i.Ban]:"unban",[e.i.Approve]:"disapprove_user"}:{[e.i.Mute]:"mute_flow",[e.i.Ban]:"ban_flow",[e.i.Approve]:"approve_user"})[s]))}"><faceplate-tooltip enter-delay="${50}" appearance="inverted" position="top"> ${t.u({appearance:a,size:this.isSmall?t.v.Small:t.v.Medium,selected:this.applySelected&&this.active,attributes:{slot:"trigger"},leadingIcon:t.x`<slot name="${this.active?"icon-active":"icon"}"></slot><slot></slot>`})} ${this.getTooltipText()} </faceplate-tooltip></faceplate-tracker>`;var s,i}};t._([t.n({type:Boolean})],o.prototype,"active",void 0),t._([t.n({type:String})],o.prototype,"action",void 0),t._([t.n({attribute:"days-total",type:Number})],o.prototype,"daysTotal",void 0),t._([t.n({attribute:"days-left",type:Number})],o.prototype,"daysLeft",void 0),t._([t.n({type:String,attribute:"conversation-id"})],o.prototype,"conversationId",void 0),t._([t.n({type:Boolean,attribute:"is-small"})],o.prototype,"isSmall",void 0),t._([t.n({type:Boolean,attribute:"is-plain"})],o.prototype,"isPlain",void 0),t._([t.n({type:Boolean,attribute:"is-bordered"})],o.prototype,"isBordered",void 0),t._([t.n({type:Boolean,attribute:"apply-selected"})],o.prototype,"applySelected",void 0),o=t._([t.e(i)],o);const n=(t,e)=>t.operation===e;class r{constructor(s,i){this.userModActions=s,this.action=i,this.handleUserUnrestricted=async t=>{t&&t.subredditId===this.userModActions.subredditId&&t.userId===this.userModActions.userId&&(t.acked||(t.acked=!0,this.showStateChangeNotification(!1)),this.handleStateChange(!1))},this.resetUserRestriction=async()=>{const{userModActions:a,userModActions:{requestClientGQL:s,userId:i,subredditId:o}}=this;if(a.requestPending)return;a.requestPending=!0;const r=await s({operation:{[e.i.Ban]:t.af.UnbanSubredditUser,[e.i.Mute]:t.af.UnmuteMember}[this.action],variables:{input:{userId:i,subredditId:o}}}),d={[e.i.Ban]:n(r,t.af.UnbanSubredditUser)&&r.data.unbanSubredditUser?.ok,[e.i.Mute]:n(r,t.af.UnmuteMember)&&r.data.unmuteMember?.ok}[this.action]&&!r.errors.length;a.requestPending=!1,d&&t.p({[e.i.Ban]:t.T.UserModActionsUnban,[e.i.Mute]:t.T.UserModActionsUnmute}[this.action],{subredditId:this.userModActions.subredditId,userId:this.userModActions.userId})},this.openModal=async()=>{const{modOverlayDisplay:t}=this.userModActions,s={[e.i.Ban]:a.M,[e.i.Mute]:a.a}[this.action];t?.setAttribute("overlay-id",s),await(t?.updateComplete);const{banModal:i,muteModal:o}=this.userModActions,n={[e.i.Ban]:i,[e.i.Mute]:o}[this.action];n&&(this.showModalAndListenForDismissal(n),await this.loadModal(n),this.showModalContent(n))},this.handleUserRestricted=t=>{t&&t.subredditId===this.userModActions.subredditId&&t.userId===this.userModActions.userId&&(t.acked||(t.acked=!0,this.showStateChangeNotification(!0)),{[e.i.Ban]:this.userModActions.handleBanModalDismiss,[e.i.Mute]:this.userModActions.handleMuteModalDismiss}[this.action](),this.handleStateChange(!0,t?.daysTotal))},this.handleFailure=()=>{this.showStateChangeNotification(!1,!0)},this.showModalAndListenForDismissal=t=>{const{handleBanModalDismiss:a,handleMuteModalDismiss:s,banModalCloseButton:i,muteModalCloseButton:o}=this.userModActions,[n,r]={[e.i.Ban]:[a,i],[e.i.Mute]:[s,o]}[this.action];setTimeout((()=>{t.showModal()})),r?.addEventListener("click",n)},this.loadModal=async t=>{const{subredditId:s,userName:i,thingId:o,isDesktop:n,conversationId:r}=this.userModActions,d={[e.i.Ban]:a.c,[e.i.Mute]:a.d}[this.action],l={[e.i.Ban]:()=>`Ban u/${i}`,[e.i.Mute]:()=>`Mute u/${i}`}[this.action],u={[e.i.Ban]:e.j,[e.i.Mute]:e.k}[this.action];t.querySelector(`#${u}`).textContent=l();const h=t.querySelector("faceplate-partial");if(!h)return;h.src=`${d}/${s}/${i}/`,this.action===e.i.Ban&&o&&(h.src=`${d}/${s}/${i}/${o}`),this.action===e.i.Mute&&r&&(h.src=`${d}/${s}/${i}/${r}`);const T=t.querySelector("shreddit-async-loader");await Promise.allSettled([T?.load(),h?.load()]),n||setTimeout((()=>{t.recalculateCachedHeight()}))},this.showModalContent=t=>{const[a,s]={[e.i.Ban]:[e.l,e.m],[e.i.Mute]:[e.n,e.o]}[this.action],i=t.querySelector(`#${a}`),o=t.querySelector(`#${s}`);i?.classList.add("hidden"),o?.classList.remove("hidden")},this.hideModalContent=t=>{const[a,s]={[e.i.Ban]:[e.l,e.m],[e.i.Mute]:[e.n,e.o]}[this.action],i=t.querySelector(`#${a}`),o=t.querySelector(`#${s}`);i?.classList.remove("hidden"),o?.classList.add("hidden")}}setButtonState(t,s){const o=this.userModActions.actionElements.get(this.action)?.element;if(!o)return;const n=o.closest(i)??void 0;n&&(n.active=t,n.daysTotal=s,n.daysLeft=s);const r=(t?{[e.i.Ban]:"Unban",[e.i.Mute]:"Unmute"}:{[e.i.Ban]:"Ban",[e.i.Mute]:"Mute"})[this.action],d=o.querySelector(`#${a.e}`)??void 0;d&&(d.textContent=r)}showStateChangeNotification(a,s){const{userModActions:i,userModActions:{userName:o}}=this;s?i.dispatchEvent(t.d("faceplate-alert",{level:t.a0.error,message:"Something went wrong",cause:t.bm.QueryBadResponse})):(i.dispatchEvent(t.d("faceplate-alert",{level:t.a0.info,message:{[e.i.Ban]:a?`u/${o} was banned successfully`:`u/${o} was unbanned successfully`,[e.i.Mute]:a?`u/${o} was muted successfully`:`u/${o} was unmuted successfully`}[this.action]})),document.querySelector("modmail-thread-wrapper")?.dispatchEvent(t.d("mute-user:success",{},!0)))}handleStateChange(t,a){this.userModActions[{[e.i.Ban]:"userIsBanned",[e.i.Mute]:"userIsMuted"}[this.action]]=t,this.setButtonState(t,a)}}let d=class extends t.s{get modOverlayDisplay(){return document.querySelector(`${this.isDesktop?"shreddit-overlay-display":"div"}[id="${t.gM}"]`)}get muteModal(){const t=`${this.isDesktop?"faceplate-dialog":"faceplate-bottom-sheet"}[id="${e.a}"]`;return this.isDesktop?this.modOverlayDisplay?.shadowRoot?.querySelector(t):this.modOverlayDisplay?.querySelector(t)}get banModal(){const t=`${this.isDesktop?"faceplate-dialog":"faceplate-bottom-sheet"}[id="${e.M}"]`;return this.isDesktop?this.modOverlayDisplay?.shadowRoot?.querySelector(t):this.modOverlayDisplay?.querySelector(t)}get muteModalCloseButton(){return this.muteModal?.querySelector(`button[id=${e.e}]`)}get banModalCloseButton(){return this.banModal?.querySelector(`button[id=${e.d}]`)}async firstUpdated(t){await this.loadLastNote()}assignActionElementsAndEventHandlers(){for(const[t,a]of[[e.i.Ban,this.handleClickBan],[e.i.Mute,this.handleClickMute],[e.i.SendModMail,this.handleModmailClick],[e.i.AddModNote,this.handleClickAddModNote],[e.i.EditUserFlair,this.handleClickUserFlair],[e.i.UserModLog,this.handleClickUserModLog],[e.i.ReportUser,this.handleReportClick],[e.i.OpenDetailedView,this.handleOpenUserProfileClick]]){const e=this.querySelector(`[data-mod-action=${t}]`)??void 0;e?.addEventListener("click",a),this.actionElements.set(t,{element:e,clickHandler:a})}}handleReportClick(){window.open("https://support.reddithelp.com/hc/articles/360043479851-How-do-I-report-a-user-","_blank")}setupTopicSubscriptions(){Object.entries(this.topicSubscriptions).forEach((([t,e])=>this.pubsub.subscribe(t,e)))}constructor(){super(),this.subredditName="",this.userIsBanned=!1,this.userIsMuted=!1,this.userName="",this.userId="",this.subredditId="",this.postId="",this.isDesktop=!1,this.modmailRootRoute=s.f,this.requestPending=!1,this.actionElements=new Map,this.muteController=new r(this,e.i.Mute),this.banController=new r(this,e.i.Ban),this.pubsub=new t.z(this),this.requestClientGQL=t.ag,this.loadLastNote=async()=>{const t=this.querySelector('faceplate-partial[id="last-mod-note-partial"]'),e=this.querySelector('shreddit-async-loader[id="last-mod-note-async-loader"]');t&&e&&(await e.load(),await t.load())},this.handleClickMute=()=>this.userIsMuted?this.muteController.resetUserRestriction():this.muteController.openModal(),this.handleUserMuted=this.muteController.handleUserRestricted,this.handleUserUnmuted=this.muteController.handleUserUnrestricted,this.handleBanFailure=this.muteController.handleFailure,this.handleMuteFailure=this.muteController.handleFailure,this.handleMuteModalDismiss=()=>{this.muteModalCloseButton?.removeEventListener("click",this.handleMuteModalDismiss),this.muteModal&&(this.muteController.hideModalContent(this.muteModal),this.muteModal.close())},this.handleClickBan=()=>this.userIsBanned?this.banController.resetUserRestriction():this.banController.openModal(),this.handleUserBanned=this.banController.handleUserRestricted,this.handleUserUnbanned=this.banController.handleUserUnrestricted,this.handleBanModalDismiss=()=>{this.banModalCloseButton?.removeEventListener("click",this.handleBanModalDismiss),this.banModal&&(this.banController.hideModalContent(this.banModal),this.banModal.close())},this.handleClickUserFlair=()=>{t.p(t.T.ModNotesOpenUserFlairEdditor)},this.handleModmailClick=()=>{window.open(`${this.modmailRootRoute}/mail/create?toSubredditName=${this.subredditName}&toUserName=${this.userName}`,"_blank")},this.handleOpenUserProfileClick=()=>{window.open(`https://www.reddit.com/user/${this.userName}`,"_blank")},this.handleClickAddModNote=()=>{t.p(t.T.ModNotesOpenLogFocus)},this.handleClickUserModLog=()=>{t.p(t.T.ModNotesOpenLog,{})},this.topicSubscriptions={[t.T.UserModActionsMute]:this.handleUserMuted,[t.T.UserModActionsMuteCancel]:this.handleMuteModalDismiss,[t.T.UserModActionsUnmute]:this.handleUserUnmuted,[t.T.UserModActionsBan]:this.handleUserBanned,[t.T.UserModActionsBanCancel]:this.handleBanModalDismiss,[t.T.UserModActionsUnban]:this.handleUserUnbanned,[t.T.UserModActionsBanFailure]:this.handleBanFailure,[t.T.UserModActionsMuteFailure]:this.handleMuteFailure,[t.T.ModNotesDeleted]:this.loadLastNote,[t.T.ModNotesCreated]:this.loadLastNote},new t.aB(this,this,{rootMargin:"0px"}),this.addEventListener("faceplate-enter",(()=>{t.k(this,t.c({source:"moderator",action:"hover",noun:"user_profile"}))}))}connectedCallback(){super.connectedCallback(),this.assignActionElementsAndEventHandlers(),this.setupTopicSubscriptions()}disconnectedCallback(){super.disconnectedCallback();for(const[,{element:t,clickHandler:e}]of this.actionElements.entries())e&&t?.removeEventListener("click",e)}createRenderRoot(){return this}};return t._([t.n({attribute:"subreddit-name"})],d.prototype,"subredditName",void 0),t._([t.n({attribute:"user-is-banned",type:Boolean})],d.prototype,"userIsBanned",void 0),t._([t.n({attribute:"user-is-muted",type:Boolean})],d.prototype,"userIsMuted",void 0),t._([t.n({attribute:"user-name"})],d.prototype,"userName",void 0),t._([t.n({attribute:"user-id"})],d.prototype,"userId",void 0),t._([t.n({attribute:"subreddit-id"})],d.prototype,"subredditId",void 0),t._([t.n({attribute:"post-id"})],d.prototype,"postId",void 0),t._([t.n({attribute:"thing-id"})],d.prototype,"thingId",void 0),t._([t.n({attribute:"conversation-id"})],d.prototype,"conversationId",void 0),t._([t.n({type:Boolean,attribute:"is-desktop"})],d.prototype,"isDesktop",void 0),t._([t.n({attribute:"modmail-root-route"})],d.prototype,"modmailRootRoute",void 0),t._([t.j()],d.prototype,"requestPending",void 0),d=t._([t.e("user-mod-actions")],d),{get UserModActions(){return d}}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./BNhmBC31Qc.js",import.meta.url,"BNhmBC31Qc");SML.di("./Cv4uyJM28X.js",import.meta.url,"Cv4uyJM28X");SML.di("./q5XTF3XWlp.js",import.meta.url,"q5XTF3XWlp");SML.di("./hz18Vlqikv.js",import.meta.url,"hz18Vlqikv");SML.di("./DdQ8ToexAC.js",import.meta.url,"DdQ8ToexAC");SML.di("./BaesuPO9Of.js",import.meta.url,"BaesuPO9Of");SML.di("./DcFz6mYbCk.js",import.meta.url,"DcFz6mYbCk");SML.di("./DkidhsLweq.js",import.meta.url,"DkidhsLweq");SML.di("./C7tY_fu9Em.js",import.meta.url,"C7tY_fu9Em");SML.di("./DDqgWwsuds.js",import.meta.url,"DDqgWwsuds");SML.di("./Bov9e_IWR8.js",import.meta.url,"Bov9e_IWR8");SML.di("./DSIyHwStgC.js",import.meta.url,"DSIyHwStgC");SML.di("./DiH4zLRIso.js",import.meta.url,"DiH4zLRIso");SML.di("./eBJPTvxH2_.js",import.meta.url,"eBJPTvxH2_");SML.di("./B5hztqUCve.js",import.meta.url,"B5hztqUCve");SML.di("./CiSu63MOrp.js",import.meta.url,"CiSu63MOrp");SML.di("./BgHhDaqVOR.js",import.meta.url,"BgHhDaqVOR");SML.di("./BTXMyvabmU.js",import.meta.url,"BTXMyvabmU");SML.di("./3jd2bjBQv5.js",import.meta.url,"3jd2bjBQv5");SML.di("./DJaop39KNp.js",import.meta.url,"DJaop39KNp");SML.di("./DwBbT5sc7p.js",import.meta.url,"DwBbT5sc7p");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");
SML.dm("CZSZx8Z9nd",["CYrPuvCiTj","q5XTF3XWlp","DdQ8ToexAC","C7tY_fu9Em","DDqgWwsuds","CiSu63MOrp","BgHhDaqVOR","3jd2bjBQv5","DJaop39KNp","DwBbT5sc7p","BNhmBC31Qc","Cv4uyJM28X","hz18Vlqikv","BaesuPO9Of","DcFz6mYbCk","DkidhsLweq","Bov9e_IWR8","DSIyHwStgC","DiH4zLRIso","eBJPTvxH2_","B5hztqUCve","BTXMyvabmU","005PrA1Byk"],(async(e,r,a,i,t,n,s,l,o,N)=>{const{svg:d}=e.a();e.m(d`<path d="M10 1a9 9 0 100 18 9 9 0 000-18zm4 10h-3v3H9v-3H6V9h3V6h2v3h3v2z"></path>`,"0 0 20 20","add-circle-fill");const{svg:T}=e.a(),I=e.m(T`<path d="M15.7 1H4.3C2.48 1 1 2.48 1 4.3v2.76c0 .5.4.9.9.9H2v6.74C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V7.96h.1c.5 0 .9-.4.9-.9V4.3C19 2.48 17.52 1 15.7 1zM13 11.87H7v-1.8h6v1.8zm4.2-5.71H2.8V4.3c0-.83.67-1.5 1.5-1.5h11.4c.83 0 1.5.67 1.5 1.5v1.86z"></path>`,"0 0 20 20","archive-fill"),{svg:R}=e.a(),u=e.m(R`<g clip-path="url(#a)"><path d="M19.188 10.304a2.63 2.63 0 00-.776-1.873 2.825 2.825 0 00-1.493-.796c-.881-.156-1.77-.372-2.493-.899-1.177-.858-1.891-2.091-2.04-3.487-.065-.627-.374-1.236-.865-1.708-1.05-1.01-2.747-.91-3.776.12L3.905 5.5a2.63 2.63 0 00-.775 1.873c0 .707.275 1.372.776 1.872a2.792 2.792 0 001.664.82c.332.036.648.12.957.224l-4.901 4.9a2.25 2.25 0 103.182 3.18l4.9-4.9c.102.31.187.626.223.959.065.607.356 1.198.82 1.663a2.638 2.638 0 001.873.773c.678 0 1.357-.258 1.873-.773l3.915-3.915c.5-.5.776-1.165.776-1.872z"></path></g><defs><clipPath id="a"><path d="M0 0h20v20H0z"></path></clipPath></defs>`,"0 0 20 20","ban-fill"),{svg:m}=e.a();e.m(m`<path d="M2.849 17.987l3.84.013c.203 0 .398-.08.541-.223l9.733-9.733a3.54 3.54 0 10-5.007-5.007L2.223 12.77a.76.76 0 00-.223.541l.013 3.84a.839.839 0 00.836.836z"></path>`,"0 0 20 20","edit-fill");const{svg:h}=e.a(),E=e.m(h`<path d="M17.784 6.065l-6.057-4.491a2.883 2.883 0 00-3.453 0L2.111 6.14A2.781 2.781 0 001 8.374v6.325C1 16.519 2.48 18 4.3 18h11.4c1.819 0 3.3-1.481 3.3-3.301V8.374a2.8 2.8 0 00-1.216-2.309zm-8.062 7.509A1.458 1.458 0 018.69 14c-.373 0-.747-.142-1.031-.425L5.32 11.236l1.273-1.272 2.097 2.097 4.718-4.718 1.273 1.272-4.959 4.959z"></path>`,"0 0 20 20","mark-read-fill"),{svg:c}=e.a();e.m(c`<path d="M13.4 15.97a2.595 2.595 0 01-3-2.57c0-.7.27-1.35.76-1.84l3-3a2.613 2.613 0 011.83-.76c.34 0 .68.07 1 .2.32.13.6.32.84.56l1.15 1.15C18.82 4.88 14.87 1 9.99 1a9 9 0 000 18c1.2 0 2.35-.24 3.4-.67l.01-2.36zM8.8 10.8H4.58V9H9V4.58h1.8V8.8c0 1.1-.9 2-2 2z"></path><path d="M19.64 12.76l-3-3a.915.915 0 00-1.27 0l-3 3a.9.9 0 000 1.27.9.9 0 001.27 0l1.46-1.46v6.03c0 .5.4.9.9.9s.9-.4.9-.9v-6.03l1.46 1.46c.18.18.41.26.64.26.23 0 .46-.09.64-.26a.9.9 0 000-1.27z"></path>`,"0 0 20 20","new-fill",!0);const{svg:k}=e.a(),A=e.m(k`<path d="M15.21 7.5l2.56-3.86c.47-.7-.04-1.64-.88-1.64H5C3.03 2 1.59 3.87 2.1 5.78L4.04 13l1.37 5.08a.906.906 0 001.1.64.9.9 0 00.64-1.1l-1.24-4.61h10.98c.84 0 1.35-.94.88-1.64l-2.56-3.86V7.5z"></path>`,"0 0 20 20","report-fill"),{svg:D}=e.a(),v=e.m(D`<path d="M10.987 17.212a2 2 0 01-4 0v-6.83c-.382.17-.749.374-1.084.644a2.8 2.8 0 01-1.757.596 2.63 2.63 0 01-1.872-.775c-.5-.5-.776-1.166-.776-1.873v-5.43c0-1.456 1.13-2.726 2.585-2.755.682-.014 1.33.2 1.821.595 1.092.883 2.468 1.25 3.907 1.024.884-.139 1.665-.615 2.398-1.127a2.826 2.826 0 011.619-.493c.707 0 1.373.276 1.873.776s.776 1.166.776 1.873v4.477h-2.479a3 3 0 00-3 3l-.011 6.298zm5.992-4.644l-.004-.007a114.98 114.98 0 01-.749-.747h1.308a.9.9 0 000-1.8h-3.536a.9.9 0 00-.9.9v3.535a.9.9 0 001.8 0v-1.417c.329.33.65.651.805.804l.004.006c.565.565.684 1.214.684 1.658a1.7 1.7 0 01-1.7 1.7.9.9 0 000 1.8c1.93 0 3.5-1.57 3.5-3.5a4.12 4.12 0 00-1.211-2.933l-.001.001z"></path>`,"0 0 20 20","unban-fill"),L={Thread:"THREAD",Perma:"PERMA"},O={...e.dB,...L},p="MARK_READ",M="MARK_UNREAD",P="COPY_LINK",S={[e.dC.Archived]:"modmail-action-bar:archive",[e.dC.Unarchived]:"modmail-action-bar:unarchive",[e.dC.Filtered]:"modmail-action-bar:filter",[e.dC.Unfiltered]:"modmail-action-bar:unfilter",[p]:"modmail-action-bar:mark-read",[M]:"modmail-action-bar:mark-unread"},C=()=>"All",H={[O.All]:C,[O.Perma]:C,[O.Thread]:C,[O.New]:()=>"New",[O.InProgress]:()=>"In Progress",[O.Archived]:()=>"Archived",[O.Appeals]:()=>"Appeals",[O.JoinRequests]:()=>"Join Requests",[O.Highlighted]:()=>"Highlighted",[O.ModDiscussions]:()=>"Mod Discussions",[O.Notifications]:()=>"Notifications",[O.Inbox]:()=>"Inbox",[O.Filtered]:()=>"Filtered",[O.Recruiting]:()=>"Recruiting",[O.Admin]:()=>"Admin"},z={[e.dC.Archived]:()=>"Archive",[e.dC.Unarchived]:()=>"Unarchive",[e.dC.Highlighted]:()=>"Highlight",[e.dC.Unhighlighted]:()=>"Unhighlight",[e.dC.Filtered]:()=>"Filter",[e.dC.Unfiltered]:()=>"Unfilter",[p]:()=>"Mark Read",[M]:()=>"Mark Unread",[P]:()=>"Copy Link"},_="https://mod.reddit.com",U="perma",f={[O.All]:"/mail/all",[O.Appeals]:"/mail/appeals",[O.Archived]:"/mail/archived",[O.Filtered]:"/mail/filtered",[O.Highlighted]:"/mail/highlighted",[O.Inbox]:"/mail/inbox",[O.InProgress]:"/mail/inprogress",[O.JoinRequests]:"/mail/join_requests",[O.ModDiscussions]:"/mail/mod",[O.New]:"/mail/new",[O.Notifications]:"/mail/notifications",[O.Recruiting]:"/mail/recruiting",[O.Admin]:"/mail/admin",[O.Perma]:`/mail/${U}`,[O.Thread]:"/mail/thread"};return{A:S,C:P,M:O,R:f,a:z,b:({id:e})=>{const r=e.split("_")[1];return`www.reddit.com/mail/${U}/${r}`},c:(d,T=e.I.Small,R={})=>{switch(d){case e.dC.Archived:return r.a({size:T,...R});case e.dC.Unarchived:return I({size:T,...R});case e.dC.Highlighted:return s.a({size:T,...R});case e.dC.Unhighlighted:return s.s({size:T,...R});case e.dC.Filtered:return N.w({size:T,...R});case e.dC.Unfiltered:return o.w({size:T,...R});case e.dC.Approved:return a.c({size:T,...R});case e.dC.Banned:return u({size:T,...R});case e.dC.Disapproved:return n.r({size:T,...R});case e.dC.Muted:return l.v({size:T,...R});case e.dC.Unbanned:return v({size:T,...R});case e.dC.Unmuted:return l.v({size:T,...R});case e.dC.ReportedToAdmins:return A({size:T,...R});case p:return t.m({size:T,...R});case M:return E({size:T,...R});default:return i.l({size:T,...R})}},d:M,e:p,f:_,g:H,h:e=>"https://reddit.com"===e?`${e}/mail/all`:_,i:u}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./piqxRzNCoR.js",import.meta.url,"piqxRzNCoR");SML.di("./Cz_WrixFD5.js",import.meta.url,"Cz_WrixFD5");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./de0dPcz3qH.js",import.meta.url,"de0dPcz3qH");
SML.dm("CfOIJFvDlJ",["CYrPuvCiTj","piqxRzNCoR","Cz_WrixFD5","C8CrqKCiqJ","de0dPcz3qH"],(async(t,e,s,a,n)=>{let i=class extends e.B{constructor(){super(),this.postTranslationCache=new Map,this.commentTranslationCache=new Map,this.eventsMetadataCache=new Map,this.isFetchingTranslations=!1,this.handleObserverChanges=t=>{const e=t.some((t=>!!t.addedNodes?.length)),s=this.translationContextValue?.isTranslationActive;e&&s&&this.onTranslationsEnabled()},this._partialRequestController=new t.aU(this),this._mutationObserver=new MutationObserver(this.handleObserverChanges)}connectedCallback(){super.connectedCallback(),this.initializeMutationObserver(),this.translationContextValue?.isTranslationActive&&this.onTranslationsEnabled()}initializeMutationObserver(){const t=this.querySelector("reddit-feed");t&&this._mutationObserver.observe(t,{childList:!0})}disableMutationObserver(){this._mutationObserver?.disconnect()}disconnectedCallback(){super.disconnectedCallback(),this.disableMutationObserver()}getResultsMetadata(){const t=this.querySelectorAll('faceplate-tracker[noun="comment"][source="search"][action="view"]');return Array.from(t||[]).map((t=>{const e=function(t){try{return JSON.parse(t)}catch{return null}}(t.getAttribute("data-faceplate-tracking-context")),s=e.comment.id,a=e.comment.parentId,n=e.post.id,i=t.querySelector(".i18n-search-comment-content"),r=i?.innerHTML,o=t.hasAttribute("data-pretranslated"),l=t.querySelector(".i18n-search-comment-post-title"),d=l?.innerHTML,c=t.querySelector(".i18n-search-comment-post-title-a11y"),h=l?.hasAttribute("data-pretranslated");return{node:t,comment:{id:s,commentEl:i,commentHTML:r,postId:n,parentId:a,commentPretranslated:o},post:{id:n,postTitleEl:l,postTitleHTML:d,postTitleA11yEl:c,postPretranslated:h}}}))}initializeTranslationCache(){this.getResultsMetadata().forEach((({comment:t,post:e})=>{t.id&&!this.commentTranslationCache.has(t.id)&&this.commentTranslationCache.set(t.id,{originalText:t.commentPretranslated?"":t.commentHTML,translatedText:t.commentPretranslated?t.commentHTML:""}),e.id&&!this.postTranslationCache.has(e.id)&&this.postTranslationCache.set(e.id,{originalText:e.postPretranslated?"":e.postTitleHTML,translatedText:e.postPretranslated?e.postTitleHTML:""})}))}getUntranslatedResults(){const t=new Map,e=new Map,s=this.getResultsMetadata(),{isTranslationActive:a}=this.translationContextValue;return s.forEach((({comment:s,post:n})=>{const i=this.commentTranslationCache.get(s?.id);!!s.id&&!!s.commentHTML&&(a?!i?.translatedText:!i?.originalText)&&(t.set(s.id,s.commentHTML),this.eventsMetadataCache.set(s.id,s));const r=this.postTranslationCache.get(n?.id);!!n.id&&!!n.postTitleHTML&&(a?!r?.translatedText:!r?.originalText)&&e.set(n.id,n.postTitleHTML)})),{untranslatedPosts:e,untranslatedComments:t}}renderTranslatedResults(t){this.getResultsMetadata().forEach((({comment:e,post:s,node:a})=>{const n=this.commentTranslationCache.get(e.id);if(n){const s=t?n.translatedText:n.originalText;e.commentEl.innerHTML=s,t?a.setAttribute("data-translated",""):a.removeAttribute("data-translated")}const i=this.postTranslationCache.get(s.id);if(i&&s.postTitleEl){const e=t?i.translatedText:i.originalText;s.postTitleEl.innerHTML=e,s.postTitleA11yEl&&(s.postTitleA11yEl.innerHTML=e)}}))}async fetchTranslatedPostTitles(e){if(!e.length)return new Map;const s=new FormData;e.forEach((t=>s.append("postIds[]",t))),s.append("includeTranslation",String(!!this.translationContextValue.isTranslationActive));const a=await this._partialRequestController.request("/svc/shreddit/translated-posts/",{method:t.bj.Post,body:s}),n=await(a?.text()),i=n?t.bl(n):[],r=new Map;return i.forEach((t=>{const e=t.getAttribute("data-post-id"),s=t.querySelector(`#feed-translation-title-${e}`);e&&s?.innerHTML&&r.set(e,s.innerHTML)})),r}async fetchTranslatedComments(e){if(!e.length)return new Map;const s=new FormData;e.forEach((t=>{s.append("commentIds[]",t)})),s.append("includeTranslation",String(!!this.translationContextValue.isTranslationActive));const a=await this._partialRequestController.request("/svc/shreddit/translated-comment",{method:t.bj.Post,body:s}),n=await(a?.text()),i=n?t.bl(n):[],r=new Map;return i.forEach((t=>{const e=t.getAttribute("data-comment-id");e&&t.children?.length&&r.set(e,t.children[0].innerHTML)})),r}async fetchPostsAndComments(){this.isFetchingTranslations=!0;const{isTranslationActive:t}=this.translationContextValue;this.initializeTranslationCache();const{untranslatedComments:e,untranslatedPosts:s}=this.getUntranslatedResults(),[a,n]=await Promise.all([this.fetchTranslatedComments(Array.from(e.keys())),this.fetchTranslatedPostTitles(Array.from(s.keys()))]);a.forEach(((e,s)=>{const a=this.commentTranslationCache.get(s);this.commentTranslationCache.set(s,{...a,[t?"translatedText":"originalText"]:e})})),n.forEach(((e,s)=>{const a=this.postTranslationCache.get(s);this.postTranslationCache.set(s,{...a,[t?"translatedText":"originalText"]:e})})),this.renderTranslatedResults(!!this.translationContextValue.isTranslationActive),this.fireEventsForLoadedTranslations(Array.from(a.keys())),this.isFetchingTranslations=!1}async onTranslationsEnabled(){this.isFetchingTranslations||await this.fetchPostsAndComments()}async onTranslationsDisabled(){this.isFetchingTranslations||await this.fetchPostsAndComments()}fireEventsForLoadedTranslations(e){e.forEach((e=>{const a=this.eventsMetadataCache.get(e),n=this.commentTranslationCache.get(e);if(!n?.translatedText)return;const i=a?.postId||"",r=""!==n?.translatedText,o=this.postTranslationCache.get(i)||null,l=o?.translatedText||"";t.k(this,s.c({isCommentTranslated:r,translationLanguage:this.translationLanguage,postId:i,parentId:a?.parentId,thingId:e},{isPostTranslated:""!==l,postId:i,translationLanguage:this.translationLanguage,title:l},!!this.translationContextValue.isTranslationActive,t.dt.Comments))}))}render(){return t.x`<div><slot></slot></div>`}};i=t._([t.e("search-comment-translator")],i);class r extends n.E{constructor(){super(...arguments),this._observedElementSelector="reddit-feed",this.handleMutationObserverChanges=t=>{this.translationContextValue?.isTranslationActive&&t.some((t=>!!t.addedNodes?.length))&&this.onTranslationsEnabled()},this.handleIntersectionObserverChanges=t=>{this.translationContextValue.isTranslationActive&&t.forEach((t=>{const e=this.getNodeId(t.target),s=e?this.translationCache.get(e):void 0;t.isIntersecting&&s&&!s.meta?.skipIntersectionObserver&&(this.trackTranslationViewed(s),this.translationCache.set(e,{...s,meta:{...s.meta||{},skipIntersectionObserver:!0}}),this._intersectionObserver.unobserve(t.target))}))}}disconnectedCallback(){super.disconnectedCallback(),this.disconnectObservers()}async onTranslationsEnabled(){this.isFetchingTranslations||(await this.fetchUntranslatedEntities(),this.renderTranslationCache(),this.connectObservers())}async onTranslationsDisabled(){this.isFetchingTranslations||(await this.fetchUntranslatedEntities(),this.renderTranslationCache(),this.disconnectObservers())}connectObservers(){this._mutationObserver||(this._mutationObserver=new MutationObserver(this.handleMutationObserverChanges));const t=document.querySelector(this._observedElementSelector);t&&this._mutationObserver.observe(t,{childList:!0}),this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.handleIntersectionObserverChanges,{root:null,threshold:.8})),this.translationCache.forEach((t=>{const e=t.node;t.meta?.skipIntersectionObserver||this._intersectionObserver.observe(e)}))}disconnectObservers(){this._mutationObserver?.disconnect?.(),this._intersectionObserver?.disconnect?.()}}const o='reddit-feed>*[source="search"][action="view"][noun="post"]',l='a[href*="/r/"]',d='a[data-testid="post-title-text"]',c="faceplate-screen-reader-content",h='a[data-testid="post-title"]',u="#feed-translation-title-";let T=class extends r{constructor(){super(...arguments),this.isDynamicSerp=!1,this.getNodeId=t=>{const e=t?.querySelector?.(l);return e?a.r(e):void 0}}connectedCallback(){super.connectedCallback(),this.isDynamicSerp&&(this._observedElementSelector="search-post-translator")}getTranslatableEntities(){const e=[],s=this.querySelectorAll(this.isDynamicSerp?`[data-testid="${t.du.searchSduiPost}"]`:o);return Array.from(s).forEach((t=>{const s=this.isDynamicSerp?a.e(t.getAttribute("data-thingid")||""):this.getNodeId(t);if(!s)return;const n=t.querySelector(d),i=t.querySelector("faceplate-screen-reader-content"),r=t.hasAttribute("data-pretranslated"),o={titleTextContent:i?.textContent?.trim(),titleHTML:n?.innerHTML};e.push({id:s,node:t,isTranslated:r,...r?{translatedValue:o}:{originalValue:o},render:(t,e,s)=>{const a=t.querySelector(d),n=t.querySelector(c),i=t.querySelector(h);a&&e.titleHTML&&(a.innerHTML=e.titleHTML),n&&e.titleTextContent&&(n.textContent=e.titleTextContent),i&&e.titleTextContent&&i?.setAttribute("aria-label",e.titleTextContent),s?t.setAttribute("data-translated",""):t.removeAttribute("data-translated")}})})),e}async fetchTranslatableEntities(e){const s=new FormData;s.append("includeTranslation",String(!!this.translationContextValue.isTranslationActive)),e.forEach((t=>{s.append("postIds[]",t.id)}));const a=await this.requestPartial("/svc/shreddit/translated-posts/",{method:t.bj.Post,body:s}),n=new Map;return(a||[]).forEach((t=>{const e=t.getAttribute("data-post-id"),s=t.querySelector(`${u}${e??""}`),a=s?.textContent?.trim?.();e&&a&&n.set(e,{title:a})})),e.map((t=>{const e=n.get(t.id),s={...t,meta:{}};if(e){const t={titleTextContent:e.title??"",titleHTML:e.title??""};this.translationContextValue.isTranslationActive?s.translatedValue=t:s.originalValue=t}return s}))}trackTranslationViewed(e){if(!e.translatedValue?.titleTextContent)return;const a={postId:e.id,title:e.translatedValue.titleTextContent,isPostTranslated:!!e.translatedValue,translationLanguage:this.translationLanguage};t.k(this,s.d(a,!!this.translationContextValue.isTranslationActive,t.dt.Posts))}render(){return t.x`<div><slot></slot></div>`}};t._([t.n({type:Boolean,attribute:"is-dynamic-serp"})],T.prototype,"isDynamicSerp",void 0),T=t._([t.e("search-post-translator")],T);const m='faceplate-tracker[source="search"][action="view"][noun="subreddit"], shreddit-subreddit-header',p='[id^="search-community-title-"], .i18n-subreddit-title',b='[data-testid="search-subreddit-desc-text"], .i18n-subreddit-description',g=t.dv;let C=class extends r{constructor(){super(...arguments),this.searchTranslationPage=t.dt.Subreddits,this.isReadyForTranslations=!1,this.getNodeId=t=>t.getAttribute("data-subredditid")||t.getAttribute("subreddit-id")||void 0}connectedCallback(){super.connectedCallback();const t=this.querySelector("shreddit-subreddit-header");!!t?.shadowRoot||!t?(this.isReadyForTranslations=!0,this.translationContextValue?.isTranslationActive&&this.onTranslationsEnabled()):this.addEventListener(g,this.onHeaderReady)}async onHeaderReady(t){"shreddit-subreddit-header"===t.detail?.name&&(this.isReadyForTranslations=!0,this.translationContextValue?.isTranslationActive&&this.onTranslationsEnabled())}async onTranslationsEnabled(){this.isReadyForTranslations&&super.onTranslationsEnabled()}getTranslatableEntities(){const t=this.querySelectorAll(m),e=[];return t.forEach((t=>{let s="",a=t.querySelector(p);a||(a=t.shadowRoot?.querySelector(p)||null);let n=t.querySelector(b);n?s=n?.innerHTML||"":(n=t.shadowRoot?.querySelector(b)||null,s=n?.textContent||"");const i=a?.id.split("search-community-title-")?.[1]||t.getAttribute("subreddit-id")||void 0,r=this.translationCache.get(i||"")?.translatedValue;if(r||!i||!n)return;n?.setAttribute("data-subredditid",i||"");const o={id:i,node:n,originalValue:s,meta:{viewEventFired:!1,subredditName:a?.textContent||""},render:(t,e,s)=>{t.innerHTML=e,s?t.setAttribute("data-translated",""):t.removeAttribute("data-translated")}};e.push(o)})),e}async fetchTranslatableEntities(t){return this.fetchArbitraryStrings(t)}trackTranslationViewed(e){t.k(this,s.t({id:e.id,name:e?.meta?.subredditName||"",isDescriptionsTranslated:""!==e.translatedValue,translationLanguage:this.translationLanguage},t.ar.SearchResults,this.searchTranslationPage))}render(){return t.x`<div> <slot></slot> </div>`}};t._([t.n({type:String,attribute:"search-translation-page"})],C.prototype,"searchTranslationPage",void 0),t._([t.j()],C.prototype,"isReadyForTranslations",void 0),C=t._([t.e("search-subreddit-translator")],C)}));
SML.di("./DuqlmJMEve.js",import.meta.url,"DuqlmJMEve");SML.di("./DAKDAikmKf.js",import.meta.url,"DAKDAikmKf");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DijGP8Hw3G.js",import.meta.url,"DijGP8Hw3G");SML.di("./Cke4oMIXaE.js",import.meta.url,"Cke4oMIXaE");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");
SML.dm("Cup7YLVD71",[],(async()=>{var i;return function(i){i.isAccessEnabled="isAccessEnabled",i.isAllAllowed="isAllAllowed",i.isChannelsEditingAllowed="isChannelsEditingAllowed",i.isChatConfigEditingAllowed="isChatConfigEditingAllowed",i.isChatOperator="isChatOperator",i.isCommunityChatEditingAllowed="isCommunityChatEditingAllowed",i.isConfigEditingAllowed="isConfigEditingAllowed",i.isFlairEditingAllowed="isFlairEditingAllowed",i.isMailEditingAllowed="isMailEditingAllowed",i.isPostEditingAllowed="isPostEditingAllowed",i.isWikiEditingAllowed="isWikiEditingAllowed"}(i||(i={})),{M:"mod-ban-modal-template",a:"mod-user-flair-modal-template",get b(){return i},c:"/svc/shreddit/mod-ban-modal",d:"/svc/shreddit/mod-mute-modal",e:"mod-action-button-title"}}));

SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CMNh7Qm-HC.js",import.meta.url,"CMNh7Qm-HC");SML.di("./zQvYWz_gjh.js",import.meta.url,"zQvYWz_gjh");SML.di("./CkEEx5T_uL.js",import.meta.url,"CkEEx5T_uL");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./BKIc7C4NNc.js",import.meta.url,"BKIc7C4NNc");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./CA7qO1Exxg.js",import.meta.url,"CA7qO1Exxg");SML.di("./BoQssu-hw1.js",import.meta.url,"BoQssu-hw1");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");
SML.dm("D-loTAz0IJ",["CYrPuvCiTj","CMNh7Qm-HC","zQvYWz_gjh","CkEEx5T_uL","wzdls1o9Kk","BKIc7C4NNc","BtqmVQuPYp","CA7qO1Exxg","BoQssu-hw1","C8CrqKCiqJ"],(async(t,e,i,r,s,l)=>{var o;let n=o=class extends t.s{constructor(){super(...arguments),this.isMobile=!1,this.navPlacement=e.N.INSIDE,this.startIndex=0,this.scrollThreshold=o.SCROLL_EDGE_THRESHOLD,this.autoplayInterval=0,this.showOnlyOnHover=!1,this.moveOneUnit=!1,this.autoplayTimerId=0,this.shouldDisplayLeftArrow=!1,this.shouldDisplayRightArrow=!0,this.childrenIndexList=[],this.childrenInViewIndexList=[],this.isUserScrolling=!1,this.isHovered=!1,this.galleryContainerRef=t.Z(),this.debouncedUpdateDisplayState=t.ae((()=>this.updateDisplayState()),100),this.trackScrollEvent=()=>{this.trackingScrollSan&&t.k(this,t.c(this.trackingScrollSan))},this.debouncedScrollTelemetry=t.ae(this.trackScrollEvent,100),this.onUserInteraction=()=>{this.isUserScrolling=!0},this.handleMouseEnter=()=>{this.isHovered=!0},this.handleMouseLeave=()=>{this.isHovered=!1},this.renderArrowButtonWithContainer=(e,i)=>{const r=e===l.G.Backward?"left-[8px]":"right-[8px]",s=this.showOnlyOnHover?this.isHovered&&i:i;return t.x`<span class="absolute top-[50%] -translate-y-1/2 hidden xs:inline ${r} ${(t=>t?"opacity-100 visible":"opacity-0 invisible")(s)}" role="button" @click="${t=>this.handleClickOnArrow(t,e)}" @keydown="${t=>this.handleKeyDownOnArrow(t,e)}"> ${this.renderArrowButton(e)} </span>`},this.onScrollEvent=()=>{this.isUserScrolling&&this.trackingScrollSan&&this.debouncedScrollTelemetry(),this.isUserScrolling&&this.clearAutoplay(),this.debouncedUpdateDisplayState()}}static get styles(){return[t.t,t.i`::slotted(*){scroll-snap-align:start}#list{scroll-padding:0 var(--scroll-padding);gap:0 var(--gallery-item-gap)}`]}connectedCallback(){super.connectedCallback(),requestAnimationFrame((()=>{this.setupScrollEventListener(),this.scrollToStartIndex(),this.addEventListener("pointerdown",this.onUserInteraction),this.addEventListener("wheel",this.onUserInteraction),this.addEventListener("click",this.clearAutoplay)})),this.setupAutoplay()}firstUpdated(){this.setUpResizeObserver(),this.scrollToStartIndex()}updated(t){t.has("startIndex")&&this.scrollToStartIndex(),t.has("autoplayInterval")&&this.setupAutoplay()}scrollToStartIndex(){this.scrollToIndex(this.startIndex,"instant")}disconnectedCallback(){this.galleryContainerRef.value&&this.galleryContainerRef.value.removeEventListener("scroll",this.onScrollEvent),this.resizeObserver?.unobserve(this),this.resizeObserver?.disconnect(),this.clearAutoplay(),this.removeEventListener("pointerdown",this.onUserInteraction),this.removeEventListener("wheel",this.onUserInteraction),this.removeEventListener("click",this.clearAutoplay),super.disconnectedCallback()}get _slottedChildren(){return this.shadowRoot.querySelector("slot").assignedElements({flatten:!0})}moveToNextElement(){const t=this.galleryContainerRef.value;if(!t)return;if(t.scrollLeft+t.clientWidth>=t.scrollWidth)this.scrollToIndex(0);else{const t=this.childrenInViewIndexList[0]+1;this.scrollToIndex(t)}}scrollToIndex(t,e="smooth"){const i=this.galleryContainerRef.value;if(i){const r=Math.max(0,Math.min(t,this._slottedChildren.length-1)),s=this._slottedChildren[r];if(s){const t=s.getBoundingClientRect(),r=i.getBoundingClientRect(),l=t.left-r.left+i.scrollLeft;i.scrollTo({left:l,behavior:e})}}}clearAutoplay(){this.autoplayTimerId&&(clearInterval(this.autoplayTimerId),this.autoplayTimerId=0)}setupAutoplay(){this.clearAutoplay(),this.autoplayInterval>0&&(this.autoplayTimerId=window.setInterval((()=>{this.moveToNextElement()}),this.autoplayInterval))}updateChildrenIndexLists(t){const e=[];this.childrenIndexList=[],this._slottedChildren.map(((i,r)=>{i.clientWidth>0&&(this.childrenIndexList.push(r),s.aV(i,t)&&e.push(r))})),this.childrenInViewIndexList=e}updateDisplayState(){const t=this.galleryContainerRef.value;if(!t)return;this.updateChildrenIndexLists(t);const e=t.scrollWidth-t.clientWidth;if(e<this.scrollThreshold)return this.shouldDisplayLeftArrow=!1,void(this.shouldDisplayRightArrow=!1);this.shouldDisplayLeftArrow=t.scrollLeft>this.scrollThreshold,this.shouldDisplayRightArrow=e-t.scrollLeft>this.scrollThreshold}handleClickOnArrow(i,r){i.stopPropagation(),this.clearAutoplay();if(!this.galleryContainerRef.value)return;const s=r===l.G.Backward;s&&this.trackingArgsBackArrow&&t.k(this,t.c(this.trackingArgsBackArrow)),!s&&this.trackingArgsForwardArrow&&t.k(this,t.c(this.trackingArgsForwardArrow)),this.moveOneUnit?this.moveByOneUnit(s):this.moveByVisibleChildren(s);const o=s?e.C.BACKWARDS:e.C.FORWARDS;this.dispatchEvent(new CustomEvent("faceplate-carousel:slide",{detail:{direction:o},bubbles:!0}))}moveByOneUnit(t){const e=this.childrenInViewIndexList[0],i=t?Math.max(e-1,0):Math.min(e+1,this.childrenIndexList.length-1);this.scrollToIndex(i)}moveByVisibleChildren(t){const e=this.childrenInViewIndexList[0],i=this.childrenInViewIndexList.length,r=t?Math.max(e-i-1,0):Math.min(e+i,this.childrenIndexList.length-1);this.scrollToIndex(r)}handleKeyDownOnArrow(t,e){"Enter"===t.code&&this.handleClickOnArrow(t,e)}renderArrowButton(s){const o=s===l.G.Backward,n=o?!this.shouldDisplayLeftArrow:!this.shouldDisplayRightArrow,a=o?i.c:r.c,h=o?"Previous":"Next";return t.u({appearance:this.navPlacement===e.N.INSIDE?"media":"secondary",size:t.v.Small,leadingIcon:a({size:t.I.Small}),attributes:{"aria-label":h,onclick:t=>this.handleClickOnArrow(t,s),className:"hidden xs:block shrink-0",disabled:n}})}render(){const i="flex flex-row w-full overflow-x-scroll list-none m-0 p-0 scrollbar-hide snap-mandatory snap-x scroll-smooth";return this.isMobile?t.x`<div class="relative"> <ul id="list" class="${i}"> <slot></slot> </ul> </div>`:this.navPlacement===e.N.OUTSIDE?t.x` <div class="flex items-center gap-xs"> ${this.renderArrowButton(l.G.Backward)} <ul ${t.$(this.galleryContainerRef)} id="list" class="${i}"> <slot></slot> </ul> ${this.renderArrowButton(l.G.Forward)} </div> `:t.x`<div class="relative" @mouseenter="${this.handleMouseEnter}" @mouseleave="${this.handleMouseLeave}"> <ul ${t.$(this.galleryContainerRef)} id="list" class="${i}"> <slot></slot> </ul> ${this.renderArrowButtonWithContainer(l.G.Backward,this.shouldDisplayLeftArrow)} ${this.renderArrowButtonWithContainer(l.G.Forward,this.shouldDisplayRightArrow)} </div>`}setupScrollEventListener(){!this.isMobile&&this.galleryContainerRef.value&&(this.galleryContainerRef.value.addEventListener("scroll",this.onScrollEvent,{passive:!0}),this.updateDisplayState())}setUpResizeObserver(){!this.isMobile&&this.galleryContainerRef.value&&(this.resizeObserver=new ResizeObserver(this.debouncedUpdateDisplayState),this.resizeObserver.observe(this.galleryContainerRef.value,{box:"content-box"}))}};return n.SCROLL_EDGE_THRESHOLD=30,t._([t.n({type:Boolean,attribute:"is-mobile"})],n.prototype,"isMobile",void 0),t._([t.n({type:String,attribute:"nav-placement"})],n.prototype,"navPlacement",void 0),t._([t.n({type:Number,attribute:"start-index"})],n.prototype,"startIndex",void 0),t._([t.n({type:Number,attribute:"scroll-threshold"})],n.prototype,"scrollThreshold",void 0),t._([t.n({type:Number,attribute:"autoplay-interval"})],n.prototype,"autoplayInterval",void 0),t._([t.n({type:Boolean,attribute:"show-only-on-hover"})],n.prototype,"showOnlyOnHover",void 0),t._([t.n({type:Object,attribute:"tracking-args-forward-arrow"})],n.prototype,"trackingArgsForwardArrow",void 0),t._([t.n({type:Object,attribute:"tracking-args-back-arrow"})],n.prototype,"trackingArgsBackArrow",void 0),t._([t.n({type:Object,attribute:"tracking-scroll-san"})],n.prototype,"trackingScrollSan",void 0),t._([t.n({type:Boolean,attribute:"move-one-unit"})],n.prototype,"moveOneUnit",void 0),t._([t.j()],n.prototype,"autoplayTimerId",void 0),t._([t.j()],n.prototype,"shouldDisplayLeftArrow",void 0),t._([t.j()],n.prototype,"shouldDisplayRightArrow",void 0),t._([t.j()],n.prototype,"childrenIndexList",void 0),t._([t.j()],n.prototype,"childrenInViewIndexList",void 0),t._([t.j()],n.prototype,"isUserScrolling",void 0),t._([t.j()],n.prototype,"isHovered",void 0),n=o=t._([t.e("shreddit-gallery-carousel")],n),{get ShredditGalleryCarousel(){return n}}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CEkHpZAUVH.js",import.meta.url,"CEkHpZAUVH");SML.di("./B7CRAos5Iy.js",import.meta.url,"B7CRAos5Iy");SML.di("./BJdHdrH8mb.js",import.meta.url,"BJdHdrH8mb");SML.di("./CXOS1kNFW2.js",import.meta.url,"CXOS1kNFW2");
SML.dm("D9WsnGY-GI",["CYrPuvCiTj","CEkHpZAUVH","B7CRAos5Iy","BJdHdrH8mb","CXOS1kNFW2"],(async e=>{let t=class extends e.s{constructor(){super(...arguments),this.openBottomSheet=async e=>{e.stopPropagation(),this.partial&&(await (this.partial?.load())),this.bottomSheet.showModal()},this.close=()=>{this.bottomSheet.close()}}get partial(){return this.shadowRoot?.querySelector('slot[name="content"]')?.assignedNodes({flatten:!0})[0].querySelector("faceplate-partial")}render(){return e.x`<slot @touchstart="${this.openBottomSheet}"></slot><faceplate-bottom-sheet> <faceplate-bottom-sheet-header slot="header" has-divider> <span slot="trailing"> ${e.u({appearance:"secondary",leadingIcon:e.al({size:e.I.Small,attributes:{className:"inline-flex"}}),size:e.v.Small,attributes:{onclick:this.close}})}</span> ${"Mod actions"}</faceplate-bottom-sheet-header> <slot @click="${this.close}" name="content"></slot> <input autofocus type="hidden"> </faceplate-bottom-sheet>`;}};t.styles=[e.t],e._([e.Y("faceplate-bottom-sheet")],t.prototype,"bottomSheet",void 0),t=e._([e.e("user-mod-actions-bottom-sheet")],t)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CXJ58rbE8s.js",import.meta.url,"CXJ58rbE8s");SML.di("./BBSbW5jO-u.js",import.meta.url,"BBSbW5jO-u");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");
SML.dm("DEMzfTzoPS",["CYrPuvCiTj","CXJ58rbE8s","BBSbW5jO-u","wzdls1o9Kk"],(async(e,t,n,o)=>{const i=(t,n)=>e.c({source:o.at,action:o.aI,noun:t},{action_info:{source_name:n??"unknown"}});return {A:class{constructor(t){this.host=t,this.beginOIDCLogin=async e=>{if(!e)return;const t=await this.getOIDCProviderLoginUrl(e);t&&this.redirectToOIDCLogin(t)},this.redirectToOIDCLogin=e=>{window.location.assign(e)},this.dispatchSSOError=e=>{const t=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();this.dispatchError(`Something went wrong interacting with ${t}`,`auth-flow-provider-error-${e}`)},this.dispatchError=(t,n,o=e.a0.error)=>{const i=e.d("faceplate-alert",{level:o,message:t,cause:n});this.host.dispatchEvent(i)},this.host.addController(this)}hostConnected(){this.authFlowManager=document.querySelector("auth-flow-manager")}async show(t,n){const o=e.d("auth-flow-loading:start",{step:t});if(this.host.dispatchEvent(o),o.defaultPrevented)return;return (await (this.authFlowManager?.show(t, n)))?(this.host.dispatchEvent(e.d("auth-flow-loading:success",{step:t})),!0):(this.host.dispatchEvent(e.d("auth-flow-loading:error",{step:t})),!1);}back(){this.authFlowManager?.back()}close(){this.authFlowManager?.close()}async checkIsOIDCRequired(t){if(!t)return!1;try{const n=window.location.origin,o=new URL(e.db.CheckIsOIDCRequired,n),i=await fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userIdentifier:t,csrf_token:e.am.get("csrf_token")})}),r=await i.json();if(i.ok)return r.is_sso||!1;throw new Error(r.error?.message||"Unknown error",{cause:r.error?.code||"unknown"})}catch(e){return window.Sentry?.captureError?.(e),!1}}async getOIDCProviderLoginUrl(t){if(!t)return null;const n=this.determineDestinationURL();try{const o=window.location.origin,i=new URL(e.db.GetOIDCProviderLoginUrl,o),r=await fetch(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userIdentifier:t,destination:n,csrf_token:e.am.get("csrf_token")})}),a=await r.json();if(r.ok)return a.redirect_url||null;throw new Error(a.error?.message||"Unknown error",{cause:a.error?.code||"unknown"})}catch(e){return window.Sentry?.captureError?.(e),null}}async setOIDCAccountPickerChoice(t,n){if(!t||!n)return null;try{const o=window.location.origin,i=new URL(e.db.SetOIDCAccountPickerChoice,o),r=await fetch(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({accountId:t,selectorSessionToken:n,csrf_token:e.am.get("csrf_token")})}),a=await r.json();if(r.ok)return a.dest||null;throw new Error(a.error?.message||"Unknown error",{cause:a.error?.code||"unknown"})}catch(e){return window.Sentry?.captureError?.(e),null}}get currentPage(){return window.location.href}get currentPath(){return window.location.pathname}get homePage(){return window.location.origin}determineDestinationURL(){const n=this.currentPage,o=this.currentPath,i=this.homePage;let r=n;o.match(e.cG)&&(r=i);try{const e=new URL(n).searchParams.get("dest");if(e){const n=new URL(e).toString();t.i(n)&&(r=n)}}catch(e){}return r}setLoginDestination(e){if(!e)return;const t=new URL(this.currentPage);t.searchParams.set("dest",e),window.history.replaceState(null,"",t.toString())}async identityProviderSigin(t){try{e.k(this.host,i("sso_signin",t.authFlow));const n=await fetch(e.db.IdentityProviderSignin,{method:"POST",headers:{Accept:"application/json, text/vnd.reddit.partial+html","Content-Type":"application/json"},body:JSON.stringify({idToken:t.idToken,canCreate:Boolean(!t.isSignedInAutomatically),recaptchaToken:t.recaptchaToken,recaptchaAction:t.recaptchaAction,subscribeToEmailDigest:t.subscribeToEmailDigest,email:t.email,authFlow:t.authFlow,csrf_token:e.am.get("csrf_token"),auth_modularity:!0})}),o=e.dc(n);switch(n.status){case e.dd.UserAccountCreated:this.handleSSOAccountResolved({authFlow:t.authFlow||e.q.Unknown,provider:t.provider,operation:"signin",newAccountCreated:!0,requireEmailPermission:t.emailPermissionRequired,subscribeToEmailDigest:t.subscribeToEmailDigest});break;case e.dd.UserLoggedIn:this.handleSSOAccountResolved({authFlow:t.authFlow||e.q.Unknown,provider:t.provider,operation:"signin",newAccountCreated:!1});break;case e.dd.MultipleAccountsFound:{if(!o?.includes("json"))break;const{accounts:i}=await n.json();if(!i||0===i.length)break;const r={accounts:JSON.stringify(i),idToken:t.idToken,subscribeToEmailDigest:JSON.stringify(t.subscribeToEmailDigest),email:t.email,authFlow:t.authFlow??e.q.Unknown};this.show(e.q.SSOLinking,{bodyParams:r});break}case e.dd.GoogleCredentialMismatch:e.de(t.email);break;default:if("text/vnd.reddit.partial+html"===o){const t=await n.text();e.aV(t,this.host,e.P.Append)}else n.ok||this.dispatchSSOError(t.provider)}}catch(e){this.dispatchSSOError(t.provider)}}handleSSOAccountResolved(t){const o=`${t.operation}_${t.newAccountCreated?"register":"login"}`;if(e.k(this.host,n.a(t.authFlow,t.provider,o)),this.skipOnboardingFlowEventDispatcher(t.authFlow),t.newAccountCreated){const n=t.requireEmailPermission&&!t.subscribeToEmailDigest;this.show(e.q.Onboarding,{bodyParams:{showEmailPermission:encodeURIComponent(n??!1)}})}else this.reloadToLoggedIn(t.newAccountCreated)}skipOnboardingFlowEventDispatcher(e){const t=new CustomEvent("skip-onboarding-flow",{bubbles:!0,composed:!0,detail:{authFlow:e}});this.host.dispatchEvent(t),t.defaultPrevented}async reloadToLoggedIn(e=!1){const t=new CustomEvent("auth-completed",{bubbles:!0,composed:!0});this.host.dispatchEvent(t),t.defaultPrevented||this.authFlowManager?.reloadToLoggedIn(e)}trackSSOFailure(t){const{authFlow:n,provider:o,reason:i}=t;e.k(this.host,((t,n,o)=>e.c({source:"onboarding",action:"fail",noun:t},{action_info:{reason:o,type:n}}))(n,o,i)),window.Sentry?.withScope((e=>{e.setExtra("flow",n),e.setExtra("provider",o),e.setExtra("reason",i),window.Sentry?.captureMessage("SSO authentication failed")})),this.dispatchSSOError(o)}},a:(t,n)=>e.c({source:"onboarding",action:"click",noun:t},{action_info:{type:n}}),b:i,s:t=>e.c({action:"select",noun:"link_account",source:o.at},{target_user:{id:t}})};}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DKP07AmMm9.js",import.meta.url,"DKP07AmMm9");SML.di("./Bu_0OLU9_w.js",import.meta.url,"Bu_0OLU9_w");
SML.dm("DEgnJa98M9",["CYrPuvCiTj","DKP07AmMm9","Bu_0OLU9_w"],(async(e,t,s)=>{const r="data-measured";class i{constructor(e){this.measureGridItem=e=>{if("FACEPLATE-PARTIAL"!==e.tagName){const t=e.querySelector(`[data-id="${s.a}"]`)?.getBoundingClientRect().height;t&&(e.style.gridRowEnd=`span ${Math.ceil(t/20)}`),this.resizeObserver.observe(e)}e.setAttribute(r,"")},this.handleUnmeasuredGridItems=e=>{e?.forEach(this.measureGridItem),this.host.requestUpdate()},this.resetGridItem=e=>{e.removeAttribute(r),this.resizeObserver.unobserve(e),e.style.gridRowEnd=""},this.resetMeasuredItems=e=>{e.forEach(this.resetGridItem)},(this.host=e).addController(this),this.resizeObserver=new ResizeObserver((e=>e.forEach((e=>this.measureGridItem(e.target)))))}hostConnected(){}hostDisconnected(){this.resizeObserver.disconnect()}}const a="search-media-feed";let d=class extends t.R{constructor(){super(...arguments),this.mediaGridController=new i(this),this.handleUnmeasuredGridItems=()=>{this.unmeasuredItems&&this.mediaGridController.handleUnmeasuredGridItems(this.unmeasuredItems)}}static get styles(){return[e.t,e.i`::slotted(faceplate-tracker:not([data-measured])){visibility:hidden}::slotted(faceplate-partial:not([data-measured])){display:none}@media (max-width:767px){::slotted(faceplate-partial){grid-column-end:span 2}}@media (min-width:768px){::slotted(faceplate-partial){grid-column-end:span 3}}`]}findSiblingGrid(){if(!this.parentElement)return;return[...this.parentElement.querySelectorAll(a)].find((e=>e!==this))}firstUpdated(){const e=this.findSiblingGrid();if(e){const t=document.createDocumentFragment();this.unmeasuredItems?.forEach((e=>t.appendChild(e))),e.appendChild(t),this.parentElement?.removeChild(this)}else this.handleUnmeasuredGridItems(),this.container.getAttribute("data-measured")||this.container.setAttribute("data-measured","")}render(){return e.x`<div aria-labelledby="${this.label}" aria-busy="${this.busy}" role="feed" class="grid grid-cols-2 xs:grid-cols-3 gap-md px-md xs:px-0"> <slot @slotchange="${this.handleUnmeasuredGridItems}"></slot> </div>`}};e._([e.Y("div")],d.prototype,"container",void 0),e._([e.r({flatten:!0,selector:`:not([${r}])`})],d.prototype,"unmeasuredItems",void 0),d=e._([e.e(a)],d)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("DKP07AmMm9",["CYrPuvCiTj"],(async e=>{let t=class extends e.s{constructor(){super(),this.label="",this.loadingCounter=0,this._events=new e.E(this),this._events.define("faceplate-request",(()=>this.loadingCounter++)),this._events.define("faceplate-response",(()=>this.loadingCounter--))}get busy(){return this.loadingCounter>0}render(){return e.x`<div aria-labelledby="${this.label}" aria-busy="${this.busy}" role="feed"> <slot></slot> </div>`}};return e._([e.n()],t.prototype,"label",void 0),e._([e.j()],t.prototype,"loadingCounter",void 0),t=e._([e.e("reddit-feed")],t),{get R(){return t}}}));
SML.di("./G2F6lxYj4X.js",import.meta.url,"G2F6lxYj4X");SML.di("./0oWl-8XRpj.js",import.meta.url,"0oWl-8XRpj");SML.di("./yUnv2--rmc.js",import.meta.url,"yUnv2--rmc");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");
SML.di("./C-PXJvnKib.js",import.meta.url,"C-PXJvnKib");SML.di("./hrqH5pRvGY.js",import.meta.url,"hrqH5pRvGY");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("DXjwz3hl6z",["CYrPuvCiTj"],(async a=>{let t=class extends a.s{constructor(){super(...arguments),this.data={}}connectedCallback(){super.connectedCallback(),a.p(a.T.PageDataLoaded,this.data)}};a._([a.n({type:Object})],t.prototype,"data",void 0),t=a._([a.e("reddit-page-data")],t)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DEMzfTzoPS.js",import.meta.url,"DEMzfTzoPS");
SML.dm("DbMJq2WLcl",["CYrPuvCiTj","DEMzfTzoPS"],(async(e,a)=>{let t=class extends e.s{constructor(){super(...arguments),this.paramName=e.G,this.authFlowController=new a.A(this)}get hasUrlParam(){return new URL(window.location.href).searchParams.has(this.paramName)}firstUpdated(){this.hasUrlParam&&this.openAuthFlow()}onClickRegisterInterest(){if(this.openAuthFlow(),!this.hasUrlParam){const e=new URL(window.location.href);e.searchParams.append(this.paramName,""),window.history.replaceState(null,"",e.href)}}openAuthFlow(){this.authFlowController.show(e.q.AnswersRegister)}};e._([e.n({type:String,attribute:"param-name"})],t.prototype,"paramName",void 0),t=e._([e.e("guides-url-param-appender")],t)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("DjFB9ftmDo",["CYrPuvCiTj"],(async e=>{var t;class a{}t=a,a.setAccountPreference=async t=>{await e.ag({operation:e.af.UpdateSearchPreferences,variables:{input:{safeSearch:t}}})},a.handleUpdate=async({value:a,country:r})=>{if(!a)return;e.g()?await t.setAccountPreference(a):e.ao({country:r,name:e.g$,value:a,options:e.b1})};let r=class extends e.s{constructor(){super(...arguments),this.country="",this.href="",this.handleNavigation=()=>{window.location.href=this.href},this.handleClick=async e=>{e.preventDefault(),this.faceplateClickTracker?.trackEvent(),await a.handleUpdate(this),this.handleNavigation()}}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.handleClick)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.handleClick)}createRenderRoot(){return this}};e._([e.n({type:String,attribute:"value"})],r.prototype,"value",void 0),e._([e.n({type:String,attribute:"country"})],r.prototype,"country",void 0),e._([e.n({type:String,attribute:"href"})],r.prototype,"href",void 0),e._([e.Y(`faceplate-tracker[loading-strategy=${e.C.Programmatic}]`)],r.prototype,"faceplateClickTracker",void 0),r=e._([e.e("safe-search-option-click-handler")],r)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DuqlmJMEve.js",import.meta.url,"DuqlmJMEve");SML.di("./D0lCIVsZym.js",import.meta.url,"D0lCIVsZym");SML.di("./CPEjWpDINz.js",import.meta.url,"CPEjWpDINz");SML.di("./nfXvUbiTZI.js",import.meta.url,"nfXvUbiTZI");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./Bu_0OLU9_w.js",import.meta.url,"Bu_0OLU9_w");SML.di("./buPlOxYAo2.js",import.meta.url,"buPlOxYAo2");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");SML.di("./DdQ8ToexAC.js",import.meta.url,"DdQ8ToexAC");SML.di("./CEkHpZAUVH.js",import.meta.url,"CEkHpZAUVH");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./CZtlI9NlXS.js",import.meta.url,"CZtlI9NlXS");SML.di("./Bu5yqfYL_w.js",import.meta.url,"Bu5yqfYL_w");SML.di("./Bq3qdqopCU.js",import.meta.url,"Bq3qdqopCU");SML.di("./NMIRxeD8JS.js",import.meta.url,"NMIRxeD8JS");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");SML.di("./D-loTAz0IJ.js",import.meta.url,"D-loTAz0IJ");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./DijGP8Hw3G.js",import.meta.url,"DijGP8Hw3G");SML.di("./DJaop39KNp.js",import.meta.url,"DJaop39KNp");SML.di("./BnnXQUvIiN.js",import.meta.url,"BnnXQUvIiN");
SML.dm("Dr6iqxLOkn",["CYrPuvCiTj","D0lCIVsZym","CPEjWpDINz","nfXvUbiTZI","C8CrqKCiqJ","Bu_0OLU9_w","buPlOxYAo2","nZA40q2akY","DdQ8ToexAC","wzdls1o9Kk","Bu5yqfYL_w","Bq3qdqopCU","NMIRxeD8JS","005PrA1Byk","JaGlTj3I-9","DJaop39KNp","DuqlmJMEve","CEkHpZAUVH","CZtlI9NlXS","D-loTAz0IJ","DijGP8Hw3G","BnnXQUvIiN"],(async(e,t,s,i,n,r,a,o,l,d,u,c,h,p,m,g)=>{var b;!function(e){e.Guides="guides"}(b||(b={}));const v=`${i.G}/click/post`;let f=class extends e.s{constructor(){super(...arguments),this._partialRequestController=new e.aU(this),this.postIds="",this.conversationId="",this.followupIndex=0,this.question="",this.translationLanguage="",this.isLoading=!1,this.handleEvents=t=>{const s=t.detail;return e.bc(s)===v&&this.telemetryContext&&(s.search=this.telemetryContext),s},this.getAndRenderPostListPartial=async()=>{if(!this.postIds||this.isLoading)return;this.isLoading=!0,this.telemetryContext=i.g({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}).search;const t=this.getRecommendedPostsUrl(),s=await this._partialRequestController.request(t),n=await(s?.text());if(n){const t=(new DOMParser).parseFromString(n,"text/html").getElementById(e.iL);t?.innerHTML&&e.aV(t?.innerHTML,this,e.P.Append)}this.isLoading=!1},this.getRecommendedPostsUrl=()=>{const t=this.translationLanguage?`?${e.iO}=${this.translationLanguage}`:"";return`${e.jm}/${this.postIds}${t}`}}connectedCallback(){super.connectedCallback(),this.addEventListener("faceplate-track",this.handleEvents)}disconnectedCallback(){super.disconnectedCallback?.(),this.removeEventListener("faceplate-track",this.handleEvents)}async firstUpdated(){await this.getAndRenderPostListPartial()}render(){return this.isLoading?e.x` <div class="flex gap-xs flex-nowrap xs:flex-wrap"> <faceplate-shimmer class="h-[6rem] w-[20rem]" shape="pill"></faceplate-shimmer><faceplate-shimmer class="h-[6rem] w-[20rem]" shape="pill"></faceplate-shimmer> </div>`:e.x`<slot></slot>`}};f.styles=[e.t],e._([e.n({type:String,attribute:"post-ids"})],f.prototype,"postIds",void 0),e._([e.n({type:String,attribute:"conversation-id"})],f.prototype,"conversationId",void 0),e._([e.n({type:Number,attribute:"followup-index"})],f.prototype,"followupIndex",void 0),e._([e.n({type:String})],f.prototype,"question",void 0),e._([e.n({type:String,attribute:"translation-language"})],f.prototype,"translationLanguage",void 0),e._([e.j()],f.prototype,"isLoading",void 0),e._([e.r()],f.prototype,"slottedElements",void 0),f=e._([e.e("guides-post-list")],f);const k=()=>e.x` <div id="${e.jn}" class="bg-neutral-background-container hover:bg-neutral-background-container-hover rounded-4 p-sm py-xs flex items-center gap-xs max-w-[400px]"> <div class="flex relative h-[28px] w-[69px] min-w-[69px]"> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-0 bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-[1.25rem] bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-[2.5rem] bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> </div> <div class="text-12 xs:text-14 text-secondary-plain-weak flex-1"> ${"Searching Reddit communities..."} </div> <div class="flex">${s.c({size:e.I.Medium})}</div> </div>`,y=t=>e.x` <div id="${e.jn}" class="p-2xs flex items-center gap-xs"> <div class="flex relative h-[28px] w-[69px] min-w-[69px]"> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-0 bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-[1.25rem] bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> <span class="inline-flex items-center justify-center w-[1.5rem] h-[1.5rem] absolute top-0 left-[2.5rem] bg-white rounded-full p-[2px]"> <faceplate-shimmer class="w-full h-full" shape="circle"></faceplate-shimmer> </span> </div> <div class="text-12 xs:text-14 text-secondary-plain-weak flex-1">${t}</div> </div>`,R=new Set([`${i.G}/view/sources`,`${i.G}/click/sources`]);let x=class extends e.s{constructor(){super(...arguments),this._partialRequestController=new e.aU(this),this.postIds="",this.conversationId="",this.followupIndex=0,this.translationLanguage="",this.question="",this.serpStreamingText="",this.serpLoadingText="",this.isLoading=!1,this.getAndRenderSourcesPartial=async()=>{if(!this.postIds||this.isLoading)return;this.isLoading=!0,this.telemetryContext=i.g({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}).search;const t=this.getRecommendedPostsUrl(),s=await this._partialRequestController.request(t),n=await(s?.text());if(n){const t=(new DOMParser).parseFromString(n,"text/html").getElementById(e.jo);t?.innerHTML&&e.aV(t?.innerHTML,this,e.P.Append)}this.isLoading=!1},this.getRecommendedPostsUrl=()=>{const t=this.translationLanguage?`&${e.iO}=${this.translationLanguage}`:"",s=this.serpStreamingText?`&streaming_text=${encodeURIComponent(this.serpStreamingText)}`:"";return`${e.jm}/${this.postIds}?${e.jp}=true${t}${s}`},this.handleEvents=t=>{const s=t.detail;return R.has(e.bc(s))&&(s.search=this.telemetryContext),s}}connectedCallback(){super.connectedCallback(),this.addEventListener("faceplate-track",this.handleEvents)}disconnectedCallback(){super.disconnectedCallback?.(),this.removeEventListener("faceplate-track",this.handleEvents)}async firstUpdated(){await this.getAndRenderSourcesPartial()}render(){return this.isLoading?this.serpLoadingText?y(this.serpLoadingText):k():e.x`<slot></slot>`}};x.styles=[e.t],e._([e.n({type:String,attribute:"post-ids"})],x.prototype,"postIds",void 0),e._([e.n({type:String,attribute:"conversation-id"})],x.prototype,"conversationId",void 0),e._([e.n({type:Number,attribute:"followup-index"})],x.prototype,"followupIndex",void 0),e._([e.n({type:String,attribute:"translation-language"})],x.prototype,"translationLanguage",void 0),e._([e.n({type:String})],x.prototype,"question",void 0),e._([e.n({type:String,attribute:"serp-streaming-text"})],x.prototype,"serpStreamingText",void 0),e._([e.n({type:String,attribute:"serp-loading-text"})],x.prototype,"serpLoadingText",void 0),e._([e.j()],x.prototype,"isLoading",void 0),e._([e.r()],x.prototype,"slottedElements",void 0),x=e._([e.e("guides-sources-container")],x);const I=()=>{const t=e.a6.getItem(e.a7.GuidesQueryHistory);return t?JSON.parse(t):[]},w=t=>{const s=S(t).sort(((e,t)=>new Date(t.dateStr).getTime()-new Date(e.dateStr).getTime())).slice(0,9);try{e.a6.setItem(e.a7.GuidesQueryHistory,JSON.stringify(s))}catch(e){console.error(`Unable to save the "${s.map((e=>e.query)).join(",")}" queries into the query history. Details: ${e}`)}},S=e=>Array.from(new Map(e.map((e=>[e.query,e]))).values());class T{constructor({source:e,action:t,noun:s}){this.source=e,this.action=t,this.noun=s}getSan(){return[this.source,this.action,this.noun].join("/")}}const N=new T({source:i.G,action:i.V,noun:"product_image_fallback"}),$=new T({source:i.G,action:i.V,noun:i.P}),C=new T({source:i.G,action:i.C,noun:i.P}),E=new T({source:i.G,action:i.V,noun:"product_details"}),P=new T({source:i.G,action:i.C,noun:"product_retailer"}),L=new T({source:i.G,action:i.C,noun:"product_search_submit"}),_=new T({source:i.G,action:i.C,noun:i.b}),A=new T({source:i.G,action:i.C,noun:i.S}),j=new T({source:i.G,action:i.V,noun:i.S}),D=new T({source:i.G,action:i.C,noun:i.c}),O=new T({source:i.G,action:i.C,noun:i.U}),U=new T({source:i.G,action:i.V,noun:i.d.noun}),z=new T({source:i.G,action:i.V,noun:i.R}),M=new T({source:i.G,action:i.C,noun:i.R}),H=new T({source:i.G,action:i.V,noun:i.R}),Q=new T({source:i.G,action:i.C,noun:i.R}),q=new T({source:i.G,action:i.V,noun:i.R}),G=new T({source:i.G,action:i.C,noun:i.R});var F;!function(e){e.realtime="realtime",e.streaming="streaming"}(F||(F={}));const B=new Set([N.getSan(),$.getSan(),C.getSan(),_.getSan(),A.getSan(),j.getSan(),D.getSan(),O.getSan(),U.getSan(),z.getSan(),M.getSan(),H.getSan(),Q.getSan(),q.getSan(),G.getSan()]),V=(t,s)=>{const i=t.detail,n=e.bc(i);return B.has(n)&&(i.search=s),i};let Z=class extends e.s{constructor(){super(...arguments),this.question="",this.conversationId="",this.userId="",this.followupIndex=0,this.isUserLoggedIn=!1,this.userHasPremium=!1,this.useSourcesContainer=!1,this.premiumDailyQuota=e.jq,this.showDisclaimerLink=!1,this.recommendedQuestions=[],this.source=e.iD.Answers,this.responseRelatedPosts=[],this.isUserReachedQueryLimit=!1,this.translationLanguage="",this.pubsub=new e.z(this),this._trackEvent=t=>e.k(this,t),this.renderQuestion=t=>{this.pubsub.publish(e.T.GuidesRenderNewQuestionContainer,{currentQuestion:t,followupIndex:this.followupIndex+1})},this.askQuestion=async t=>{this.renderQuestion(t),this.pubsub.publish(e.T.GuidesSuggestionLoadingStarted),this._trackEvent((({conversationId:t,position:s,searchQuery:n,source:r=i.G})=>{const a={...i.g({conversationId:t,position:s,searchQuery:n})};return e.c({source:r,action:i.C,noun:"recommended_followup"},a)})({conversationId:this.conversationId,position:this.followupIndex+1,searchQuery:t}))},this.renderSuggestionButton=(t,s=!1)=>e.x`<button class="appearance-none bg-transparent border-0 ${s?"":"border-b-sm"} text-neutral-content border-solid w-full text-14 border-neutral-border-weak p-0 m-0 pb-2xs cursor-pointer pt-md font-semibold font-inherit outline-none shadow-none flex justify-between" @click="${()=>this.askQuestion(t)}"> ${t} ${o.c({size:e.I.Medium})} </button>`,this.renderRecommendedQuestions=()=>this.shouldHideSuggestionsPanel||0===this.recommendedQuestions.length?e.A:e.x`<div class="mx-0 pb-xs flex flex-col overflow-auto mt-lg"> <div class="text-16 text-neutral-content font-bold"> ${"Related"} </div> ${this.recommendedQuestions.map(((e,t)=>{const s=t===this.recommendedQuestions.length-1;return this.renderSuggestionButton(e,s)}))} </div>`}get shouldHideSuggestionsPanel(){return!this.conversationId||this.isUserReachedQueryLimit}};e._([e.n({type:String})],Z.prototype,"question",void 0),e._([e.n({type:String,attribute:"conversation-id"})],Z.prototype,"conversationId",void 0),e._([e.n({type:String,attribute:"user-id"})],Z.prototype,"userId",void 0),e._([e.n({type:Number,attribute:"followup-index"})],Z.prototype,"followupIndex",void 0),e._([e.n({type:Boolean,attribute:"is-desktop"})],Z.prototype,"isDesktop",void 0),e._([e.n({type:Boolean,attribute:"is-user-logged-in"})],Z.prototype,"isUserLoggedIn",void 0),e._([e.n({type:Boolean,attribute:"user-has-premium"})],Z.prototype,"userHasPremium",void 0),e._([e.n({type:Boolean,attribute:"use-sources-container"})],Z.prototype,"useSourcesContainer",void 0),e._([e.n({type:Number,attribute:"premium-daily-quota"})],Z.prototype,"premiumDailyQuota",void 0),e._([e.n({type:Boolean,attribute:"show-disclaimer-link"})],Z.prototype,"showDisclaimerLink",void 0),e._([e.n({type:Array,attribute:"recommended-questions"})],Z.prototype,"recommendedQuestions",void 0),e._([e.n({type:String})],Z.prototype,"source",void 0),e._([e.j()],Z.prototype,"responseRelatedPosts",void 0),e._([e.j()],Z.prototype,"isUserReachedQueryLimit",void 0),Z=e._([e.e("guides-response-container-base")],Z);const K="https://support.reddithelp.com/hc/articles/360058309512-How-do-I-report-a-post-or-comment",J="report-link",W=[{name:"outdated",getText:()=>"Outdated"},{name:"off-topic",getText:()=>"Off-topic"},{name:"redundant",getText:()=>"Redundant"},{name:"lacking detail",getText:()=>"Lacking Detail"}];let Y=class extends e.s{constructor(){super(...arguments),this.question="",this.conversationId="",this.followupIndex=0,this.voteState=0,this.showUnhelpfulReasons=!1,this.unhelpfulReasons=new Set,this.unhelpfulReasonsPanel=e.Z(),this.bottomSheetRef=e.Z(),this.scrollToUnhelpfulReasonsPanel=()=>{this.unhelpfulReasonsPanel.value?.scrollIntoView({block:"center",behavior:"smooth"})},this.onUpvoteClick=()=>{this.voteState=1},this.onDownvoteClick=()=>{this.voteState=-1,this.showUnhelpfulReasons=!0,this.isDesktop||this.bottomSheetRef.value?.showModal()},this.toggleUnhelpfulReason=e=>{this.unhelpfulReasons.has(e)?this.unhelpfulReasons.delete(e):this.unhelpfulReasons.add(e),this.requestUpdate()},this.renderUnhelpfulReactionButton=(t,s)=>e.u({attributes:{className:this.unhelpfulReasons.has(t)?"active":"",onclick:()=>this.toggleUnhelpfulReason(t)},children:s,appearance:"bordered",shape:"pill",size:e.v.Small}),this.closeUnhelpfulReasonsPanel=()=>{this.showUnhelpfulReasons=!1,this.unhelpfulReasons=new Set,this.isDesktop||this.bottomSheetRef.value?.close()},this.handleSubmitUnhelpfulReasons=()=>{e.k(this,(({conversationId:t,position:s,searchQuery:n,reason:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{reason:r}};return e.c({source:a,action:i.C,noun:"submit_feedback_negative_reasons"},o)})({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question,reason:[...this.unhelpfulReasons].join(", ")})),this.showFeedbackSubmittedToast(),this.closeUnhelpfulReasonsPanel()},this.renderUnhelpfulReasonsPanel=()=>e.x`<div ${e.$(this.unhelpfulReasonsPanel)} class="bg-neutral-background-container ${this.showUnhelpfulReasons?"flex":"hidden"} flex-col p-md gap-sm rounded-4 mt-xs"> <div class="flex flex-col gap-xs"> <div class="flex flex-row justify-between items-center"> <div class="text-14 font-semibold">${this.getUnhelpfulReasonsTitle()}</div> ${this.getUnhelpfulReasonsCloseBtn()} </div> <div class="text-14">${this.getUnhelpfulReasonsSubtitle()}</div> ${this.getUnhelpfulReasonButtons()} </div> <div>${this.getUnhelpfulReasonsDetails()}</div> <div class="flex flex-row justify-end">${this.getUnhelpfulReasonsSubmitBtn()}</div> </div>`,this.renderUnhelpfulReactionsPanelMobile=()=>e.x`<faceplate-bottom-sheet ${e.$(this.bottomSheetRef)} class="z-[3]"> <div class="flex flex-col gap-sm p-md"> <div class="flex flex-row justify-between items-center"> <div class="text-18 font-semibold">${this.getUnhelpfulReasonsTitle()}</div> ${this.getUnhelpfulReasonsCloseBtn()} </div> <div class="flex flex-col gap-[20px] py-xs"> ${this.getUnhelpfulReasonsSubtitle()} ${this.getUnhelpfulReasonButtons()} <div class="flex flex-col w-full gap-2xs"> ${this.getUnhelpfulReasonsSubmitBtn()} <div class="text-10">${this.getUnhelpfulReasonsDetails()}</div> </div> </div> </div> </faceplate-bottom-sheet>`}updated(e){super.updated(e),this.showUnhelpfulReasons&&!e.get("showUnhelpfulReasons")&&this.scrollToUnhelpfulReasonsPanel()}showFeedbackSubmittedToast(){this.dispatchEvent(e.d("faceplate-alert",{level:e.a0.info,message:"Feedback submitted"}))}getUnhelpfulReasonsTitle(){return "Why was this unhelpful?";}getUnhelpfulReasonsSubtitle(){return "Select all that apply:";}getUnhelpfulReasonsCloseBtn(){return e.u({attributes:{"aria-label":"Close",onclick:this.closeUnhelpfulReasonsPanel},appearance:"secondary",shape:"pill",size:e.v.Small,leadingIcon:e.al({size:e.I.Small})})}getUnhelpfulReasonsDetails(){return e.x`<span>If you think a piece of content that generated this answer may be in violation of Reddit Rules, <a id="${J}" href="${K}" target="_blank" class="a cursor-pointer no-visited no-underline hover:no-underline">report the individual post or comment.</a></span>`;}getUnhelpfulReasonsSubmitBtn(){return e.u({appearance:"primary",size:e.v.Medium,children:"Submit",attributes:{disabled:0===this.unhelpfulReasons.size,type:"submit",onclick:this.handleSubmitUnhelpfulReasons}});}getUnhelpfulReasonButtons(){return e.x`<div class="flex flex-row gap-xs flex-wrap"> ${W.map((e=>this.renderUnhelpfulReactionButton(e.name,e.getText())))} </div>`}render(){return e.x` <div class="flex flex-col text-neutral-content-weak w-fit pt-xs"> <div class="flex" data-testid="${e.jr}"> ${0===this.voteState?"Is this answer helpful?":"Thanks for your feedback!"} </div> <div class="${0===this.voteState?"flex items-center w-full h-[2rem] gap-2xs":"hidden"}"> <faceplate-tracker source="${i.G}" action="click" noun="feedback_positive" data-faceplate-tracking-context="${JSON.stringify(i.g({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}))}"> ${e.u({attributes:{id:e.js,onclick:this.onUpvoteClick,disabled:0!==this.voteState,className:"text-neutral-content-weak"},children:"Helpful",appearance:"plain",shape:"pill",size:e.v.Small,leadingIcon:l.c({size:e.I.Small})})} </faceplate-tracker> <faceplate-tracker source="${i.G}" action="click" noun="feedback_negative" data-faceplate-tracking-context="${JSON.stringify(i.g({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}))}"> ${e.u({attributes:{id:e.jt,onclick:this.onDownvoteClick,disabled:0!==this.voteState,className:"text-neutral-content-weak"},children:"Unhelpful",appearance:this.showUnhelpfulReasons?"secondary":"plain",shape:"pill",size:e.v.Small,leadingIcon:e.al({size:e.I.Small})})} </faceplate-tracker> </div> </div> ${this.isDesktop?this.renderUnhelpfulReasonsPanel():this.renderUnhelpfulReactionsPanelMobile()}`;}};Y.styles=[e.t],e._([e.n({type:String})],Y.prototype,"question",void 0),e._([e.n({type:String,attribute:"conversation-id"})],Y.prototype,"conversationId",void 0),e._([e.n({type:Number,attribute:"followup-index"})],Y.prototype,"followupIndex",void 0),e._([e.n({type:Boolean,attribute:"is-desktop"})],Y.prototype,"isDesktop",void 0),e._([e.j()],Y.prototype,"voteState",void 0),e._([e.j()],Y.prototype,"showUnhelpfulReasons",void 0),e._([e.j()],Y.prototype,"unhelpfulReasons",void 0),Y=e._([e.e("guides-response-container-reaction-panel")],Y);const X={default:new RegExp("<br />","gi"),replacement:"<br>"},ee={default:new RegExp("<a href","gi"),replacement:'<a target="_blank" href'},te={default:new RegExp("<pre","gi"),replacement:'<pre class="bg-tone-5 py-md px-lg overflow-auto border-tone-4"'},se={default:new RegExp("<code","gi"),replacement:'<code class="rounded-sm px-2xs py-[2px] border-tone-5 border-[1px]"'},ie={default:new RegExp("\\[&quot;","gi"),replacement:'"'},ne={default:new RegExp("&quot;\\]\\([^\\s<]*","gi"),replacement:'"'},re={default:new RegExp(">\\[","gi"),replacement:">"},ae={default:new RegExp("\\]\\([^\\s<]*","gi"),replacement:""},oe={default:new RegExp("&quot;<\\/a>","gi"),replacement:'&quot;<span class="h-md w-md ml-2xs align-middle -translate-y-[2px] rounded-full inline-flex items-center justify-center bg-neutral-background-container-strong text-neutral-content-weak">\n        <svg rpl="" fill="currentColor" height="20" icon-name="caret-right-outline" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">\n      <path d="m7.942 15.442-.884-.884L11.616 10 7.058 5.442l.884-.884 5 5a.624.624 0 0 1 0 .884l-5 5Z"></path>\n    </svg>\n      </span></a>'};class le{constructor(e,t){this.regex=e,this.htmlReplacement=t}apply(e){return e.replace(this.regex,this.htmlReplacement)}}class de{constructor(e,t){this.name=e,this.patternList=t}apply(e){return this.patternList.reduce(((e,t)=>t.apply(e)),e)}}var ue;!function(e){e.Link="link",e.Pre="pre",e.Code="code",e.Break="break",e.Heading="heading"}(ue||(ue={}));const ce=[new de(ue.Link,[new le(ee.default,ee.replacement),new le(ie.default,ie.replacement),new le(ne.default,ne.replacement),new le(ae.default,ae.replacement),new le(re.default,re.replacement),new le(oe.default,oe.replacement)]),new de(ue.Pre,[new le(te.default,te.replacement)]),new de(ue.Code,[new le(se.default,se.replacement)]),new de(ue.Break,[new le(X.default,X.replacement)])],he=e=>{let t=e;return ce.forEach((e=>{t=e.apply(t)})),t},pe=new Set(["a","div","li","ul","ol","h3","h4","h5","h6","br","span","code","pre","p","svg","path","strong","hr","br","del","table","tr","th","td","caption","colgroup","col","thead","tbody","tfoot"]),me=["id","class","href","target","fill","rpl","height","width","icon-name","viewBox","xmlns","colspan","rowspan","align","valign"],ge=(e,t)=>{const s=(new DOMParser).parseFromString(t,"text/html").querySelector("body"),i=e.childNodes,n=s.childNodes;xe(e,s),Re(i,n,e),ye(e)},be=e=>e.nodeType===Node.TEXT_NODE,ve=e=>"https:"===new URL(e).protocol;const fe=e=>pe.has(e.tagName.toLowerCase())&&function(e){const t=e.attributes;if(!t)return!0;for(let s=0;s<t.length;s++){const i=t[s].name;if(!me.includes(i))return!1;const n=e.getAttribute(i);if(n&&"href"===i&&!ve(n))return!1}return!0}(e);function ke(t){if("a"===t.tagName.toLowerCase()){const s=t.getAttribute("href");if(s&&function(t,s){let i;try{i=new URL(t)}catch{}const n=!!i?.searchParams.get(e.iO),r=s.endsWith('"');return n&&r}(s,t.textContent?.trim()??"")){const s=document.querySelector(`#${e.jv}`)?.content?.cloneNode(!0);s&&t.parentNode?.insertBefore(s,t.nextSibling)}}}function ye(e){ke(e);for(let t=0;t<e.children.length;t++){const s=e.children.item(t);s&&ye(s)}}const Re=(t,s,i)=>{const n=Array.from(s);for(let s=0;s<n.length;s++){const r=n[s],a=t[s];a?a.isEqualNode(r)||(be(r)?a.textContent=r.textContent:a instanceof Element&&r instanceof Element&&a.tagName===r.tagName?(xe(a,r),Re(a.childNodes,r.childNodes,a)):r instanceof Element&&fe(r)&&e.aV(r.outerHTML,a,e.P.Replace)):be(r)?i.appendChild(r):r instanceof Element&&fe(r)&&("A"!==r.tagName&&r.classList.add(e.ju),e.aV(r.outerHTML,i,e.P.Append))}},xe=(e,t)=>{const s=e.childNodes,i=t.childNodes;if(s.length>0&&i.length<s.length)for(let e=s.length-1;e>=i.length;e--){const t=s[e];!i[e]&&t&&t.remove()}};let Ie=class extends e.s{constructor(){super(...arguments),this.entityId="",this.tl="",this.isActive=!1,this.pubsub=new e.z(this),this.getTrackingContext=()=>i.e({entityId:this.entityId,type:i.Q.inline_quote}),this.setActiveQuote=()=>this.isActive=!0,this.deactivateQuoteFromSideRail=({entityId:e})=>{this.entityId===e&&(this.isActive=!1)}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.GuidesDeactivateCustomQuoteLink,this.deactivateQuoteFromSideRail,!1)}render(){return e.x` <span @keydown="${()=>{}}" @click="${this.setActiveQuote}" class="${this.isActive?"bg-neutral-background-selected":""} py-[2px] px-2xs text-neutral-content rounded-2 underline decoration-dotted hover:bg-neutral-background-strong-hover inline gap-xs cursor-pointer">${d.a$({san:Q.getSan(),trigger:Q.action,triggerElem:"parent",faceplateTrackingContext:this.getTrackingContext()})}${d.a$({san:H.getSan(),trigger:H.action,once:!0,faceplateTrackingContext:this.getTrackingContext()})}<slot></slot></span>`}};Ie.styles=[e.t],e._([e.n({type:String,attribute:"entity-id"})],Ie.prototype,"entityId",void 0),e._([e.n({type:String})],Ie.prototype,"tl",void 0),e._([e.j()],Ie.prototype,"isActive",void 0),Ie=e._([e.e("guides-inline-quote")],Ie);let we=class extends e.s{constructor(){super(...arguments),this.eventSearchData={},this.hasRecentlyPurchasedPremium=!1}get trackingContext(){return JSON.stringify({action_info:{source_name:"banner_button",type:"reached_limit"},...("conversation_id"in this.eventSearchData ? {search:this.eventSearchData} : {})});}activatePremiumPaymentModal(){return e.x`${d.cC({triggerElem:"closest(#premium-banner)",name:e.iJ,renderMode:e.P.Contents,queryParams:{variant:b.Guides}})}<ac-track trigger-elem="closest(#premium-banner)" san="${i.G}|click|premium_upsell" data-faceplate-tracking-context="${this.trackingContext}"></ac-track>`}render(){return e.x`<div data-testid="premium-header" class="cursor-pointer" id="premium-banner"> ${this.activatePremiumPaymentModal()} <div class="flex bg-neutral-background-weak justify-between px-md py-xs items-center rounded-dx-sm pr-2xs"> ${(t=this.quotaCount, e.x`<div class="flex gap-sm font-normal text-sm"> ${u.p({size:e.I.Medium,attributes:{className:"text-global-orangered"}})} <span>${e.bZ({one:`Upgrade to Reddit Premium to get ${t} question a day`,other:`Upgrade to Reddit Premium to get ${t} questions a day`,count:t})}</span> </div>`)} <div> ${e.u({appearance:"plain",size:e.v.Small,attributes:{className:"text-sm font-semibold"},children:s.c({size:e.I.Medium})})} <ac-track trigger="view" san="${i.G}|view|premium_upsell" data-faceplate-tracking-context="${this.trackingContext}"></ac-track> </div> </div> </div> `;var t}};we.styles=[e.t],e._([e.n({type:Number,attribute:"quota-count"})],we.prototype,"quotaCount",void 0),e._([e.n({type:Object,attribute:"event-search-data"})],we.prototype,"eventSearchData",void 0),e._([e.j()],we.prototype,"hasRecentlyPurchasedPremium",void 0),we=e._([e.e("guides-premium-upgrade-banner")],we);const{svg:Se}=e.a(),Te=e.m(Se`<path d="M18 5.4v9.2c0 .31-.055.604-.133.89L16.2 13.822V5.4c0-.882-.718-1.6-1.6-1.6H6.178L4.511 2.133C4.796 2.055 5.091 2 5.4 2h9.2A3.4 3.4 0 0118 5.4zm-3.75 2.1a1.75 1.75 0 10-3.5 0 1.75 1.75 0 003.5 0zm3.044 9.962a.898.898 0 010 1.272.9.9 0 01-1.274 0l-.802-.802a3.232 3.232 0 01-.619.067H5.4a3.4 3.4 0 01-3.4-3.4V5.4c0-.213.028-.418.067-.619l-.804-.804a.9.9 0 111.273-1.272l14.757 14.757h.001zM3.8 6.514v4.974l1.356-1.356c.411-.411.906-.68 1.426-.836L3.8 6.514zm9.686 9.686l-4.795-4.795a1.59 1.59 0 00-1.131-.469c-.427 0-.829.166-1.131.469L3.8 14.033v.567c0 .882.718 1.6 1.6 1.6h8.086z"></path>`,"0 0 20 20","broken-image");let Ne=class extends e.s{constructor(){super(...arguments),this.parent="",this.imgId="",this.showFallbackImg=!1,this.media=null,this.onImgError=()=>{if(!this.media)return;const e=this.media.src;this.trackImageFallbackView(e),this.showFallbackImg=!0},this.trackImageFallbackView=t=>{e.k(this,(({conversationId:t,position:s,searchQuery:n,imgUrl:r,parent:a,source:o=i.G})=>{const l={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{source_name:r,success:!1,pane_name:a}};return e.c({source:o,action:N.action,noun:N.noun},l)})({conversationId:"",position:0,searchQuery:"",imgUrl:t,parent:this.parent}))}}connectedCallback(){super.connectedCallback(),this.media=this.querySelector("img"),this.media&&(this.media.onerror=this.onImgError)}updated(e){super.updated(e),!e.get("imgId")&&this.imgId&&(this.showFallbackImg=!1)}render(){return this.showFallbackImg?e.x`<div class="w-full h-full flex items-center justify-center flex-col"> ${Te()} </div>`:e.x`<slot></slot>`}};Ne.styles=[e.t],e._([e.n({type:String})],Ne.prototype,"parent",void 0),e._([e.n({type:String,attribute:"img-id"})],Ne.prototype,"imgId",void 0),e._([e.j()],Ne.prototype,"showFallbackImg",void 0),Ne=e._([e.e("guides-product-card-img")],Ne);let $e=class extends e.s{constructor(){super(...arguments),this.position=0,this.name="",this.description="",this.price="",this.imageUrl="",this.retailersInfo="",this.isActive=!1,this.pubsub=new e.z(this),this.onProductSplitScreenClosed=({productId:e})=>{this.productId===e&&(this.isActive=!1)},this.onProductDetailsShow=()=>{this.isActive=!0},this.getConversationShoppingDetails=()=>{const e={productName:this.name,productPrice:parseFloat(this.price)};return i.a(e)}}get productId(){return[this.name,this.price,this.imageUrl].join("-")}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.GuidesCloseSplitScreenProductView,this.onProductSplitScreenClosed,!1)}render(){return e.x` <div class="border-[1px] border-solid rounded-[12px] ${this.isActive?"bg-neutral-background-selected border-neutral-border-weak":"border-neutral-border-weak hover:bg-neutral-background-hover"}" @click="${this.onProductDetailsShow}" @keydown="${this.onProductDetailsShow}"> ${d.a$({san:$.getSan(),trigger:$.action,once:!0,faceplateTrackingContext:{shopping:this.getConversationShoppingDetails(),action_info:{position:this.position}}})} ${d.a$({san:C.getSan(),trigger:C.action,triggerElem:"parent",faceplateTrackingContext:{shopping:this.getConversationShoppingDetails(),action_info:{position:this.position}}})} <div class="flex-shrink-0 gap-xs rounded-[12px] cursor-pointer"> <div class="relative rounded-t-[12px] bg-white w-[140px] xs:w-[161px] h-[140px] xs:h-[161px]"> <div class="rounded-t-[12px] absolute top-0 start-0 w-full h-full hover:bg-neutral-background-hover opacity-10"></div> <guides-product-card-img parent="guides-product-card"> <img src="${this.imageUrl}" alt="${this.name}" class="mb-0 rounded-t-[12px] rounded-b-none object-scale-down w-[140px] xs:w-[161px] h-[140px] xs:h-[161px]"> </guides-product-card-img> </div> <div class="flex flex-col gap-2xs p-xs xs:py-sm h-[60px] xs:h-[52px]"> <div class="text-12 text-neutral-content-strong font-semibold line-clamp-2"> ${this.name} </div> <div class="text-12 text-neutral-content">$${this.price}</div> </div> </div> </div>`}};$e.styles=[e.t],e._([e.n({type:Number})],$e.prototype,"position",void 0),e._([e.n({type:String})],$e.prototype,"name",void 0),e._([e.n({type:String})],$e.prototype,"description",void 0),e._([e.n({type:String})],$e.prototype,"price",void 0),e._([e.n({type:String,attribute:"image-url"})],$e.prototype,"imageUrl",void 0),e._([e.n({type:String,attribute:"retailers-info"})],$e.prototype,"retailersInfo",void 0),e._([e.j()],$e.prototype,"isActive",void 0),$e=e._([e.e("guides-product-card")],$e);const{svg:Ce}=e.a(),Ee=e.m(Ce`<path d="M16.045 16.93a2.888 2.888 0 002.885-2.884v-2.091a2.888 2.888 0 00-2.885-2.884h-2.09c-.109 0-.213.019-.318.032a1.68 1.68 0 00-.81.376l-.076-.068.394-1.079c.722-2.288 2.69-3.354 2.792-3.407a.9.9 0 00-.82-1.602c-.165.084-4.044 2.114-4.044 6.731v3.993a2.888 2.888 0 002.884 2.884l2.088-.001zm-10 0a2.888 2.888 0 002.885-2.884v-2.091a2.888 2.888 0 00-2.885-2.884h-2.09c-.109 0-.213.019-.318.032a1.68 1.68 0 00-.81.376l-.076-.068.394-1.079c.722-2.288 2.69-3.354 2.792-3.407a.9.9 0 00-.82-1.602c-.165.084-4.044 2.114-4.044 6.731v3.993a2.888 2.888 0 002.884 2.884l2.088-.001z"></path>`,"0 0 20 20","quote-start-fill");let Pe=class extends e.s{constructor(){super(...arguments),this.entityId="",this.isHeroQuote=!1,this.tl="",this.isLoading=!1,this.isActive=!1,this.upvotes=0,this.pdpSrc="",this._partialRequestController=new e.aU(this),this.pubsub=new e.z(this),this.firstUpdated=async()=>{await this.renderGuidesQuotePartial()},this.renderGuidesQuotePartial=async()=>{if(!this.entityId||this.isLoading)return;this.isLoading=!0;const t=this.isHeroQuote?this.getRtjsonHeroQuotePartialUrl():this.getRtjsonQuotePartialUrl(),s=await this._partialRequestController.request(t),i=await(s?.text());if(this.isLoading=!1,i){const t=(new DOMParser).parseFromString(i,"text/html").getElementById(e.jw);t?.innerHTML&&(this.renderQuoteHtml(t?.innerHTML),this.isHeroQuote&&(this.setQuoteUpvotes(t),this.setHeroQuoteLink(t)))}},this.setQuoteUpvotes=t=>{const s=t.querySelector(`.${e.jx}`)?.innerText;this.upvotes=parseInt(s)||0},this.setHeroQuoteLink=t=>{this.pdpSrc=t.querySelector(`.${e.jy}`)?.href||""},this.renderQuoteHtml=t=>{e.aV(t,this,e.P.Append)},this.getQueryParamsByConfig=e=>{const t=new URLSearchParams;return Object.entries(e).forEach((([e,s])=>{s&&t.set(e,String(s))})),t.toString()},this.getRtjsonQuotePartialUrl=(t=e.jz)=>{const s=this.getQueryParamsByConfig(t);return`${e.iN}/${this.entityId}/?${s}`},this.getRtjsonHeroQuotePartialUrl=()=>this.getRtjsonQuotePartialUrl({[e.jA]:e.jB,[e.jC]:this.tl,[e.jD]:e.jB}),this.renderSlot=()=>e.x` <slot name="main"></slot>`,this.renderLoadingView=()=>e.x`<faceplate-shimmer class="h-md w-full" shape="pill"></faceplate-shimmer>`,this.setActiveQuote=()=>this.isActive=!0,this.deactivateQuoteFromSideRail=({entityId:e})=>{this.entityId===e&&(this.isActive=!1)},this.getTrackingContext=()=>i.e({entityId:this.entityId,score:this.upvotes,type:i.Q.block_quote,sourceName:this.pdpSrc}),this.renderAvatarSlot=()=>e.x`<slot name="avatar"></slot>`,this.renderAvatarLoadingView=()=>e.x`<faceplate-shimmer class="h-lg w-lg" shape="circle"></faceplate-shimmer>`,this.renderTelemetryActions=()=>d.a$({san:M.getSan(),trigger:M.action,once:!0,faceplateTrackingContext:this.getTrackingContext()}),this.renderHeroQuote=()=>{const t=this.isLoading?this.renderLoadingView():this.renderSlot();return e.x`<div class="${this.isActive?"bg-neutral-background-selected":"hover:bg-neutral-background-strong-hover"} rounded-2 py-xs px-sm cursor-pointer max-w-[460px]"> ${this.renderTelemetryActions()} <div id="${this.elementId}" class="border-solid border-0 border-s-[1px] border-global-orangered ps-sm flex flex-col gap-xs relative min-w-[15rem]" @keydown="${()=>{}}" @click="${this.setActiveQuote}"> <div class="flex flex-col w-full gap-2xs"> <div class="relative"> ${Ee({size:e.I.Medium,attributes:{fill:"#FF4500",className:"float-start me-xs"}})}<slot name="content"></slot> </div> ${t} </div> </div> </div>`}}get elementId(){return`guides-rtjson-quote-${this.entityId}`}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.GuidesDeactivateCustomQuoteLink,this.deactivateQuoteFromSideRail,!1)}render(){if(this.isHeroQuote)return this.renderHeroQuote();const t=this.isLoading?this.renderLoadingView():this.renderSlot(),s=this.isLoading?this.renderAvatarLoadingView():this.renderAvatarSlot();return e.x`<div id="${this.elementId}" class="mt-md ${this.isActive?"bg-orangered-500 bg-opacity-[0.07]":"bg-neutral-background-weak hover:bg-neutral-background-weak-hover dark:hover:bg-neutral-background-hover"} rounded-2 py-xs px-sm flex flex-col gap-xs cursor-pointer relative min-w-[15rem]" @keydown="${()=>{}}" @click="${this.setActiveQuote}"> <div class="flex gap-xs"> ${s} <div class="flex flex-col w-full"> <slot name="content"></slot> ${t} </div> </div> </div>`}};Pe.styles=[e.t],e._([e.n({type:String,attribute:"entity-id"})],Pe.prototype,"entityId",void 0),e._([e.n({type:Boolean,attribute:"is-hero-quote"})],Pe.prototype,"isHeroQuote",void 0),e._([e.n({type:String})],Pe.prototype,"tl",void 0),e._([e.j()],Pe.prototype,"isLoading",void 0),e._([e.j()],Pe.prototype,"isActive",void 0),e._([e.j()],Pe.prototype,"upvotes",void 0),e._([e.j()],Pe.prototype,"pdpSrc",void 0),Pe=e._([e.e("guides-rtjson-quote")],Pe);let Le=class extends e.s{constructor(){super(...arguments),this.entityId="",this.tl="",this.isActive=!1,this.pubsub=new e.z(this),this.setActivePill=()=>this.isActive=!0,this.deactivateQuoteFromSideRail=({entityId:e})=>{this.entityId===e&&(this.isActive=!1)},this.getTrackingContext=()=>i.e({entityId:this.entityId,type:i.Q.source_pill})}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.GuidesDeactivateCustomQuoteLink,this.deactivateQuoteFromSideRail,!1)}render(){return e.x`<span @keydown="${()=>{}}" @click="${this.setActivePill}" class="${this.isActive?"bg-neutral-background-selected":"bg-neutral-background-hover hover:bg-neutral-background-weak-hover dark:hover:bg-neutral-background-hover"} rounded-4 py-[2px] px-xs inline-flex gap-xs cursor-pointer">${d.a$({san:G.getSan(),trigger:G.action,triggerElem:"parent",faceplateTrackingContext:this.getTrackingContext()})}${d.a$({san:q.getSan(),trigger:q.action,once:!0,faceplateTrackingContext:this.getTrackingContext()})}<slot> </slot></span>`}};Le.styles=[e.t],e._([e.n({type:String,attribute:"entity-id"})],Le.prototype,"entityId",void 0),e._([e.n({type:String})],Le.prototype,"tl",void 0),e._([e.j()],Le.prototype,"isActive",void 0),Le=e._([e.e("guides-source-pill")],Le);const _e="is-active",Ae="response-block",je="response-container",De="response-heading",Oe="min-h-[75vh]";let Ue=class extends Z{constructor(){super(...arguments),this.country="",this.telemetrySource=i.G,this.currentResponseId="",this.isLoading=!1,this.showLoadingShimmer=!1,this.errorMsg="",this.errorType=null,this.isHiddenGuidesPremiumBanner=!0,this.isQuotaExceededError=!1,this.dateStr=(new Date).toISOString(),this.resetState=()=>{this.errorMsg="",this.errorType=null,this.currentResponseId="",this.dateStr=(new Date).toISOString(),this.isLoading=!0,this.showLoadingShimmer=!0,this.responseBlock?.replaceChildren()},this.retryRequestCore=t=>{this.resetState(),this.pubsub.publish(e.T.GuidesRetryRequested),t&&this.trackRetryResponse()},this.applyErrorRules=(t,s)=>{switch(t.type){case e.jE.GuidesQuotaExceededError:return this.errorType=t.type,this.errorMsg=this.isUserLoggedIn?"You have reached the daily limit for asking questions.":"You have reached the weekly limit for asking questions.",this.isHiddenGuidesPremiumBanner=!1,this.isQuotaExceededError=!0,void this.sendRateLimitErrorViewEvent(JSON.stringify(s));case e.jE.GuidesUnhandledError:return this.errorType=t.type,this.errorMsg=t.msg,this.sendErrorViewEvent(t.msg),void console.error(t.msg);case e.jE.GuidesGenericError:return this.errorType=t.type,this.sendErrorViewEvent(t.msg),void(this.errorMsg=t.msg)}},this.onPremiumPurchased=()=>{this.isUserReachedQueryLimit=!1,this.closeErrorBanner(),this.isHiddenGuidesPremiumBanner=!0,this.isQuotaExceededError=!1,this.userHasPremium=!0},this.closeErrorBanner=()=>this.errorMsg="",this.getCitationTextFromQuote=t=>{const s=t.classList.contains(e.jy)?t.closest(e.jF):null,i=s?s.querySelector('div[slot="content"]'):null;return (i?i.innerText.trim():t.text?.trim()).replace(/^"|"$/g,"");},this.activateProductView=t=>{this.pubsub.publish(e.T.GuidesRenderSplitScreenProductView,{productDetails:{name:t.name,description:t.description,price:t.price,imageUrl:t.imageUrl,retailersInfo:t.retailersInfo},conversationId:this.conversationId,followupIndex:this.followupIndex,currentQuestion:this.question})},this.isSourcePillTarget=t=>t.tagName.toLowerCase()===e.jG,this.isInlineQuoteTarget=t=>t.tagName.toLowerCase()===e.jH,this.isProductCardTarget=t=>t.tagName.toLowerCase()===e.jI,this.isBlockQuoteLink=t=>t.classList.contains(e.jJ),this.onResponseBlockClick=t=>{const s=t.target;if(this.isInlineQuoteTarget(s))return void this.onResponseInlineCitationClick(s);if(this.isSourcePillTarget(s))return void this.onResponseSourcePillClick(s);if(this.isProductCardTarget(s))return void this.activateProductView(s);if(this.isBlockQuoteLink(s)){t.preventDefault();const i=s.closest(e.jF);return void this.onResponseBlockQuoteClick(i,s)}const r=s.closest("a");if(!r)return;const{postId:a,commentId:o}=i.f(r?.href),l=new URL(r.href).searchParams.get(e.iO);if(a||o){t.preventDefault();const e=!!r.dataset.entityid,i=r.querySelector("img")?.id,n=this.getCitationTextFromQuote(r);this.onCitationLinkClick({url:r.href,postId:a,commentId:o,citationText:n,tlQuery:l??void 0,isMediaLinkClick:e,shouldSendTelemetry:!this.isBlockQuoteLink(s),imgId:i}),this.activateLink(r)}const d=n.$(r);d&&this.sendSubredditClickEvent(d)},this.onResponseBlockQuoteClick=(e,t)=>{const s=e.entityId.startsWith("t1_")?e.entityId:"",i=s?"":e.entityId,n=this.getCitationTextFromQuote(t);this.onCitationLinkClick({url:t.href,postId:i,commentId:s,citationText:n,tlQuery:e.tl,isMediaLinkClick:!1,shouldSendTelemetry:!1})},this.onResponseSourcePillClick=e=>{const t=e.entityId.startsWith("t1_")?e.entityId:"",s=t?"":e.entityId;this.onCitationLinkClick({url:"",postId:s,commentId:t,citationText:"",tlQuery:e.tl,isMediaLinkClick:!1,shouldSendTelemetry:!1})},this.onResponseInlineCitationClick=e=>{const t=e.entityId.startsWith("t1_")?e.entityId:"",s=t?"":e.entityId;this.onCitationLinkClick({url:"",postId:s,commentId:t,citationText:e.innerText,tlQuery:e.tl,isMediaLinkClick:!1,shouldSendTelemetry:!1})},this.deactivateLink=()=>{this.pubsub.unsubscribe(e.T.GuidesCitationMismatch,this.onCitationMismatch);const t=this.getActiveLink();t?.removeAttribute(_e)},this.getActiveLink=()=>this.responseBlock?.querySelector(`a[${_e}]`),this.onCitationLinkClick=({url:t,postId:s,commentId:n,citationText:r,tlQuery:a,isMediaLinkClick:o,shouldSendTelemetry:l,imgId:d})=>{o||(this.pubsub.subscribe(e.T.GuidesCitationMismatch,this.onCitationMismatch,!1),l&&this._trackEvent((({conversationId:t,position:s,searchQuery:n,url:r,postId:a,commentId:o,source:l=i.G})=>{const d={...i.g({conversationId:t,position:s,searchQuery:n}),post:{id:a},action_info:{source_name:r,type:i.Q.blue_link}};return o&&(d.comment={id:o}),e.c({source:l,action:i.C,noun:i.R},d)})({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question,url:t,postId:s,commentId:n}))),this.openSplitScreenView({entityId:n||s,citationText:r,tlQuery:a,imgId:d})},this.onCitationMismatch=({citationText:t})=>{const s=this.getActiveLink();s&&this._trackEvent((({conversationId:t,position:s,searchQuery:n,citationText:r,activeLinkHref:a,source:o=i.G})=>{const l={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{source_name:a,setting_value:r}};return e.c({source:o,action:i.V,noun:"citation_mismatch"},l)})({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question,citationText:t,activeLinkHref:s.href}))},this.onGuidesRenderNewQuestionContainerStarted=()=>{this.recommendedQuestions=[],this.showDisclaimerLink=!1},this.updateTranslationLanguage=e=>{e&&this.translationLanguage!==e&&(this.translationLanguage=e,this.setTranslationLanguageQueryParam())},this.setTranslationLanguageQueryParam=()=>{const t=new URL(window.location.href);t.searchParams.get(e.iO)!==this.translationLanguage&&(t.searchParams.set(e.iO,this.translationLanguage),window.history.replaceState(null,"",t.toString()))},this.stopGoodVisitTimer=()=>{this.pubsub.publish(e.T.GuidesStopGoodVisitTimer)},this.storeQueryHistory=()=>{0===this.followupIndex&&(e=>{const t=I();t&&0!==t.length?w([e,...t]):w([e])})({conversationId:this.conversationId,query:this.question,dateStr:this.dateStr})},this.setLoggedOutCookie=()=>{this.isUserLoggedIn||e.ao({name:e.jK,value:e.jL,country:this.country,options:e.b1})},this.openSplitScreenView=({entityId:t,citationText:s,tlQuery:i,imgId:n})=>{this.pubsub.publish(e.T.GuidesRenderSplitScreenView,{entityId:t,conversationId:this.conversationId,followupIndex:this.followupIndex,currentQuestion:this.question,citationText:s,tlQuery:i,imgId:n})},this.initGoodVisitTimer=t=>{this.pubsub.publish(e.T.GuidesStartGoodVisitTimer,{conversationId:this.conversationId,followupIndex:this.followupIndex,searchQuery:this.question,isRealtime:!0,isStreaming:t})},this.renderDisclaimerLink=(t=!1)=>{if(!this.showDisclaimerLink)return e.A;const s=t?"":"mt-md";return e.x`<div class="text-12 ${s} flex text-center"> <span> <a target="_blank" href="${e.jM}" class="inline-block text-primary-plain no-underline">Reddit Answers</a> <span class="text-secondary-plain-weak"> are AI-generated from redditors posts and comments and may not be accurate.</span> </span> </div>`;},this.renderReactionPanel=(t=!1)=>!this.shouldShowReactionPanel||t?e.A:e.x`<guides-response-container-reaction-panel conversation-id="${this.conversationId}" followup-index="${this.followupIndex}" question="${this.question}" ?is-desktop="${this.isDesktop}"></guides-response-container-reaction-panel>`,this.renderRelatedPosts=()=>this.isLoading||0===this.responseRelatedPosts.length?e.A:e.x`<guides-post-list post-ids="${JSON.stringify(this.responseRelatedPosts)}" conversation-id="${this.conversationId}" followup-index="${this.followupIndex}" question="${this.question}" translation-language="${this.translationLanguage}"></guides-post-list>`,this.renderSourcesContainer=()=>this.useSourcesContainer?0===this.responseRelatedPosts.length&&(this.isResponseFinished||this.errorMsg)?e.A:0===this.responseRelatedPosts.length?k():e.x`<guides-sources-container post-ids="${JSON.stringify(this.responseRelatedPosts)}" conversation-id="${this.conversationId}" followup-index="${this.followupIndex}" question="${this.question}" translation-language="${this.translationLanguage}"></guides-sources-container>`:e.A,this.renderResponse=e=>{ge(this.responseBlock,e)},this.renderLoadingAnimation=()=>this.showLoadingShimmer?e.x`<div class="flex flex-col gap-sm my-sm"> <faceplate-shimmer class="h-md w-full" shape="pill"></faceplate-shimmer> <faceplate-shimmer class="h-md w-full" shape="pill"></faceplate-shimmer> </div>`:e.A,this.renderGuidesBanner=()=>this.isHiddenGuidesPremiumBanner||!this.isUserLoggedIn||this.userHasPremium||this.errorMsg&&!this.isQuotaExceededError||this.isLoading?e.A:e.x` <guides-premium-upgrade-banner quota-count="${this.premiumDailyQuota}" event-search-data="${JSON.stringify(this.getAdditionalEventData().search)}"></guides-premium-upgrade-banner> `,this.renderHeading=()=>e.x`<h2 id="${De}" class="m-0 font-bold text-neutral-content-strong text-24 first-letter:capitalize scroll-m-[60px] xs:scroll-m-[120px]"> ${this.question} </h2>`,this.renderSearchEscape=s=>{if(!s)return e.A;const i=r.b({query:this.question,scope:e.ir,cursor:{},conversationId:a.a.get(e.ec.GuidesEscapeHatch),impressionId:a.S.getUUID()}),n=e.u({appearance:"secondary",children:"View Search Results",leadingIcon:t.s({size:e.a4.Small}),attributes:{href:i,onclick:this.trackSearchEscapeClickEvent}});return e.x` <div class="flex flex-col my-xs ${this.isDesktop?"items-start":"items-center"}"> <span class="text-secondary-plain-weak"> ${"Continue with Reddit search"}</span> <div class="flex flex-col gap-sm my-sm">${n}</div> </div>`;},this.getDefaultTelemetryFields=()=>({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}),this.getAdditionalEventData=()=>i.g(this.getDefaultTelemetryFields()),this.sendSubredditClickEvent=t=>{this._trackEvent((({subredditName:t,position:s,searchQuery:n,conversationId:r,source:a=i.G})=>{const o={...i.g({conversationId:r,position:s,searchQuery:n}),subreddit:{name:t}};return e.c({source:a,action:A.action,noun:A.noun},o)})({...this.getDefaultTelemetryFields(),subredditName:t}))},this.sendRefuseResponseEvent=t=>{this._trackEvent((({conversationId:t,position:s,searchQuery:n,rejectionCodeStr:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{success:!1,reason:r}};return e.c({source:a,action:i.V,noun:"rejected_response"},o)})({...this.getDefaultTelemetryFields(),rejectionCodeStr:t}))},this.trackRetryResponse=()=>{this._trackEvent((({conversationId:t,position:s,searchQuery:n,source:r=i.G})=>e.c({source:r,action:i.C,noun:"try_again"},i.g({conversationId:t,position:s,searchQuery:n})))({...this.getDefaultTelemetryFields()}))},this.trackSearchEscapeClickEvent=()=>{this._trackEvent((({conversationId:t,position:s,searchQuery:n,source:r=i.G})=>{const a=i.g({conversationId:t,position:s,searchQuery:n}),o={...a,search:{...a.search,origin_element:"search_answers_escape_hatch",origin_page_type:e.ar.Guides},answers:{conversation_id:t,query:n}};return e.c({source:r,action:i.C,noun:"escape_hatch"},o)})({conversationId:this.conversationId,position:this.followupIndex,searchQuery:this.question}))},this.handleFaceplateTrackEvent=e=>V(e,i.g(this.getDefaultTelemetryFields()).search)}get isResponseFinished(){return!!this.currentResponseId&&!this.isLoading}get isResponsePending(){return!!this.currentResponseId&&this.isLoading}get channelId(){return`${this.userId}:${this.mainChannelId}`}get mainChannelId(){return[this.conversationId,this.dateStr].join("__")}get shouldShowReactionPanel(){return!(this.isLoading||this.errorMsg||!this.responseBlock?.childElementCount)}async connectedCallback(){this.pubsub.subscribe(e.T.GuidesRenderNewQuestionContainerStarted,this.onGuidesRenderNewQuestionContainerStarted,!1),super.connectedCallback(),this.pubsub.subscribe(e.T.GuidesDeactivateLink,this.deactivateLink),this.pubsub.subscribe(e.T.PremiumPurchased,this.onPremiumPurchased),this.addEventListener("faceplate-track",this.handleFaceplateTrackEvent)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("faceplate-track",this.handleFaceplateTrackEvent)}activateLink(e){this.deactivateLink(),e.setAttribute(_e,"")}sendErrorViewEvent(t){this._trackEvent((({conversationId:t,position:s,searchQuery:n,errorText:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{success:!1,reason:r}};return e.c({source:a,action:i.V,noun:"error"},o)})({...this.getDefaultTelemetryFields(),errorText:t}))}trackResponseFinished(t){this._trackEvent((({conversationId:t,position:s,searchQuery:n,isStreaming:r=!1,source:a=i.G})=>e.c({source:a,action:i.V,noun:"response"},{...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{source_name:r?F.streaming:F.realtime}}))({...this.getDefaultTelemetryFields(),isStreaming:t}))}sendRateLimitErrorViewEvent(t){this._trackEvent((({conversationId:t,position:s,searchQuery:n,reason:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{reason:r}};return e.c({source:a,action:i.V,noun:"rate_limit_error"},o)})({...this.getDefaultTelemetryFields(),reason:t}))}};Ue.styles=[e.i`a{color:var(--color-primary-plain);text-decoration:none}a:visited{color:var(--color-primary-plain-visited)}a.no-visited:visited{color:var(--color-primary-plain)}a:hover{color:var(--color-primary-plain-hover)}a[is-active]:not(guides-rtjson-quote a[is-active]){background-color:var(--color-secondary-background-selected);border:1px solid;border-color:var(--color-secondary-background-hover);border-radius:4px}a[is-active][data-entityid]:not(guides-rtjson-quote a[is-active][data-entityid]){background-color:var(--color-secondary-background-selected);border:none;border-radius:4px}a[is-active][data-entityid]>div{border-radius:4px}li{list-style-type:disc}p{margin-block:0}table{border-collapse:collapse;width:100%;word-break:normal;margin:1rem 0}th,tr:nth-child(even){background:var(--color-tone-6)}td,th{padding:.5rem;text-align:start}h3{margin-top:1.75rem;margin-bottom:.5rem}h4{margin:.5rem 0}ul{margin-block-start:.5rem}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.fade-in-text{animation:fadeIn .5s ease-in}`,e.t],e._([e.n({type:String})],Ue.prototype,"country",void 0),e._([e.n({type:String,attribute:"telemetry-source"})],Ue.prototype,"telemetrySource",void 0),e._([e.j()],Ue.prototype,"currentResponseId",void 0),e._([e.j()],Ue.prototype,"isLoading",void 0),e._([e.j()],Ue.prototype,"showLoadingShimmer",void 0),e._([e.j()],Ue.prototype,"errorMsg",void 0),e._([e.j()],Ue.prototype,"errorType",void 0),e._([e.j()],Ue.prototype,"isHiddenGuidesPremiumBanner",void 0),e._([e.j()],Ue.prototype,"isQuotaExceededError",void 0),Ue=e._([e.e("guides-response-container-core")],Ue);let ze=class extends e.s{constructor(){super(...arguments),this.entityIds="",this.isLoading=!1,this._partialRequestController=new e.aU(this),this.mediaResponseData=[],this.getAndRenderMediaCarouselPartial=async()=>{if(!this.entityIds||this.isLoading)return;this.isLoading=!0;const t=this.getMediaCarouselDetailsUrl(),s=await this._partialRequestController.request(t),i=await(s?.text());if(i){const t=(new DOMParser).parseFromString(i,"text/html").getElementById(e.jN);t?.innerText&&(this.mediaResponseData=JSON.parse(t.innerText),this.mapMediaCarouselDetails())}this.isLoading=!1},this.getMediaCarouselDetailsUrl=()=>`${e.jO}/${this.entityIds}`,this.isVideoPost=({postType:t,entityId:s})=>t===e.fu.Video&&s.startsWith("t3_"),this.mapMediaCarouselDetails=()=>{this.mediaResponseData.forEach((t=>{const{entityId:s,permalink:i,postType:n}=t;Array.from(this.getMediaCarouselItemByEntityId(s)).forEach((s=>{s.href=i,s.dataset.postType=n,this.isVideoPost(t)&&this.videoButton&&e.aV(this.videoButton.outerHTML,s,e.P.Append),e.aV(this.getSubredditNameHtmlStr(t.subredditPrefixedName),s.querySelector("faceplate-shimmer"),e.P.Replace)}))}))},this.getSubredditNameHtmlStr=e=>`<div class="text-12 text-neutral-content-weak">${e}</div>`,this.getMediaCarouselItemByEntityId=e=>this.querySelectorAll(`a[data-entityid="${e}"]`),this.getMediaDetailsByEntityId=e=>this.mediaResponseData.find((t=>t.entityId===e)),this.onMediaClick=t=>{if(!t.target)return;const s=t.target;if(s.parentElement===this)return;const n=s.closest("a").dataset.entityid||"",r=this.getMediaDetailsByEntityId(n);e.k(this,(({conversationId:t,position:s,searchQuery:n,mediaType:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),post:{type:r}};return e.c({source:a,action:_.action,noun:_.noun},o)})({conversationId:"",position:0,searchQuery:"",mediaType:r?.postType||""}))},this.getVideoButton=()=>e.u({appearance:"media",attributes:{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},size:e.v.Small,leadingIcon:h.p({size:e.I.Small})})}async firstUpdated(){await this.getAndRenderMediaCarouselPartial()}render(){return e.x`<slot @click="${this.onMediaClick}" @keydown="${this.onMediaClick}"></slot> <div class="hidden">${this.getVideoButton()}</div>`}};ze.styles=[e.t],e._([e.n({type:String,attribute:"entity-ids"})],ze.prototype,"entityIds",void 0),e._([e.j()],ze.prototype,"isLoading",void 0),e._([e.Y("button")],ze.prototype,"videoButton",void 0),ze=e._([e.e("guides-media-carousel")],ze);let Me=class extends e.s{constructor(){super(...arguments),this.id="",this.position=0,this.name="",this.prefixedName="",this.subscribersCount=0,this.publicDescription="",this.isSubscribed=!1,this.isLoading=!1,this.iconTemplate="",this._partialRequestController=new e.aU(this),this.getTrackingContext=()=>({subreddit:{id:this.id,name:this.name}}),this.getPartialRequestUrl=()=>`${e.jP}/${this.id}`,this.getSubredditCardDetailsPartial=async()=>{if(!this.id||this.isLoading)return;this.isLoading=!0;const t=await this._partialRequestController.request(this.getPartialRequestUrl()),s=await(t?.text());if(s){const t=(new DOMParser).parseFromString(s,"text/html").getElementById(e.jQ);if(t?.innerText){const s=JSON.parse(t?.innerText);this.name=s?.name,this.prefixedName=s?.prefixedName,this.subscribersCount=s?.subscribersCount,this.publicDescription=s?.publicDescription,this.isSubscribed=s?.isSubscribed,this.iconTemplate=s?.icon,e.aV(this.iconTemplate,this.faceplateShimmer,e.P.Replace)}}this.isLoading=!1},this.onSubredditLinkClick=e=>{const t=e.target,s=t.tagName?.toLowerCase();"shreddit-join-button"!==s&&this.trackSubredditCardClick()},this.trackSubredditCardClick=()=>{e.k(this,(({conversationId:t,position:s,searchQuery:n,subredditId:r,subredditName:a,source:o=i.G})=>{const l={...i.g({conversationId:t,position:s,searchQuery:n}),subreddit:{id:r,name:a}};return e.c({source:o,action:A.action,noun:A.noun},l)})({conversationId:"",position:0,searchQuery:"",subredditId:this.id,subredditName:this.name}))},this.renderSubredditCardView=()=>p.a({attributes:{href:this.permalink,target:"_blank",onclick:this.onSubredditLinkClick},children:[d.a$({san:j.getSan(),trigger:j.action,once:!0,faceplateTrackingContext:this.getTrackingContext()}),e.x` <div class="flex flex-col gap-2xs"> <div class="flex gap-xs"> ${this.renderIconShimmer()} ${this.renderMainInfo()} ${this.renderJoinButton()} </div> ${this.renderPublicDescription()} </div>`],underline:"none",suppressVisitedStyle:!0}),this.renderMainInfo=()=>this.isLoading?e.x`<div class="flex flex-col w-full flex-1 gap-2xs"> <faceplate-shimmer class="h-[20px] w-[240px]" shape="pill"></faceplate-shimmer> <faceplate-shimmer class="h-[16px] w-[240px]" shape="pill"></faceplate-shimmer> </div>`:e.x`<div class="flex flex-col w-full flex-1"> <div class="text-16 text-neutral-content-strong font-semibold">${this.name}</div> <div id="members-count" class="text-12 text-neutral-content-weak"> ${e.bZ({one:e.x`1 member`,other:e.x`<faceplate-number number="${this.subscribersCount}" pretty></faceplate-number> members`,count:this.subscribersCount})} </div> </div>`,this.renderJoinButton=()=>this.isLoading?e.x`<faceplate-shimmer class="h-[24px] w-[50px]" shape="pill"></faceplate-shimmer>`:e.x`<shreddit-join-button name="${this.name}" subreddit-id="${this.id}" button-classes="px-sm h-lg" buttonsize="small" unsubscribe-button-type-override="bordered" with-tracking tracking-source="${D.source}" tracking-action="${D.action}" tracking-subscribe-noun="${D.noun}" tracking-unsubscribe-noun="${O.noun}" ?subscribed="${this.isSubscribed}" .trackingOptions="${this.getTrackingContext()}"></shreddit-join-button>`,this.renderPublicDescription=()=>this.isLoading?e.x`<div class="flex flex-col gap-2xs"> <faceplate-shimmer class="h-[16px] w-[346px]" shape="pill"></faceplate-shimmer> <faceplate-shimmer class="h-[16px] w-[346px]" shape="pill"></faceplate-shimmer> </div>`:e.x`<div class="text-neutral-content-weak text-12 line-clamp-2"> ${this.publicDescription} </div>`,this.renderIconShimmer=()=>e.x`<faceplate-shimmer class="h-[40px] w-[40px]" shape="circle"></faceplate-shimmer>`}get permalink(){return`${document.location.origin}/${this.prefixedName}/`}async firstUpdated(){await this.getSubredditCardDetailsPartial()}render(){return e.x` <div class="max-w-[346px] h-[72px] border-[1px] border-solid border-neutral-border-weak rounded-dx-md p-sm hover:bg-neutral-background-hover cursor-pointer ${this.position>=e.jR?"hidden xs:block":""}"> ${this.renderSubredditCardView()} </div> `}};Me.styles=[e.t],e._([e.n({type:String})],Me.prototype,"id",void 0),e._([e.n({type:Number})],Me.prototype,"position",void 0),e._([e.j()],Me.prototype,"name",void 0),e._([e.j()],Me.prototype,"prefixedName",void 0),e._([e.j()],Me.prototype,"subscribersCount",void 0),e._([e.j()],Me.prototype,"publicDescription",void 0),e._([e.j()],Me.prototype,"isSubscribed",void 0),e._([e.j()],Me.prototype,"isLoading",void 0),e._([e.j()],Me.prototype,"iconTemplate",void 0),e._([e.Y('faceplate-shimmer[shape="circle"]')],Me.prototype,"faceplateShimmer",void 0),Me=e._([e.e("guides-subreddit-card")],Me);const He=(e,t)=>e`<li class="!mr-xs overflow-hidden inline-flex list-none shrink-0 cursor-pointer"> ${t} </li>`,Qe=(e,t,{html:s})=>s` ${He(s,s`<a data-entityid="${e.entity_id}" href="${e.src}" target="_blank" rel="noopener noreferrer" class="relative flex-shrink-0 flex gap-2xs flex-col h-full cursor-pointer"><img data-entityid="${e.entity_id}" src="${e.src}" alt="response_carousel_media_${t}" class="mb-0 rounded-[12px] h-[150px] min-w-[100px] max-w-[300px] w-auto object-cover border-solid border-[0.5px] border-neutral-border-weak" loading="lazy"> <faceplate-shimmer class="w-full h-sm pt-2xs" shape="pill"></faceplate-shimmer></a>`)} `,qe=(e,t,{html:s})=>s` <guides-product-card position="${t}" name="${e.name}" description="${e.description}" price="${e.estimated_price}" image-url="${e.image_url}" retailers-info="${JSON.stringify(e.c[0].c)}" class="h-[218px] xs:h-[240px] w-[142px] xs:w-[163px]"> </guides-product-card> `,Ge=(e,t,{html:s,_node:i})=>s` <li class="list-none"> <guides-rtjson-quote entity-id="${e.id}"> <div class="text-14 text-neutral-content" slot="content"> ${e.c?.map((e=>i(e,t)))??""} </div> </guides-rtjson-quote> </li>`,Fe=(t,s)=>{const n={html:e.x,_node:Fe,ifDefined:e.aa};switch(t.e){case e.j_:return((e,{html:t,ifDefined:s})=>t`<guides-source-pill entity-id="${e.id}" tl="${s(e.tl)}"> ${e.subreddit_name} </guides-source-pill>`)(t,n);case m.d:return((e,t,{html:s,_node:i})=>{const n=e.c?.map((e=>i(e,t)))??"";switch(e.l){case 1:return s`<h1>${n}</h1>`;case 2:return s`<h2>${n}</h2>`;case 3:return s`<h3>${n}</h3>`;case 4:return s`<h4>${n}</h4>`;case 5:return s`<h5>${n}</h5>`;case 6:return s`<h6>${n}</h6>`}})(t,s,n);case e.jZ:return((t,{html:s})=>s`<div class="flex flex-col gap-xs"> <div> <h3 class="${e.jS} mb-0">${t.title}</h3> <p class="${e.jT}">${t.description}</p> </div> <div class="grid grid-col-1 xs:grid-cols-[repeat(auto-fit,minmax(340px,1fr))] gap-xs"> ${t.c.map(((t,i)=>s` <guides-subreddit-card id="${t.id}" position="${i}" class="${i>=e.jR?"xs:h-[98px]":"h-[98px]"}"> </guides-subreddit-card>`))} </div> </div>`)(t,n);case e.jY:return((t,{html:s,_node:n,ifDefined:r})=>{if(e.jU(t)){const e=t,a=[...new Set(e.c.map((e=>e.entity_id)))];return s` <guides-media-carousel entity-ids="${JSON.stringify(a)}"> <h3>${t.title}</h3> <shreddit-gallery-carousel class="h-[172px] nd:visible" tracking-args-forward-arrow="${JSON.stringify(i.h)}" tracking-args-back-arrow="${JSON.stringify(i.i)}"> ${e.c.map(((e,t)=>Qe(e,t,{html:s,_node:n,ifDefined:r})))} </shreddit-gallery-carousel></guides-media-carousel>`}const a=t;return s` <div class="flex flex-col gap-md"> <h3 class="mb-0">${t.title}</h3> <shreddit-gallery-carousel class="h-[218px] xs:h-[240px]" tracking-args-forward-arrow="${JSON.stringify(i.j)}" tracking-args-back-arrow="${JSON.stringify(i.k)}" tracking-scroll-san="${JSON.stringify(i.d)}"> ${a.c.map(((e,t)=>He(s,qe(e,t+1,{html:s,_node:n,ifDefined:r}))))} </shreddit-gallery-carousel> </div>`})(t,n);case e.jX:return((e,t,{html:s,_node:i,ifDefined:n})=>s` <guides-rtjson-quote entity-id="${e.id}" tl="${n(e.tl)}" is-hero-quote> <div class="text-14 text-neutral-content text-wrap" slot="content"> ${e.c.map((e=>i(e,t)))??""} </div> </guides-rtjson-quote>`)(t,s,n);case e.jW:return((e,t,{html:s,_node:i,ifDefined:n})=>s` <guides-inline-quote entity-id="${e.id}" tl="${n(e.tl)}">${e.c[0].c.map((e=>i(e,t)))}</guides-inline-quote>`)(t,s,n);case e.jV:return((e,t,s)=>{const{html:i}=s;return i` <ul class="list-none"> ${Ge(e,t,s)} </ul>`})(t,s,n);case m.i:return Be(t,s);case m.f:return Ze(t,s);case m.e:return Ke(t,s);case m.P:return Ve(t,s);default:return(e=>e.e.startsWith("ra:"))(t)?(({html:e})=>e``)(n):c._(t,s)}},Be=(t,s)=>{const n=s.targetBlankLinks?"_blank":"_self",r=t.u.startsWith("/")?((e,t)=>{try{if(t)return new URL(e,t).toString()}catch{}return e})(t.u,s.baseUrlForRelativeLinks):t.u,{postId:a,commentId:o}=i.f(t.u),l=i.e({entityId:o||a,type:i.Q.blue_link,sourceName:t.u}),u=e.aA(t.u)?e.x`<span class="h-md w-md ms-2xs align-middle -translate-y-[2px] rounded-full inline-flex items-center justify-center bg-neutral-background-container-strong text-neutral-content-weak"> <svg rpl="" fill="currentColor" height="20" icon-name="caret-right-outline" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"> <path d="m7.942 15.442-.884-.884L11.616 10 7.058 5.442l.884-.884 5 5a.624.624 0 0 1 0 .884l-5 5Z"></path> </svg> </span>`:e.x``;return e.x`<a href="${r}" rel="noopener nofollow ugc" target="${n}">${d.a$({san:`${i.l.source}/${i.l.action}/${i.l.noun}`,trigger:"view",once:!0,triggerElem:"parent",faceplateTrackingContext:l})}${t.t}${u}</a>`},Ve=(t,s)=>e.x`<p> ${t.c.map((e=>Fe(e,s)))} </p>`,Ze=(t,s)=>{const i=t.c.map((e=>Fe(e,s)));return t.o?e.x`<ol> ${i} </ol>`:e.x`<ul> ${i} </ul>`},Ke=(t,s)=>e.x`<li> ${t.c?.map((e=>Fe(e,s)))??""} </li>`,Je=t=>e.x`<div class="rendererd-rtjson"> ${e.bO(t.document,(e=>Fe(e,{targetBlankLinks:!1,targetBlankSubredditAndUserLinks:!1,baseUrlForRelativeLinks:""})))} </div>`;function We(e){if(!e)return;const t={};return e.paneName&&(t.pane_name=e.paneName),"number"==typeof e.position&&(t.position=e.position),e.reason&&(t.reason=e.reason),"number"==typeof e.relativePosition&&(t.relative_position=e.relativePosition),e.type&&(t.type=e.type),Object.keys(t).length?t:void 0}function Ye(e){if(!e)return;const t={};return e.conversationId&&(t.conversation_id=e.conversationId),e.query&&(t.query=e.query),Object.keys(t).length?t:void 0}function Xe(e){if(!e)return;const t={};return e.id&&(t.id=e.id),e.parentId&&(t.parent_id=e.parentId),e.postId&&(t.post_id=e.postId),Object.keys(t).length?t:void 0}function et(e){if(!e)return;const t={};return e.displayQuery&&(t.display_query=e.displayQuery),e.rawQuery&&(t.raw_query=e.rawQuery),Object.keys(t).length?t:void 0}function tt(e){if(e)return{id:e.id??"",nsfw:e.isNsfw,spoiler:e.isSpoiler,title:e.title??void 0}}function st(e){return e?{id:e.id??"",name:e.name??""}:void 0}function it(e){if(!e)return;const t={};return e.impressionId&&(t.impression_id=e.impressionId),e.originElement&&(t.origin_element=e.originElement),"string"==typeof e.query&&(t.query=e.query),e.range&&(t.range=e.range),e.sort&&(t.sort=e.sort),"boolean"==typeof e.isNsfw&&(t.nsfw=e.isNsfw),e.safeSearch&&(t.safe_search=e.safeSearch),e.conversationId&&(t.conversation_id=e.conversationId),e.structureType&&(t.structure_type=e.structureType),e.queryID&&(t.query_id=e.queryID),e.scope&&(t.scope_path=e.scope.path,t.scope_type=e.scope.type,e.scope.id&&(t.scope_id=e.scope.id),e.scope.name&&(t.scope_name=e.scope.name)),e.snippet&&(t.snippet=e.snippet),e.snippetId&&(t.snippet_id=e.snippetId),Object.keys(t).length?t:void 0}function nt(e){if(e)return{id:e.id,name:e.name,nsfw:e.isNsfw,quarantined:e.isQuarantined}}const rt=[e.j$.Click,e.j$.View,e.j$.Consume,e.j$.Leave,e.j$.Dwell,e.j$.Load];function at({events:t,trackingContext:s},i,n){if(!t?.length&&!s)return i;const{CLICK:r,VIEW:a,LEAVE:o,CONSUME:l,DWELL:d,LOAD:u}=function(t){const s={[e.j$.Click]:[],[e.j$.View]:[],[e.j$.Consume]:[],[e.j$.Leave]:[],[e.j$.Dwell]:[],[e.j$.Load]:[]};return t.forEach((({source:t,action:i,noun:n,trigger:r})=>{rt.includes(r)&&s[r].push(e.bc({source:t,action:i,noun:n}))})),s}(t),c=function(t){return t.reduce(((t,s)=>{const{trigger:i,triggerConfiguration:n}=s;return i===e.j$.Dwell&&n?.timerDurations&&t.push(n.timerDurations.join("/")),t}),[])}(t),h=s?JSON.stringify(function({actionInfo:e,answers:t,comment:s,metaSearch:i,post:n,profile:r,search:a,subreddit:o}){return{action_info:We(e),answers:Ye(t),comment:Xe(s),meta_search:et(i),post:tt(n),profile:st(r),search:it(a),subreddit:nt(o)}}(s)):void 0;return e.x`<search-telemetry-tracker data-faceplate-tracking-context="${e.aa(h)}" .clickEventSANs="${r||[]}" .viewEventSANs="${a||[]}" .leaveEventSANs="${o||[]}" .loadEventSANs="${u||[]}" .consumeEventSANs="${l||[]}" .dwellEventSANs="${d||[]}" .dwellTriggerTimers="${c||[]}" data-type="${e.aa(n?.["data-type"])}" data-testid="${e.aa(n?.["data-testid"])}" data-thingid="${e.aa(n?.["data-thingid"])}" ?data-pretranslated="${n?.["data-pretranslated"]}" ?disabled="${n?.disabled}" slot="${e.aa(n?.slot)}"> ${i}</search-telemetry-tracker>`}var ot,lt,dt;!function(e){e.readystatechange="readystatechange",e.error="error",e.open="open"}(ot||(ot={})),function(e){e.error="error",e.patch="patch",e.success="success",e.userQuota="userQuota",e.quotaExceeded="quotaExceeded"}(lt||(lt={})),function(e){e.add="add",e.replace="replace",e.remove="remove"}(dt||(dt={}));var ut,ct;!function(e){e[e.INITIALIZING=-1]="INITIALIZING",e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"}(ut||(ut={})),function(e){e.GET="GET",e.POST="POST"}(ct||(ct={}));class ht{constructor(e,t){if(this.listeners={},this.readyState=ut.INITIALIZING,this.chunkText="",this.responseTextLength=0,this.xhr=null,this.url="",this.options={headers:{"Content-Type":"application/json"},method:ct.GET},this.addEventListener=(e,t)=>{this.listeners[e]=t},this.removeEventListener=e=>{delete this.listeners[e]},this.removeAllListeners=()=>{Object.keys(this.listeners).forEach(this.removeEventListener)},this.startStream=()=>{this.xhr=new XMLHttpRequest,this.xhr.onreadystatechange=()=>this.checkStreamClosedState(),this.xhr.onprogress=e=>this.onStreamProgress(e),this.xhr.onload=e=>this.onStreamLoaded(e),this.xhr.onerror=e=>this.onStreamFailure(e),this.xhr.onabort=e=>this.onStreamFailure(e),this.xhr.open(this.options.method,this.url);for(const e in this.options.headers)this.xhr.setRequestHeader(e,this.options.headers[e]);this.xhr.send(this.options.payload),this.setStreamState(ut.CONNECTING)},this.closeStream=()=>{this.readyState!==ut.CLOSED&&(this.xhr&&this.xhr.abort(),this.xhr=null,this.setStreamState(ut.CLOSED),this.removeAllListeners())},this.dispatchEvent=e=>{if(!e)return!0;const t="on"+e.type;return(!Object.hasOwn(this,t)||(this[t].call(this,e),!e.defaultPrevented))&&(!this.listeners[e.type]||this.listeners[e.type](e))},this.setStreamState=e=>{const t=new CustomEvent(ot.readystatechange);t.readyState=e,this.readyState=e,this.dispatchEvent(t)},this.onStreamFailure=e=>{const t=new CustomEvent(ot.error);t.reason=e,this.dispatchEvent(t),this.closeStream()},this.onStreamProgress=e=>{if(!this.xhr)return;if(this.xhr.status>=400)return void this.onStreamFailure(e);if(this.readyState===ut.CONNECTING){const e=new CustomEvent(ot.open);this.dispatchEvent(e),this.setStreamState(ut.OPEN)}const t=this.xhr.responseText.substring(this.responseTextLength);this.responseTextLength+=t.length,t.split(/(\r\n|\r|\n){2}/g).forEach((e=>{if(0===e.trim().length){const e=this.parseEventChunk(this.chunkText.trim());this.dispatchEvent(e),this.chunkText=""}else this.chunkText+=e}))},this.onStreamLoaded=e=>{this.onStreamProgress(e);const t=this.parseEventChunk(this.chunkText);this.dispatchEvent(t),this.chunkText=""},this.parseEventChunk=e=>{if(!e||!e.length)return null;const t={id:"",data:"",event:lt.patch};e.split(/\n|\r\n|\r/).forEach((e=>{const s=(e=e.trimEnd()).indexOf(":");if(s<=0)return;const i=e.substring(0,s);if(!(i in t))return;const n=e.substring(s+1).trimStart();this.updateParsedStreamValue(t,i,n)}));const s=new CustomEvent(t.event);return s.data=this.tryParseIntoJSON(t.data),s.id=t.id,s},this.tryParseIntoJSON=e=>{try{return JSON.parse(e)}catch{return e}},this.updateParsedStreamValue=(e,t,s)=>{switch(t){case"data":return void(e.data+=s);case"event":return void(e.event=s);default:return void(e[t]=s)}},this.checkStreamClosedState=()=>{this.xhr&&this.xhr.readyState===XMLHttpRequest.DONE&&this.closeStream()},!e)throw new Error("Service url is required");if(!t||!t.method)throw new Error("Service options are required");this.url=e,this.options=t}get _options(){return this.options}}const pt=({operation:e,keys:t,result:s,value:i,responseContext:n})=>{let r=s;for(let s=0;s<t.length;s++){const a=t[s];if(e===dt.add&&"-"===a){r[r.length]=i;break}if(s===t.length-1)if(e===dt.remove)if(Array.isArray(r)){const e=parseInt(t[t.length-1]);r.splice(e,1)}else delete r[t[t.length-1]];else r[a]=i;else r=r[a];if("string"==typeof r||!r){const e="Sentry"in window?window.Sentry:void 0;if(e?.captureException){const s={keys:t.join("/"),value:i,responseContext:n},r=`Unable to provide Reddit Answers SSE update for: ${JSON.stringify(s)}`;e.captureException(r)}break}}return s};var mt;const gt="Failed to fetch auth token from /svc/shreddit/token",bt=`${je}_streaming`;let vt=mt=class extends Ue{constructor(){super(...arguments),this.format=e.k0.html,this.shouldRenderSearchEscapeHatch=!1,this.sseSource=null,this.requestedAt=0,this.lastResponseTime=0,this.responseTimings=[],this.result={document:[],comments:[],followUps:[],posts:[],rejectionCodes:[],userQuota:e.k1,translationLanguage:"",richtext:{document:[]}},this.scrollToTheQuestionTitle=()=>{this.followupIndex>0&&this.heading?.scrollIntoView({behavior:"smooth"})},this.removeHeightClass=()=>this.responseContainer?.classList.remove(Oe),this.removePrevSiblingHeight=()=>{const e=this.parentElement?.children||[],t=e.length>1?e[e.length-2]:null;t&&t instanceof mt&&t.removeHeightClass()},this.activateLink=t=>{t.classList.contains(e.jy)||super.activateLink(t)},this.getStreamingUrl=()=>`https://answers.reddit.com/v1/answers/${this.conversationId}`,this.captureError=e=>{window.Sentry?.captureMessage?.(e)},this.initStreaming=async()=>{this.isLoading=!0,this.requestedAt=Date.now();const t=await e.e6();if(!t)throw (this.captureError(gt), new Error(gt));const s={format:this.format,query:this.question,source:this.source,correlationID:this.mainChannelId,supportedFeatures:e.k2},i={headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`,"X-Reddit-App-Name":e.bd()},method:ct.POST,payload:JSON.stringify(s)},n=new ht(this.getStreamingUrl(),i);n.addEventListener(ot.readystatechange,this.onStreamingReadyStateChangeEvent),n.addEventListener(lt.quotaExceeded,this.onQuotaExceedHandler),n.addEventListener(lt.error,this.onStreamingErrorHandler),n.addEventListener(lt.userQuota,this.onUserQuotaEventHandler),n.addEventListener(lt.patch,this.onPatchEventHandler),n.addEventListener(lt.success,this.onSuccessEventHandler),this.sseSource=n,n.startStream()},this.onQuotaExceedHandler=e=>{const t=e;this.updateResponseByStreamingEvent(lt.quotaExceeded,this.result,t.data)},this.onStreamingErrorHandler=e=>{const t=e;this.updateResponseByStreamingEvent(lt.error,this.result,t.data)},this.onStreamingReadyStateChangeEvent=t=>{const{result:s}=this;switch(t.readyState){case ut.OPEN:this.pubsub.publish(e.T.GuidesStreamingStarted),this.stopLoading();break;case ut.CLOSED:this.pubsub.publish(e.T.GuidesStreamingEnded),this.trackLastResponse(),s.rejectionCodes?.length>0?this.sendRefuseResponseEvent(s.rejectionCodes.join(",")):this.trackResponseFinished(!0)}},this.onSuccessEventHandler=t=>{const s=t;this.updateResponseByStreamingEvent(lt.success,this.result,s.data),this.pubsub.publish(e.T.GuidesStreamingUserQuota,{isUserReachedQueryLimit:this.isUserReachedQueryLimit})},this.onPatchEventHandler=e=>{const{currentResponseId:t,result:s}=this,i=e;this.setResponseTiming(),""===t&&(this.setLoggedOutCookie(),this.storeQueryHistory(),this.trackFirstResponse(),this.initGoodVisitTimer(!0)),this.currentResponseId=i.id,this.lastResponseTime=Date.now(),this.updateResponseByStreamingEvent(lt.patch,s,i.data)},this.onUserQuotaEventHandler=e=>{const{result:t}=this,s=e;this.updateResponseByStreamingEvent(lt.userQuota,t,s.data)},this.stopLoading=()=>{this.showLoadingShimmer=!1},this.setResponseTiming=()=>{const e=Date.now();0===this.responseTimings.length?this.responseTimings.push(e-this.requestedAt):this.responseTimings.push(e-this.lastResponseTime)},this.updateResponseByStreamingEvent=(t,s,i)=>{switch(this.updateTranslationLanguage(s.translationLanguage),t){case lt.quotaExceeded:{const t=i;return this.applyErrorRules({type:e.jE.GuidesQuotaExceededError,msg:t.message},this.result.userQuota),void this.sendRateLimitDetails({isQuotaError:!0,timeUntilResetSeconds:t.retryAfterSeconds,queriesRemaining:this.result.userQuota.queriesRemaining})}case lt.error:{const t=i;return void this.applyErrorRules({type:e.jE.GuidesUnhandledError,msg:t?.message||"Unknown streaming error"})}case lt.success:return Array.isArray(i)&&this.updateResponseByStreamingEvent(lt.patch,s,i),this.showDisclaimerLink=!0,s.followUps.length>0&&(this.recommendedQuestions=s.followUps.map((e=>e.query))),void(this.isLoading=!1);case lt.userQuota:return this.result.userQuota=i,this.isUserReachedQueryLimit=0===this.result.userQuota.queriesRemaining,this.userHasPremium||(this.isHiddenGuidesPremiumBanner=!this.isUserReachedQueryLimit),void this.sendRateLimitDetails({isQuotaError:!1,timeUntilResetSeconds:this.result.userQuota.timeUntilResetSeconds,queriesRemaining:this.result.userQuota.queriesRemaining});case lt.patch:if(i.reduce(((e,t)=>((e,t,s)=>{const i=t.op,n=t.path.split("/").filter(Boolean),r=n[0];if(i===dt.replace&&0===n.length){if(0===n.length){for(const s in t.value)e[s]=t.value[s];return e}e[r]=t.value||[]}else pt({operation:i,keys:n,result:e,value:t.value,responseContext:s});return e})(e,t,{conversationId:this.conversationId,followupIndex:this.followupIndex,question:this.question})),s),this.isHtmlFormat){const e=he(s.document.join(""));this.renderResponse(e)}return void(0===this.responseRelatedPosts.length&&s.posts.length>0&&(this.responseRelatedPosts=s.posts.map((e=>e.ID))));default:return}},this.sendRateLimitDetails=({isQuotaError:t,timeUntilResetSeconds:s,queriesRemaining:i})=>{this.pubsub.publish(e.T.GuidesStreamingRateLimitDetails,{timeUntilResetSeconds:s,isUserReachedQueryLimit:t||0===i,queriesRemaining:t?0:i})},this.trackFirstResponse=()=>{e.k(this,(({conversationId:t,position:s,searchQuery:n,millis:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{position:1},timer:{type:e.b3.GuidesStreamingResponse,millis:r}};return e.c({source:a,action:i.V,noun:"streaming_response_first"},o)})({...this.getDefaultTelemetryFields(),millis:this.responseTimings[0]}))},this.trackLastResponse=()=>{const{responseTimings:t,requestedAt:s}=this,n=Date.now();e.k(this,(({conversationId:t,position:s,searchQuery:n,millis:r,responsePosition:a,min:o,max:l,source:d=i.G})=>{const u={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{position:a},timer:{type:e.b3.GuidesStreamingQuestion,millis:r,min:o,max:l}};return e.c({source:d,action:i.V,noun:"streaming_response_last"},u)})({...this.getDefaultTelemetryFields(),millis:n-s,responsePosition:t.length,...this.getMinMaxTimings(t)}))},this.getMinMaxTimings=e=>{if(e.length>1){const t=e.slice(1);return{max:Math.max(...t),min:Math.min(...t)}}return{}},this.showErrorBanner=()=>this.errorMsg?e.x` <faceplate-banner class="w-full" appearance="error" shape="rounded" msg="${this.errorMsg}" dismissible><div slot="leadingIcon">${g.w()}</div> <span slot="closeButton"> ${e.u({attributes:{"aria-label":"close error button",onclick:this.closeErrorBanner},appearance:"destructive",leadingIcon:e.al()})} </span> ${this.isQuotaExceededError?e.A:e.x`<div slot="actionButtons"> ${e.u({attributes:{onclick:this.retryRequestCore},appearance:"destructive",children:"Try again"})} </div>`}</faceplate-banner>`:e.A,this.renderStreamingHtmlBlock=()=>e.x`<div id="${Ae}" @keydown="${()=>{}}" @click="${this.onResponseBlockClick}"></div>`,this.renderStreamingRtjsonBlock=()=>e.x`<div id="${Ae}" @keydown="${()=>{}}" @click="${this.onResponseBlockClick}" class="fade-in-richtext"> ${Je({document:this.result.richtext.document})} </div>`}get shouldRenderSearchEscape(){return!!this.shouldRenderSearchEscapeHatch&&(!!this.result.rejectionCodes?.length&&!this.result.rejectionCodes?.includes(6))}get isHtmlFormat(){return this.format===e.k0.html}async connectedCallback(){await super.connectedCallback(),this.pubsub.subscribe(e.T.PremiumPurchased,this.onPremiumPurchased,!1),this.stopGoodVisitTimer()}async firstUpdated(){this.responseBlock=this.shadowRoot?.querySelector(`#${Ae}`),this.scrollToTheQuestionTitle(),this.showLoadingShimmer=!0,this.removePrevSiblingHeight()}render(){return e.x`<div id="${bt}" class="mb-xl flex flex-col gap-xs ${0===this.followupIndex?"":Oe}"> ${this.showErrorBanner()} ${this.renderHeading()} ${this.renderSourcesContainer()} ${this.isHtmlFormat?this.renderStreamingHtmlBlock():this.renderStreamingRtjsonBlock()} ${this.renderLoadingAnimation()} ${this.renderRelatedPosts()} ${this.renderReactionPanel(this.shouldRenderSearchEscape)} ${this.renderRecommendedQuestions()} ${this.renderSearchEscape(this.shouldRenderSearchEscape)} ${this.renderDisclaimerLink(this.shouldRenderSearchEscape)} ${this.renderGuidesBanner()} </div>`}};vt.styles=[e.i`a{color:var(--color-primary-plain);text-decoration:none}a:visited{color:var(--color-primary-plain-visited)}a.no-visited:visited{color:var(--color-primary-plain)}a:hover{color:var(--color-primary-plain-hover)}a[is-active]{background-color:var(--color-secondary-background-selected);border:1px solid;border-color:var(--color-secondary-background-hover);border-radius:4px}li{list-style-type:disc}p{margin-block:0}table{border-collapse:collapse;width:100%;word-break:normal;margin:1rem 0}th,tr:nth-child(even){background:var(--color-tone-6)}td,th{padding:.5rem;text-align:start}h3{margin-top:1.75rem;margin-bottom:.5rem}h4{margin:.5rem 0}ul{margin-block-start:.5rem}ul guides-rtjson-quote{display:block;margin-block-start:.5rem;margin-block-end:1em;margin-left:-.75rem}li:has(guides-rtjson-quote){list-style-type:none}li:has(p){list-style-type:disc}hr{background-color:var(--color-neutral-border-weak);margin:1.75rem 0}hr+div h3{margin:0}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.fade-in-text{animation:fadeIn .5s ease-in}.fade-in-richtext h1,.fade-in-richtext h2,.fade-in-richtext h3,.fade-in-richtext h4,.fade-in-richtext h5,.fade-in-richtext h6,.fade-in-richtext li,.fade-in-richtext p,.fade-in-richtext span{animation:fadeIn .5s ease-in}`,e.t],e._([e.n({type:String})],vt.prototype,"format",void 0),e._([e.n({type:Boolean,attribute:"should-render-search-escape-hatch"})],vt.prototype,"shouldRenderSearchEscapeHatch",void 0),e._([e.Y(`#${bt}`,!0)],vt.prototype,"responseContainer",void 0),e._([e.Y(`h2#${De}`,!0)],vt.prototype,"heading",void 0),vt=mt=e._([e.e("guides-response-container-streaming")],vt);let ft=class extends vt{constructor(){super(...arguments),this.href="",this.sourcesLoading="",this.sourcesStreaming="",this.showErrorBanner=()=>{if(!this.errorMsg)return e.A;switch(this.errorType){case e.jE.GuidesUnhandledError:return e.x`<slot name="error-network"></slot>`;case e.jE.GuidesGenericError:return e.x`<slot name="error-rejection"></slot>`;case e.jE.GuidesQuotaExceededError:default:return e.x`<slot name="error-default"></slot>`}},this.renderRejectionBanner=()=>e.x`<slot name="error-rejection"></slot>`,this.renderLoadingAnimation=()=>!this.showLoadingShimmer||this.errorMsg?e.A:e.x`<slot name="loading"></slot>`,this.renderSourcesContainer=()=>this.errorMsg||0===this.responseRelatedPosts.length&&this.isResponseFinished?e.A:0===this.responseRelatedPosts.length?y(this.sourcesLoading):e.x`${at(JSON.parse(this.telemetryData||"{}"),e.x`<a href="${e.aa(this.href)}" style="display:block;color:inherit;text-decoration:none"><guides-sources-container post-ids="${JSON.stringify(this.responseRelatedPosts)}" conversation-id="${this.conversationId}" followup-index="${this.followupIndex}" question="${this.question}" translation-language="${this.translationLanguage}" serp-streaming-text="${this.sourcesStreaming}" serp-loading-text="${this.sourcesLoading}"></guides-sources-container></a>`)}`,this.renderStreamingCTA=()=>this.errorMsg||""===this.currentResponseId?e.A:e.x`<slot name="streaming_cta"></slot>`,this.renderStreamingHtmlBlock=()=>this.result.rejectionCodes?.length>0?this.renderRejectionBanner():e.x`${at(JSON.parse(this.telemetryData||"{}"),e.x`<a href="${e.aa(this.href)}" style="display:block;color:inherit;text-decoration:none"> <div id="${Ae}" @keydown="${()=>{}}" @click="${this.onResponseBlockClick}"></div> </a>`)}`,this.renderStreamingRtjsonBlock=()=>this.result.rejectionCodes?.length>0?this.renderRejectionBanner():e.x`${at(JSON.parse(this.telemetryData||"{}"),e.x`<a href="${e.aa(this.href)}" style="display:block;color:inherit;text-decoration:none"><div id="${Ae}" @keydown="${()=>{}}" @click="${this.onResponseBlockClick}" class="fade-in-richtext"> ${Je({document:this.result.richtext.document})} </div></a>`)}`}render(){return e.x`<div id="${bt}" class="${"search-answers-response-container-streaming"} relative"> ${this.showErrorBanner()} ${this.renderSourcesContainer()} ${this.isHtmlFormat?this.renderStreamingHtmlBlock():this.renderStreamingRtjsonBlock()} ${this.renderLoadingAnimation()} ${""!==this.currentResponseId?e.x` <span class="search-answers-gradient absolute bottom-0 left-0 w-100 h-[56px] isolate pointer-events-none"></span>`:e.A} </div> ${this.renderStreamingCTA()} `}};var kt;ft.styles=[e.i`.search-answers-response-container-streaming{height:220px;overflow:hidden;padding:0 1em}.search-answers-gradient{background:linear-gradient(180deg,transparent 0,var(--color-neutral-background) 100%)}.search-answers-response-container-streaming:hover .search_answers_gradient{background:linear-gradient(180deg,transparent 0,var(--color-neutral-background-hover) 100%)}a{color:var(--color-primary-plain);text-decoration:none}a:visited{color:var(--color-primary-plain)}a.no-visited:visited{color:var(--color-primary-plain)}a:hover{color:var(--color-primary-plain-hover)}a[is-active]{text-decoration:none}li{list-style-type:disc}p{margin-block:0}table{border-collapse:collapse;width:100%;word-break:normal;margin:1rem 0}th,tr:nth-child(even){background:var(--color-tone-6)}td,th{padding:.5rem;text-align:left}h3{margin-top:1.75rem;margin-bottom:.5rem}h4{margin:.5rem 0}ul{margin-block-start:.5rem}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.fade-in-text{animation:fadeIn .5s ease-in}`,e.t],e._([e.n({type:String,attribute:"data-href"})],ft.prototype,"href",void 0),e._([e.n({type:String,attribute:"data-telemetry-data"})],ft.prototype,"telemetryData",void 0),e._([e.n({type:String,attribute:"sources-loading"})],ft.prototype,"sourcesLoading",void 0),e._([e.n({type:String,attribute:"sources-streaming"})],ft.prototype,"sourcesStreaming",void 0),ft=e._([e.e("search-answers-response-container-streaming")],ft);const yt=`${je}_realtime`;let Rt=kt=class extends Ue{constructor(){super(...arguments),this.hostSubscribe=async()=>{this.isResponseFinished||this.isResponsePending||this.pubsub.subscribe(e.T.GuidesSubscriptionResponded,this.onResponse,!1)},this.hostUnsubscribe=()=>{this.pubsub.unsubscribe(e.T.GuidesSubscriptionResponded,this.onResponse)},this.removeHeightClass=()=>this.responseContainer?.classList.remove(Oe),this.retryRequest=e=>{this.hostUnsubscribe(),this.retryRequestCore(e)},this.onSubscriptionConnectionError=e=>{this.isLoading=!1,this.showLoadingShimmer=!1,this.errorMsg="Something went wrong. Please retry.",this.trackSubscriptionConnectionError(e)},this.trackSubscriptionConnectionError=t=>{this._trackEvent((({conversationId:t,position:s,searchQuery:n,millis:r,source:a=i.G})=>e.c({source:a,action:i.V,noun:"subscription_connection_error"},{timer:{type:e.b3.GuidesRealtimeResponse,millis:r},...i.g({conversationId:t,position:s,searchQuery:n})}))({...this.getDefaultTelemetryFields(),millis:t}))},this.onResponse=t=>{const{errorData:s,userQuota:i}=t;if(this.userHasPremium||(this.isHiddenGuidesPremiumBanner=0!==t.userQuota?.queriesRemaining),s&&s.type)return this.stopLoadingAndUnsubscribe([]),void this.applyErrorRules(s,i);const n=t.id;if(n===this.currentResponseId)return;const{responseText:r,isResponseFinished:a,relatedPosts:o,translationLanguage:l}=t;r&&(this.isUserReachedQueryLimit=e.iI(t).isUserReachedQueryLimit,this.updateTranslationLanguage(l),this.useSourcesContainer&&(this.responseRelatedPosts=o),""===this.currentResponseId&&(this.showLoadingShimmer=!1,this.setLoggedOutCookie()),this.currentResponseId=n,this.renderResponse(he(r)),a&&(this.showDisclaimerLink=!0,this.recommendedQuestions=t.suggestedPrompts,this.stopLoadingAndUnsubscribe(o),t.queryRejectionCodeStr&&t.queryRejectionCodeStr.length>0?this.sendRefuseResponseEvent(t.queryRejectionCodeStr):(this.storeQueryHistory(),this.trackResponseFinished(!1))))},this.removePrevSiblingHeight=()=>{const e=this.parentElement?.children||[],t=e.length>1?e[e.length-2]:null;t&&t instanceof kt&&t.removeHeightClass()},this.scrollToTheQuestionTitle=()=>{this.followupIndex>0&&this.heading?.scrollIntoView({behavior:"smooth"})},this.showErrorBanner=()=>this.errorMsg?e.x` <faceplate-banner class="w-full" appearance="error" shape="rounded" msg="${this.errorMsg}" dismissible><div slot="leadingIcon">${g.w()}</div> <span slot="closeButton"> ${e.u({attributes:{"aria-label":"close error button",onclick:this.closeErrorBanner},appearance:"destructive",leadingIcon:e.al()})} </span> ${this.isQuotaExceededError?e.A:e.x`<div slot="actionButtons"> ${e.u({attributes:{onclick:this.retryRequest},appearance:"destructive",children:"Try again"})} </div>`}</faceplate-banner>`:e.A}async connectedCallback(){await super.connectedCallback(),await this.hostSubscribe(),this.pubsub.subscribe(e.T.PremiumPurchased,this.onPremiumPurchased,!1),this.stopGoodVisitTimer()}async disconnectedCallback(){super.disconnectedCallback?.(),this.hostUnsubscribe()}async firstUpdated(){this.responseBlock=this.shadowRoot?.querySelector(`#${Ae}`),this.scrollToTheQuestionTitle(),this.isLoading=!0,this.showLoadingShimmer=!0,this.removePrevSiblingHeight()}stopLoadingAndUnsubscribe(e){this.isLoading=!1,this.showLoadingShimmer=!1,this.responseRelatedPosts=e,this.hostUnsubscribe()}render(){return e.x`<div id="${yt}" class="mb-xl flex flex-col gap-xs ${0===this.followupIndex?"":Oe}"> ${this.showErrorBanner()} ${this.renderHeading()} ${this.renderSourcesContainer()} <div id="${Ae}" @keydown="${()=>{}}" @click="${this.onResponseBlockClick}"></div> ${this.renderLoadingAnimation()} ${this.renderRelatedPosts()} ${this.renderReactionPanel()} ${this.renderRecommendedQuestions()} ${this.renderDisclaimerLink()} ${this.renderGuidesBanner()} </div>`}};e._([e.Y(`#${yt}`,!0)],Rt.prototype,"responseContainer",void 0),e._([e.Y(`h2#${De}`,!0)],Rt.prototype,"heading",void 0),Rt=kt=e._([e.e("guides-response-container-realtime")],Rt);const xt="SubscribeSubscription",It=`\n    subscription ${xt}($input: SubscribeInput!) {\n      subscribe(input: $input) {\n          id\n          ... on BasicMessage {\n            data {\n              ... on LLMResponseMessageData {\n                translationLanguage\n                choices {\n                  message {\n                    content\n                  }\n                  \n                  finishReason\n                  error {\n                    __typename\n                    ... on GuidesGenericError {\n                      errorCode\n                      message\n                      retriable\n                    }\n                    \n                    ... on GuidesQuotaExceededError{\n                      retryAfterSeconds\n                    }\n                  }\n                }\n                queryRejectionCodes {\n                  code\n                }\n                postIDs\n                subredditIDs\n                commentIDs\n                suggestedPrompts\n                \n                userQuota {\n                  queriesRemaining\n                  timeUntilResetSeconds\n                }\n              }\n            }\n          }\n        }\n      }\n    `,wt=e=>e?"Answers is currently experiencing issues, please try again later.":"Logged out Answers is currently experiencing issues, please log in to use it.",St={401:e=>wt(e),429:"Too many requests."},Tt=(e,t)=>{const s=e.split(":")[0];return ("function"==typeof St[s]?St[s](t):St[s])||"Something went wrong.";},Nt=({result:t,isUserLoggedIn:s,onData:i,channel:n})=>{const r=t?.data?.subscribe,a=((t,s,i)=>{const n=s?.length>0?s[0]?.message:"",r=t?.data?.choices?.[0].error,a=r?.__typename,o=r?.message;if(n||a)return{msg:a?o:Tt(n,!!i),type:a||e.jE.GuidesUnhandledError,retryAfterSeconds:r?.retryAfterSeconds}})(r,t?.errors,s),o=((t,s)=>{const i=t?.data?.choices?.[0]?.message?.content||"",n=t?.data?.choices?.[0]?.finishReason===e.k4,r=t?.data?.postIDs||[],a=t?.data?.userQuota||e.k1,o=t?.data?.suggestedPrompts||[],l=t?.data?.queryRejectionCodes,d=l?Object.keys(l).map((e=>Object.hasOwn(l,e)?`${l[e]?.code}`:"")):[],u=d.length>0?d.join(","):"";return{id:t?.id,channel:s,responseText:i,isResponseFinished:n,relatedPosts:r,userQuota:a,suggestedPrompts:o,queryRejectionCodeStr:u,translationLanguage:t?.data?.translationLanguage||""}})(r,n);(r||a?.type)&&i({...o,channel:n,errorData:a})};class $t{constructor(){this.responseTimings=[],this.getTelemetryConversationId=()=>this.telemetryConversationId||""}initialize({host:t,conversationId:s,channel:i}){this.trackEvent=s=>e.k(t,s),this.telemetryChannel=i,this.telemetryConversationId=s,this.host=t}getNow(){return Date.now()}checkReadiness(e,t){return this.trackEvent?this.telemetryChannel===e||(this.resetState(),Ct(`GuidesRealtimeTelemetry: channel was changed during call to ${t}`),!1):(Ct(`GuidesRealtimeTelemetry: trackEvent was unavailable during call to ${t}`),!1)}resetState(){this.lastRequestedAt=void 0,this.lastRespondedAt=void 0,this.followupIndex=void 0,this.searchQuery=void 0,this.responseTimings=[]}onResponse({channel:t,isResponseFinished:s}){if(this.lastRequestedAt&&this.checkReadiness(t,"onResponse")){const t=this.lastRespondedAt??this.lastRequestedAt,n=this.getNow(),r=n-t;this.responseTimings.push(r),1===this.responseTimings.length&&(this.trackEvent?.((({conversationId:t,position:s,searchQuery:n,millis:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{position:1},timer:{type:e.b3.GuidesRealtimeResponse,millis:r}};return e.c({source:a,action:i.V,noun:"realtime_response_first"},o)})({conversationId:this.getTelemetryConversationId(),position:this.followupIndex,searchQuery:this.searchQuery,millis:r})),this.host?.initGoodVisitTimer(!1)),s?this.trackResponseFinished():this.lastRespondedAt=n}}onSendRequest({channel:e,followupIndex:t,searchQuery:s}){this.checkReadiness(e,"onSendRequest")&&(this.lastRequestedAt=this.getNow(),this.followupIndex=t,this.searchQuery=s)}mutationUrlError(t,s){this.trackEvent?.((({conversationId:t,position:s,searchQuery:n,url:r,errorText:a,source:o=i.G})=>{const l={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{source_name:r,reason:a}};return e.c({source:o,action:i.V,noun:"mutation_url_error"},l)})({conversationId:this.getTelemetryConversationId(),position:this.followupIndex,searchQuery:this.searchQuery,url:t,errorText:s}))}getMinMaxTimings(){if(this.responseTimings.length>1){const e=this.responseTimings.slice(1);return{max:Math.max(...e),min:Math.min(...e)}}return{}}trackResponseFinished(){if(this.lastRequestedAt){const t=this.getNow();this.trackEvent?.((({conversationId:t,position:s,searchQuery:n,responsePosition:r,millis:a,max:o,min:l,source:d=i.G})=>{const u={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{position:r},timer:{type:e.b3.GuidesRealtimeQuestion,millis:a,min:l,max:o}};return e.c({source:d,action:i.V,noun:"realtime_response_last"},u)})({conversationId:this.getTelemetryConversationId(),position:this.followupIndex,searchQuery:this.searchQuery,responsePosition:this.responseTimings.length,millis:t-this.lastRequestedAt,...this.getMinMaxTimings()})),this.resetState()}}subscriptionRetryAttempt(t){this.trackEvent?.((({conversationId:t,position:s,searchQuery:n,retryAttempt:r,source:a=i.G})=>{const o={...i.g({conversationId:t,position:s,searchQuery:n}),action_info:{count:r}};return e.c({source:a,action:i.V,noun:"subscription_retry_attempt"},o)})({conversationId:this.getTelemetryConversationId(),position:this.followupIndex,searchQuery:this.searchQuery,retryAttempt:t}))}}function Ct(e){window.Sentry?.captureMessage?.(e)}class Et{constructor(t={}){this.channel="",this.gqlSubscriptionControllers=[],this.isConnected=!1,this.retryAttempts=0,this.retrySubscription=e=>{if(this.retryAttempts>=3)throw new Error(`Failed to resubscribe after ${this.retryAttempts} attempts.`);this.unsubscribeFromRealtimeUpdates(this.retryAttempts),this.subscribeToRealtimeUpdates(e),this.retryAttempts++,this.telemetry?.subscriptionRetryAttempt(this.retryAttempts)},this.onConnectedCallback=()=>{this.isConnected=!0,this.retryAttempts=0,e.p(e.T.GuidesSubscriptionConnected)},this.onWebsocketClose=()=>{this.unsubscribeFromRealtimeUpdates(),e.p(e.T.GuidesSubscriptionDisconnected)},this.onNewDataReceived=t=>{e.p(e.T.GuidesSubscriptionResponded,t),this.telemetry?.onResponse({channel:t.channel,isResponseFinished:t.isResponseFinished}),t.errorData&&t.errorData.type&&this.unsubscribeFromRealtimeUpdates()},this.onNewDataReceivedThrottled=d.R(this.onNewDataReceived,50,!0),this.isValidToSend=e=>this.isConnected&&this.channel.indexOf(e)>=0,this.getMutationUrlError=e=>`GQL realtime mutation failed: ${JSON.stringify(e)}`,this.getSource=t=>t&&e.k3.has(t)?t:null,t.enableTelemetry&&(this.telemetry=new $t)}subscribeToRealtimeUpdates(t){const{channelId:s,conversationId:i,isUserLoggedIn:n}=t;if(this.isSubscribedConversation(i))this.onConnectedCallback();else if(s){const r=new e.bY(t);t.addController(r);const a=(({channel:e,isUserLoggedIn:t,onConnectedCallback:s,onClose:i,onData:n})=>({query:{operationName:xt,query:It,variables:{input:{channel:{teamOwner:"ML",category:"LLM",tag:e}}}},onConnectedCallback:s,lazyCloseTimeout:100,onClose:i,onData:s=>Nt({result:s,isUserLoggedIn:t,channel:e,onData:n}),reconnectOnClose:!0}))({channel:s,onClose:this.onWebsocketClose,onConnectedCallback:this.onConnectedCallback,onData:this.onNewDataReceivedThrottled,isUserLoggedIn:!!n});r.subscribe(a),this.gqlSubscriptionControllers.push(r),this.channel=s,this.telemetry?.initialize({host:t,conversationId:i,channel:this.channel})}}isSubscribedConversation(e){return!!this.channel.match(e)}hostDisconnected(){this.unsubscribeFromRealtimeUpdates()}unsubscribeFromRealtimeUpdates(e){this.gqlSubscriptionControllers.forEach((e=>{e.unsubscribe()})),this.gqlSubscriptionControllers=[],this.channel="",this.isConnected=!1,this.retryAttempts=e||0}async mutationGQLQuery(t,s){try{const i=await e.e6();if(!i){const e="Failed to fetch auth token from /svc/shreddit/token";throw (Ct(e), new Error(e))}const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.token}`},body:JSON.stringify(s)});if(!n.ok){const e=await n.text();throw (Ct(`GQL realtime mutation failed with status ${n.status}: ${e}`), new Error(e))}return await n.json()}catch(e){throw (Ct(`Failed to send realtime event: ${e}`), e)}}async send(e,t,s){const{question:i,conversationId:n,followupIndex:r}=e,a=this.getSource(s);if(!this.isValidToSend(n))return void this.retrySubscription(e);const o=await this.mutationGQLQuery(t,{query:"\n          mutation publish($input: PublishInput!) {\n            publish(input: $input) {\n              ok\n            }\n          }",variables:{input:{channel:{teamOwner:"ML",category:"LLM",tag:this.channel},LLMQueryMessageData:{conversationID:n,useCase:"GUIDES",messages:[{content:i}],source:{source:a}}}}});if(o.errors){const e=this.getMutationUrlError(o.errors);throw (this.telemetry?.mutationUrlError(t,e), Ct(e), new Error(e))}this.telemetry?.onSendRequest({channel:this.channel,followupIndex:r,searchQuery:i})}}let Pt=class extends Ue{constructor(){super(...arguments),this.shouldTrackDwell=!1,this.getActiveLink=()=>this.querySelector(`a[${_e}]`),this.initGoodVisitTimer=()=>{this.pubsub.publish(e.T.GuidesStartGoodVisitTimer,{conversationId:this.conversationId,followupIndex:this.followupIndex,searchQuery:this.question,isRealtime:!1,isStreaming:!1})}}firstUpdated(t){super.firstUpdated(t),this.pubsub.publish(e.T.GuidesResponseContainerSsrRendered),this.shouldTrackDwell&&this.initGoodVisitTimer()}render(){return e.x`<div class="${"mb-xl flex flex-col gap-xs"}"> <slot name="heading-container"></slot> ${this.useSourcesContainer?e.x`<slot name="sources-container"></slot>`:e.A} <slot name="response-view-tracker" class="hidden"></slot> <slot @keydown="${()=>{}}" @click="${this.onResponseBlockClick}"></slot> <slot name="related-posts"></slot> ${this.renderReactionPanel()} </div> ${this.renderRecommendedQuestions()} ${this.renderDisclaimerLink()} `}};Pt.styles=[e.t],e._([e.r()],Pt.prototype,"slottedElement",void 0),e._([e.n({type:Boolean,attribute:"should-track-dwell"})],Pt.prototype,"shouldTrackDwell",void 0),Pt=e._([e.e("guides-response-container-ssr")],Pt);let Lt=class extends e.s{constructor(){super(...arguments),this.source=e.iD.Answers,this.isSubscribed=!1,this.guidesRealtimeController=new Et({enableTelemetry:!0}),this.pubsub=new e.z(this),this.requestUrl="",this.getActiveContainerRetryRequestFunc=e=>e instanceof vt?e.retryRequestCore:e.retryRequest,this.onPremiumPurchased=async()=>{const e=this.getActiveResponseContainer();e&&this.getActiveContainerRetryRequestFunc(e)()},this.onSubscriptionConnected=async()=>{this.clearSubscriptionTimeout();const e=this.getActiveResponseContainer();e&&(e.isResponseFinished||(e.isResponsePending?this.getActiveContainerRetryRequestFunc(e)():(this.isSubscribed=!0,await this.sendRequest())))},this.onStreamingStart=async e=>{e.isResponseFinished||(e.isResponsePending?e.retryRequestCore():await e.initStreaming())},this.onSubscriptionDisconnected=()=>{this.isSubscribed=!1},this.onSlotChanged=async()=>{const e=this.getActiveResponseContainer();if(e)return e instanceof vt?this.onStreamingStart(e):void(this.isSubscribed?await this.sendRequest():this.subscribeToRealtimeUpdates(e))},this.getActiveResponseContainer=()=>{const e=this.slottedElement?.length||1,t=this.slottedElement?.[e-1];return t instanceof Rt||t instanceof vt||t instanceof ft?t:null},this.sendRequest=async()=>{const e=this.getActiveResponseContainer();e&&(await this.guidesRealtimeController.send(e,this.requestUrl,this.source))},this.subscribeToRealtimeUpdates=e=>{this.guidesRealtimeController?.subscribeToRealtimeUpdates(e),this.subscriptionTimeout=setTimeout(this.checkForSubscriptionState,1e4)},this.checkForSubscriptionState=()=>{const e=this.getActiveResponseContainer();e&&e instanceof Rt&&!this.isSubscribed&&e.onSubscriptionConnectionError(1e4)},this.clearSubscriptionTimeout=()=>{clearTimeout(this.subscriptionTimeout)},this.onGuidesUnavailableQueryClicked=({id:t})=>{const s=document.getElementById(t),i=document.querySelectorAll(e.k5+":last-of-type")[0];i instanceof Pt&&i.removeAttribute("show-disclaimer-link"),s?.remove()},this.onGuidesRenderNewQuestionContainer=t=>{this.pubsub.publish(e.T.GuidesRenderNewQuestionContainerStarted),this.generateGuidesResponseContainerOnline(t)},this.generateGuidesResponseContainerOnline=({currentQuestion:t,followupIndex:s})=>{const i=document.querySelector(`#${e.k6}`),n=i?.content?.firstElementChild,r=(n?.tagName.toLowerCase(),e.k7,n),a=r?.cloneNode(!1);a&&(a.setAttribute("question",t),a.setAttribute("followup-index",s+""),this.appendChild(a))}}async connectedCallback(){super.connectedCallback(),this.slotEl?.addEventListener("slotchange",this.onSlotChanged),this.pubsub.subscribe(e.T.GuidesSubscriptionConnected,this.onSubscriptionConnected,!1),this.pubsub.subscribe(e.T.PremiumPurchased,this.onPremiumPurchased,!1),this.pubsub.subscribe(e.T.GuidesSubscriptionDisconnected,this.onSubscriptionDisconnected,!1),this.pubsub.subscribe(e.T.GuidesRetryRequested,this.onSlotChanged,!1),this.pubsub.subscribe(e.T.GuidesUnavailableQueryClicked,this.onGuidesUnavailableQueryClicked,!1,!0),this.pubsub.subscribe(e.T.GuidesRenderNewQuestionContainer,this.onGuidesRenderNewQuestionContainer,!1),await this.onSlotChanged()}disconnectedCallback(){super.disconnectedCallback(),this.slotEl?.removeEventListener("slotchange",this.onSlotChanged),this.isSubscribed=!1,this.guidesRealtimeController.hostDisconnected()}firstUpdated(){this.slotEl?.addEventListener("slotchange",this.onSlotChanged)}updated(){this.requestUrl=e.k8(this.realtimeBackendVariant)}render(){return e.x`<slot></slot>`}};return e._([e.r()],Lt.prototype,"slottedElement",void 0),e._([e.n({type:String,attribute:"realtime-backend-variant"})],Lt.prototype,"realtimeBackendVariant",void 0),e._([e.n({type:String})],Lt.prototype,"source",void 0),e._([e.Y("slot")],Lt.prototype,"slotEl",void 0),e._([e.j()],Lt.prototype,"isSubscribed",void 0),Lt=e._([e.e("guides-subscription-handler")],Lt),{G:P,get P(){return b},a:E,b:L,g:I,h:V,s:w}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("DwBbT5sc7p",["CYrPuvCiTj"],(async a=>{const{svg:L}=a.a();return{w:a.m(L`<path d="M9.393 14.826a1.18 1.18 0 01-.594-1.037c0-.222.053-.424.16-.607.107-.183.251-.328.434-.437a1.15 1.15 0 01.6-.163 1.197 1.197 0 011.207 1.207 1.18 1.18 0 01-1.207 1.193c-.217 0-.417-.052-.6-.156zm1.365-3.224L11 6.042H9l.242 5.56h1.516zM10 2.906a.94.94 0 00-.828.478L2.701 14.591a.939.939 0 000 .956.94.94 0 00.828.478H16.47a.94.94 0 00.828-.478.94.94 0 000-.956l-6.47-11.207A.938.938 0 0010 2.906zm0-1.8a2.73 2.73 0 012.387 1.378l6.471 11.207c1.061 1.838-.265 4.135-2.387 4.135H3.529c-2.122 0-3.448-2.297-2.387-4.135L7.613 2.484A2.73 2.73 0 0110 1.106z"></path>`,"0 0 20 20","warning")}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("GAfaH20Chw",["CYrPuvCiTj"],(async e=>{const t="wheel",o="touchmove",n="scroll-is-blocked";function s(e){e.preventDefault()}function d(e){e.stopPropagation()}class l extends e.bi{constructor(){super(...arguments),this.blockedSources=new Set([])}get shredditApp(){return document.querySelector("shreddit-app")}get isDebugEnabled(){return this.shredditApp?.hasAttribute("debug")}preventOverscrollOnBody(){document.body.classList.contains(n)||document.body.classList.add(n)}allowOverscrollOnBody(){document.body.classList.remove(n)}preventEventOnNode(e,t){t.addEventListener(e,s,{passive:!1})}allowEventOnNode(e,t){t.removeEventListener(e,s)}stopEventPropagationOnNode(e,t){t.addEventListener(e,d,{passive:!1})}allowEventPropagationOnNode(e,t){t.removeEventListener(e,d)}rafOrYOLO(e){requestAnimationFrame?requestAnimationFrame(e):e()}applyBlocking(){return new Promise((e=>{this.rafOrYOLO((()=>{const n=new Set,s=new Set;for(const e in l.CURRENT_SCROLL_BLOCKERS){const d=l.CURRENT_SCROLL_BLOCKERS[e];this.allowEventOnNode(t,d.targetNode),d.allowWheelEvents?this.allowEventPropagationOnNode(t,d.sourceNode):(this.preventEventOnNode(t,d.targetNode),this.stopEventPropagationOnNode(t,d.sourceNode),s.add(d.targetNode)),this.allowEventOnNode(o,d.targetNode),d.allowTouchEvents?this.allowEventPropagationOnNode(o,d.sourceNode):(this.preventEventOnNode(o,d.targetNode),this.stopEventPropagationOnNode(o,d.sourceNode),n.add(d.targetNode))}s.size>0?(this.preventOverscrollOnBody(),this.preventEventOnNode(t,document)):(this.allowOverscrollOnBody(),this.allowEventOnNode(t,document)),n.size>0?this.preventEventOnNode(o,document):this.allowEventOnNode(o,document),e()}))}))}async blockPageScrolling({allowTouchEvents:t,allowWheelEvents:o,source:n=this._host.tagName,sourceNode:s=this._host,targetNode:d=document}={}){l.CURRENT_SCROLL_BLOCKERS[n]||t&&o||(l.CURRENT_SCROLL_BLOCKERS[n]={allowTouchEvents:t,allowWheelEvents:o,sourceNode:s,targetNode:d},await this.applyBlocking(),this.blockedSources.add(n),this.isDebugEnabled&&this.shredditApp?.dispatchEvent(e.d("faceplate-alert",{name:"scroll-blocker-debug",level:e.a0.debug,message:`Scrolling blocked for "${n}"`,content:e.x` <dl> <dt>Touch events allowed?</dt> <dd><code>${Boolean(t)}</code></dd> <dt>Wheel events allowed?</dt> <dd><code>${Boolean(o)}</code></dd> </dl> `})))}async unblockPageScrolling(t=this._host.tagName){l.CURRENT_SCROLL_BLOCKERS[t]&&(l.CURRENT_SCROLL_BLOCKERS[t].allowTouchEvents=!0,l.CURRENT_SCROLL_BLOCKERS[t].allowWheelEvents=!0,await this.applyBlocking(),delete l.CURRENT_SCROLL_BLOCKERS[t],this.blockedSources.delete(t),this.isDebugEnabled&&this.shredditApp?.dispatchEvent(e.d("faceplate-alert",{name:"scroll-blocker-debug",level:e.a0.debug,message:`Scrolling unblocked for "${t}"`})))}hostDisconnected(){for(const e of this.blockedSources)this.unblockPageScrolling(e)}}return l.CURRENT_SCROLL_BLOCKERS={},{S:l}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./nZA40q2akY.js",import.meta.url,"nZA40q2akY");SML.di("./CrgF_JGUIv.js",import.meta.url,"CrgF_JGUIv");
SML.dm("LX29t1LiDK",["CYrPuvCiTj","nZA40q2akY","CrgF_JGUIv"],(async(e,t,a)=>({s:(r,l)=>l?e.u({shape:"pill",appearance:"plain",size:e.v.Small,attributes:{className:"border-0 [:not(:hover)]:bg-transparent text-12 font-semibold text-secondary-plain",slot:"trigger",...r},hideChildrenOverflow:!0,children:e.x`<slot name="trigger-content"></slot>`,trailingIcon:a.c({size:e.I.Small,attributes:{"aria-hidden":"true",className:"px-[2px]"}})}):t.d({appearance:"plain",attributes:{className:"border-0 [:not(:hover)]:bg-transparent text-12 font-semibold text-secondary-plain",...r},children:e.x`<slot name="trigger-content"></slot>`,size:e.v.Small})})));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");
SML.dm("NMIRxeD8JS",["CYrPuvCiTj"],(async c=>{const{svg:a}=c.a();return{p:c.m(a`<path d="M6.35 3.3c.26 0 .51.08.74.22l8.32 5.3c.58.37.65.95.65 1.18 0 .23-.06.81-.65 1.18l-8.32 5.3c-.23.15-.48.22-.74.22-.67 0-1.4-.54-1.4-1.4V4.7c0-.87.73-1.4 1.4-1.4zm0-1.8c-1.66 0-3.2 1.32-3.2 3.2v10.6c0 1.87 1.54 3.2 3.2 3.2.57 0 1.16-.16 1.7-.5l8.32-5.3c1.97-1.25 1.97-4.13 0-5.39L8.05 2c-.54-.35-1.13-.5-1.7-.5z"></path>`,"0 0 20 20","play")}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./CcWrGyc4YB.js",import.meta.url,"CcWrGyc4YB");SML.di("./B8bPYlQRZA.js",import.meta.url,"B8bPYlQRZA");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./BvPcMFr1Lr.js",import.meta.url,"BvPcMFr1Lr");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./piqxRzNCoR.js",import.meta.url,"piqxRzNCoR");
SML.dm("de0dPcz3qH",["CYrPuvCiTj","piqxRzNCoR"],(async(t,a)=>{class n extends a.B{constructor(){super(...arguments),this._partialRequestController=new t.aU(this),this.isFetchingTranslations=!1,this.translationCache=new Map}async onTranslationsEnabled(){await this.runTranslations()}async onTranslationsDisabled(){await this.runTranslations()}async runTranslations(){this.isFetchingTranslations||(await this.fetchUntranslatedEntities(),this.renderTranslationCache())}async fetchUntranslatedEntities(){if(this.isFetchingTranslations)return!1;const t=this.getTranslatableEntities();this.updateCacheWithEntities(t);const a=[];if(this.translationCache.forEach((t=>{(this.translationContextValue.isTranslationActive?!!t.translatedValue:!!t.originalValue)||a.push(t)})),!a.length)return!1;const n=await this.fetchTranslatableEntities(a);return this.updateCacheWithEntities(n),n}updateCacheWithEntities(t){t.forEach((t=>{const a=this.translationCache.get(t.id);if(!a)return void this.translationCache.set(t.id,t);let n=!1;const s={};t.translatedValue&&!a.translatedValue&&(s.translatedValue=t.translatedValue,n=!0),t.originalValue&&!a.originalValue&&(s.originalValue=t.originalValue,n=!0),n&&this.translationCache.set(t.id,{...a,...s})}))}async fetchArbitraryStrings(a){const n=new FormData;a.forEach((({originalValue:t})=>n.append("strings[]",t)));const s=await this.requestPartial("/svc/shreddit/translated-strings",{method:t.bj.Post,body:n});if(!s)return a;return a.map(((t,a)=>{const n=document.createElement("div");n.innerHTML=s[a]?.innerHTML||"";return{...t,translatedValue:n.innerHTML||""}}))}async requestPartial(a,n){this.isFetchingTranslations=!0;const s=await this._partialRequestController.request(a,n),e=s?.text?await(s?.text()):"";this.isFetchingTranslations=!1;const i=e&&!1===e.includes?.(t.bk);return i||window.Sentry?.captureMessage?.(`Request partial error in entities-translator: ${a}`),!!i&&Array.from(t.bl(e))}renderTranslationCache(t){const a=t??this.translationContextValue.isTranslationActive;this.translationCache.forEach((t=>{if("boolean"==typeof t.isTranslated&&t.isTranslated===a)return;const{render:n,node:s,originalValue:e,translatedValue:i}=t,r=a?i:e;r&&n(s,r,a),t.isTranslated=a}))}render(){return t.x`<div> <slot></slot> </div>`}}return t._([t.j()],n.prototype,"translationCache",void 0),{E:n}}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./005PrA1Byk.js",import.meta.url,"005PrA1Byk");
SML.dm("hrqH5pRvGY",["CYrPuvCiTj","005PrA1Byk"],(async(t,e)=>{let r=class extends t.s{static get styles(){return[t.t]}reload(){window.location.reload()}handleRetry(t){t.preventDefault(),t.stopPropagation(),this.reload()}render(){return e.a({attributes:{className:"text-primary",onclick:this.handleRetry,href:"."},suppressVisitedStyle:!0,children:t.x`<slot></slot>`})}};r=t._([t.e("retry-button")],r)}));
SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./DLdgTt_kCu.js",import.meta.url,"DLdgTt_kCu");
SML.dm("piqxRzNCoR",["CYrPuvCiTj","DLdgTt_kCu"],(async(t,e)=>{class n extends t.s{constructor(){super(...arguments),this.translationContextValue=t.aN,this.translationLanguage="",this.reportMetrics=!1,this.metricsScenario=t.bt.PageLoad,this.isModTranslationIndicatorsEnabled=!1,this.objectTranslationCache=new Map,this._requestController=new t.aU(this),this._isFetchingTranslations=!1,this.logError=t=>{e.l({error:t.error,ids:t.ids||[],element:this,componentName:this.tagName.toLowerCase()??this.constructor.name})}}updated(t){t.has("translationContextValue")&&this.onUpdateTranslationContextValue(t)}onUpdateTranslationContextValue(e){const n=e.get("translationContextValue"),a=this.translationContextValue.isTranslationActive,i=n?.isTranslationActive;try{if(void 0===i&&void 0!==a?this.metricsScenario=t.bt.PageLoad:void 0!==a&&(this.metricsScenario=t.bt.ToggleChange),!0!==i&&!0===a){if(this.isModTranslationIndicatorsEnabled&&this.translationState===t.bu.DISABLED)return;this.onTranslationsEnabled()}else!1!==i&&!1===a&&this.onTranslationsDisabled()}catch(t){const{message:e}=t;this.logError({error:`Exception during updateTranslationContext: ${e}`})}}async fetchRequestPartial(e,n,a){if(this._isFetchingTranslations)return null;const i=this.tagName.toLowerCase()??this.constructor.name;try{this._isFetchingTranslations=!0;const n=await this._requestController.request(e,a),r=n?.text?await(n?.text()):"";this._isFetchingTranslations=!1;const o=r&&r.includes?.(t.bk),s=r&&r.includes?.(t.bv);return o?window.Sentry?.captureMessage?.(`Request partial error in: ${i} for route: ${e}`):s&&window.Sentry?.captureMessage?.(`Empty partial returned in: ${i} for route: ${e}`),o||s?null:t.bl(r)}catch(t){const{message:n}=t;return window.Sentry?.captureMessage?.(`Request partial error in: ${i} for route: ${e} with exception: ${n}`),null}}saveElementsToCache(e,n){e.map((e=>{const a=e.getAttribute("id");if(a){const i=this.objectTranslationCache.get(a)||{},r={};e.querySelectorAll(`[${t.bw.DATA_MT_TYPE}]`).forEach((e=>{const n=e.getAttribute(t.bw.DATA_MT_TYPE);r[e.id]=n===t.bw.TEXT_CONTENT?e.textContent||"":e.innerHTML})),n?i.translatedElement=r:i.originalElement=r,this.objectTranslationCache.set(a,i)}}))}updateTranslationCache(t,e){const n=this.objectTranslationCache.get(t),a=t=>!!t.originalElement||!!t.translatedElement;if(!n&&a(e))return void this.objectTranslationCache.set(t,e);const i={};e.originalElement&&!n.originalElement&&(i.originalElement=e.originalElement),e.translatedElement&&!n.translatedElement&&(i.translatedElement=e.translatedElement),a(i)&&this.objectTranslationCache.set(t,{...n,...i})}}return t._([t.aM({context:t.aO,subscribe:!0}),t.j()],n.prototype,"translationContextValue",void 0),t._([t.n({type:String,attribute:"target-translation-language"})],n.prototype,"translationLanguage",void 0),t._([t.n({type:Boolean,attribute:"report-metrics"})],n.prototype,"reportMetrics",void 0),t._([t.n({type:String,attribute:"translation-state"})],n.prototype,"translationState",void 0),t._([t.n({type:Boolean,attribute:"is-mod-translation-indicators-enabled"})],n.prototype,"isModTranslationIndicatorsEnabled",void 0),{B:n}}));
SML.di("./DijGP8Hw3G.js",import.meta.url,"DijGP8Hw3G");SML.di("./iJcINZywq8.js",import.meta.url,"iJcINZywq8");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./Cke4oMIXaE.js",import.meta.url,"Cke4oMIXaE");SML.di("./C8CrqKCiqJ.js",import.meta.url,"C8CrqKCiqJ");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");SML.di("./BesoUDZOXX.js",import.meta.url,"BesoUDZOXX");SML.di("./BRVVLb7Eld.js",import.meta.url,"BRVVLb7Eld");
SML.di("./G2F6lxYj4X.js",import.meta.url,"G2F6lxYj4X");SML.di("./0oWl-8XRpj.js",import.meta.url,"0oWl-8XRpj");SML.di("./CYrPuvCiTj.js",import.meta.url,"CYrPuvCiTj");SML.di("./wzdls1o9Kk.js",import.meta.url,"wzdls1o9Kk");
SML.dm("yUnv2--rmc",["CYrPuvCiTj","G2F6lxYj4X","0oWl-8XRpj","wzdls1o9Kk"],(async t=>{let e=class extends t.s{constructor(){super(...arguments),this.id="",this.dismissTrackingData="",this.isOpen=!0}static get styles(){return[t.t]}handleDismiss(){this.isOpen=!1,this.dismissTrackingData&&this.dispatchEvent(t.d("faceplate-track",JSON.parse(this.dismissTrackingData)))}onDismissSlotKeydown(t){"Enter"!==t.key&&"Space"!==t.key||(t.preventDefault(),this.handleDismiss())}render(){return this.isOpen?t.x` <div class="pt-0 xs:pt-md px-md xs:px-0 flex flex-col relative" data-banner-variant="${this.id}"> <slot></slot> <slot name="dismiss" @click="${this.handleDismiss}" @keydown="${this.onDismissSlotKeydown}"></slot> </div>`:t.x``}};t._([t.n({type:String})],e.prototype,"id",void 0),t._([t.n({type:String,attribute:"dismiss-tracking-data"})],e.prototype,"dismissTrackingData",void 0),t._([t.j()],e.prototype,"isOpen",void 0),e=t._([t.e("search-banner")],e);let s=class extends t.s{static get styles(){return[t.t]}connectedCallback(){super.connectedCallback(),this.buttonId&&(this.button=document.querySelector(`#${this.buttonId}`),this.button.addEventListener("click",this.handleOnClick))}disconnectedCallback(){super.disconnectedCallback(),this.button?.removeEventListener("click",this.handleOnClick)}handleOnClick(t){const e=t.target?.closest("button")?.querySelector("span[data-modal-id]")?.getAttribute("data-modal-id"),s=document.querySelector(`#${e}`);s?.showModal({blur:!0})}render(){return t.x`<slot></slot>`}};t._([t.n({type:String,attribute:"button-id"})],s.prototype,"buttonId",void 0),s=t._([t.e("render-banner-modal-button")],s)}));